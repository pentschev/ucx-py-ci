/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/node.py:182: UserWarning: Port 8787 is already in use.
Perhaps you already have a cluster running?
Hosting the HTTP server on port 39719 instead
  warnings.warn(
[dgx13:78866:0:78866] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  78866) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f33fc6c5c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f33fc6c5e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f33fc6c5fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f34356f6420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f33fc748997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f33fc77288d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f33fc67c93f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f33fc67fb18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f33fc6cf509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f33fc67ec2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f33fc74586a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f33fc80506a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5575667483f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x557566742fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x557566754469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5575667444e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x5575667f76d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f341f8631e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55756674c6ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x5575667073ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55756674b723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x557566749929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x557566754712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5575667444e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x557566754712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5575667444e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x557566754712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5575667444e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x557566754712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5575667444e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x557566742fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x557566754469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x557566745042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x557566742fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x5575667618cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55756676204c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55756682580e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55756674c6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5575667483f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x557566754712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x5575667619ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5575667483f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x557566754712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5575667444e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x557566742fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x557566754469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5575667444e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x557566754712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x557566744232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x557566742fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x557566754469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x557566745042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x557566742fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x557566742c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x557566742c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5575667f02cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55756681d6ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x557566819a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55756681187a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55756681176c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5575668109a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5575667e4107]
=================================
2024-03-04 07:13:56,806 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48265 -> ucx://127.0.0.1:34391
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f9fb1e99100, tag: 0x94aa8bdb3d1e5084, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
[dgx13:78846:0:78846] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  78846) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fa71705ac0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7fa71705ae04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7fa71705afca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fa754083420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fa7170dd997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fa71710788d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7fa71701193f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7fa717014b18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fa717064509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fa717013c2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fa7170da86a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fa71719a06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55775cf7e3f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55775cf78fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55775cf8a469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55775cf7a4e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55775cf8a712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x55775cf97a83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x55775d0a319c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55775cf3d3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55775cf81723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55775cf7f929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55775cf8a712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55775cf7a4e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55775cf8a712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55775cf7a4e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55775cf8a712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55775cf7a4e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55775cf8a712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55775cf7a4e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55775cf78fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55775cf8a469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55775cf7b042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55775cf78fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55775cf978cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55775cf9804c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55775d05b80e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55775cf826ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55775cf7e3f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55775cf8a712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55775cf979ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55775cf7e3f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55775cf8a712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55775cf7a4e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55775cf78fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55775cf8a469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55775cf7a4e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55775cf8a712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55775cf7a232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55775cf78fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55775cf8a469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55775cf7b042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55775cf78fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55775cf78c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55775cf78c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55775d0262cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55775d0536ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55775d04fa63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55775d04787a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55775d04776c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55775d0469a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55775d01a107]
=================================
2024-03-04 07:13:58,696 - distributed.nanny - WARNING - Restarting worker
2024-03-04 07:13:58,904 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48265 -> ucx://127.0.0.1:33223
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f9fb1e99100, tag: 0x732fd29b0524402a, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
[dgx13:78840:0:78840] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  78840) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fb8b589cc0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7fb8b589ce04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7fb8b589cfca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fb9088c8420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fb8b591f997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fb8b594988d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7fb8b585393f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7fb8b5856b18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fb8b58a6509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fb8b5855c2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fb8b591c86a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fb8b59dc06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x556d725393f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556d72533fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556d72545469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d725354e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x556d725e86d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7fb8f2a2e1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x556d7253d6ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x556d724f83ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x556d7253c723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x556d7253a929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d72545712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d725354e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d72545712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d725354e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d72545712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d725354e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d72545712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d725354e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556d72533fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556d72545469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x556d72536042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556d72533fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x556d725528cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x556d7255304c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x556d7261680e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x556d7253d6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x556d725393f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d72545712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x556d725529ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x556d725393f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d72545712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d725354e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556d72533fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556d72545469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d725354e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d72545712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x556d72535232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556d72533fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556d72545469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x556d72536042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556d72533fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x556d72533c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x556d72533c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x556d725e12cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x556d7260e6ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x556d7260aa63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x556d7260287a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x556d7260276c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x556d726019a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x556d725d5107]
=================================
[dgx13:78854:0:78854] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  78854) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd8914d8c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7fd8914d8e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7fd8914d8fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd8ce4f7420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fd89155b997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fd89158588d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7fd89148f93f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7fd891492b18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd8914e2509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd891491c2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd89155886a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fd89161806a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c93ca013f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c93c9fbfb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c93ca0d469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c93c9fd4e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x55c93cab06d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7fd8b86621e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55c93ca056ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55c93c9c03ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55c93ca04723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55c93ca02929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c93ca0d712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c93c9fd4e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c93ca0d712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c93c9fd4e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c93ca0d712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c93c9fd4e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c93ca0d712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c93c9fd4e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c93c9fbfb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c93ca0d469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55c93c9fe042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c93c9fbfb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55c93ca1a8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55c93ca1b04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55c93cade80e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55c93ca056ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c93ca013f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c93ca0d712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55c93ca1a9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c93ca013f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c93ca0d712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c93c9fd4e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c93c9fbfb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c93ca0d469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c93c9fd4e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c93ca0d712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55c93c9fd232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c93c9fbfb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c93ca0d469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55c93c9fe042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c93c9fbfb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55c93c9fbc88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55c93c9fbc39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55c93caa92cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55c93cad66ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55c93cad2a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55c93caca87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55c93caca76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55c93cac99a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55c93ca9d107]
=================================
[dgx13:78862:0:78862] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  78862) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f86103bec0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f86103bee04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f86103befca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f86493d5420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f8610441997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f861046b88d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f861037593f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f8610378b18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f86103c8509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f8610377c2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f861043e86a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f86104fe06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5576f8a003f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5576f89fafb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5576f8a0c469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576f89fc4e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x5576f8aaf6d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f86335411e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5576f8a046ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x5576f89bf3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x5576f8a03723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x5576f8a01929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5576f8a0c712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576f89fc4e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5576f8a0c712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576f89fc4e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5576f8a0c712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576f89fc4e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5576f8a0c712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576f89fc4e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5576f89fafb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5576f8a0c469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5576f89fd042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5576f89fafb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x5576f8a198cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5576f8a1a04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x5576f8add80e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5576f8a046ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5576f8a003f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5576f8a0c712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x5576f8a199ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5576f8a003f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5576f8a0c712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576f89fc4e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5576f89fafb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5576f8a0c469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576f89fc4e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5576f8a0c712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5576f89fc232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5576f89fafb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5576f8a0c469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5576f89fd042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5576f89fafb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5576f89fac88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5576f89fac39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5576f8aa82cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x5576f8ad56ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x5576f8ad1a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5576f8ac987a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5576f8ac976c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5576f8ac89a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5576f8a9c107]
=================================
2024-03-04 07:14:02,311 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:60021
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7fdeec66a140, tag: 0xe5e5c07a02df8939, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7fdeec66a140, tag: 0xe5e5c07a02df8939, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2024-03-04 07:14:02,312 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:60021
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f1314349140, tag: 0x91e8a81c2587935d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f1314349140, tag: 0x91e8a81c2587935d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
Task exception was never retrieved
future: <Task finished name='Task-1545' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:140> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 155, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 55, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2024-03-04 07:14:02,314 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50883 -> ucx://127.0.0.1:60021
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1314349240, tag: 0x53f42b4f967ebb17, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-04 07:14:02,319 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:60021
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 467, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1016, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 328, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 60, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 469, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-03-04 07:14:02,529 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:33549 -> ucx://127.0.0.1:54875
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fdeec66a300, tag: 0x825ed0dd3f56c87, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-04 07:14:02,529 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54875
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #010] ep: 0x7f13143491c0, tag: 0xb9dcd3648dac4ba0, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #010] ep: 0x7f13143491c0, tag: 0xb9dcd3648dac4ba0, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2024-03-04 07:14:02,530 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54875
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fdeec66a240, tag: 0xc0ed46e7cb3e7f, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fdeec66a240, tag: 0xc0ed46e7cb3e7f, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-04 07:14:02,529 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54875
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f9fb1e99200, tag: 0x32875824e8f142fd, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f9fb1e99200, tag: 0x32875824e8f142fd, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2024-03-04 07:14:02,820 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59997
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #010] ep: 0x7f1314349200, tag: 0x5123a0da3591d979, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #010] ep: 0x7f1314349200, tag: 0x5123a0da3591d979, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2024-03-04 07:14:02,820 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59997
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f9fb1e99240, tag: 0xc8849df329821b04, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f9fb1e99240, tag: 0xc8849df329821b04, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2024-03-04 07:14:02,820 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:33549 -> ucx://127.0.0.1:59997
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fdeec66a2c0, tag: 0xf712627e51f60cd, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-04 07:14:02,821 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50883 -> ucx://127.0.0.1:59997
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #010] ep: 0x7f1314349280, tag: 0x8993730342a8c47c, nbytes: 50000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-04 07:14:02,821 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59997
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fdeec66a1c0, tag: 0xa64b3af25cdf04f, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fdeec66a1c0, tag: 0xa64b3af25cdf04f, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
[dgx13:78851:0:78851] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  78851) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f1314679c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f1314679e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f1314679fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f134d69a420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f13146fc997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f131472688d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f131463093f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f1314633b18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f1314683509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f1314632c2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f13146f986a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f13147b906a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55b3ecc163f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55b3ecc10fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55b3ecc22469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b3ecc124e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x55b3eccc56d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f13378041e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55b3ecc1a6ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55b3ecbd53ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55b3ecc19723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55b3ecc17929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b3ecc22712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b3ecc124e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b3ecc22712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b3ecc124e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b3ecc22712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b3ecc124e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b3ecc22712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b3ecc124e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55b3ecc10fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55b3ecc22469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55b3ecc13042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55b3ecc10fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55b3ecc2f8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55b3ecc3004c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55b3eccf380e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55b3ecc1a6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55b3ecc163f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b3ecc22712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55b3ecc2f9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55b3ecc163f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b3ecc22712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b3ecc124e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55b3ecc10fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55b3ecc22469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b3ecc124e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b3ecc22712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55b3ecc12232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55b3ecc10fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55b3ecc22469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55b3ecc13042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55b3ecc10fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55b3ecc10c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55b3ecc10c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55b3eccbe2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55b3ecceb6ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55b3ecce7a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55b3eccdf87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55b3eccdf76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55b3eccde9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55b3eccb2107]
=================================
[dgx13:79018:0:79018] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  79018) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f55349e7c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f55349e7e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f55349e7fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f556d893420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f5534a6a997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f5534a9488d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f553499e93f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f55349a1b18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f55349f1509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f55349a0c2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f5534a6786a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f5534b2706a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55ed030793f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ed03073fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ed03085469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed030754e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x55ed031286d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f55579fe1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55ed0307d6ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55ed030383ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55ed0307c723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55ed0307a929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed03085712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed030754e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed03085712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed030754e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed03085712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed030754e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed03085712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed030754e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ed03073fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ed03085469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55ed03076042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ed03073fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55ed030928cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55ed0309304c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55ed0315680e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55ed0307d6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55ed030793f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed03085712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55ed030929ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55ed030793f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed03085712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed030754e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ed03073fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ed03085469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed030754e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed03085712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55ed03075232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ed03073fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ed03085469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55ed03076042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ed03073fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55ed03073c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55ed03073c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55ed031212cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55ed0314e6ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55ed0314aa63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55ed0314287a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55ed0314276c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55ed031419a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55ed03115107]
=================================
2024-03-04 07:14:07,569 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:33549 -> ucx://127.0.0.1:59489
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fdeec66a2c0, tag: 0x267164e770960a6c, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-04 07:14:07,570 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59489
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7fdeec66a1c0, tag: 0xe719093348f8d512, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7fdeec66a1c0, tag: 0xe719093348f8d512, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
Task exception was never retrieved
future: <Task finished name='Task-5675' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:140> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 155, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 55, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2024-03-04 07:14:07,792 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:33549 -> ucx://127.0.0.1:50883
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #024] ep: 0x7fdeec66a280, tag: 0xd023c019d58d7ad1, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1780, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #024] ep: 0x7fdeec66a280, tag: 0xd023c019d58d7ad1, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-04 07:14:07,792 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48265 -> ucx://127.0.0.1:50883
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #046] ep: 0x7f9fb1e99100, tag: 0x9630e27b6c0097ee, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-04 07:14:07,792 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50883
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #034] ep: 0x7fdeec66a180, tag: 0xb0a7949e53d798d2, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #034] ep: 0x7fdeec66a180, tag: 0xb0a7949e53d798d2, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2024-03-04 07:14:07,793 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50883
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #035] ep: 0x7f9fb1e99180, tag: 0x4563340516f8d5fe, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #035] ep: 0x7f9fb1e99180, tag: 0x4563340516f8d5fe, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-04 07:14:07,797 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59489
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-03-04 07:14:07,821 - distributed.nanny - WARNING - Restarting worker
Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 738, in cupy.cuda.memory.alloc
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/rmm/allocators/cupy.py", line 37, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:424: Maximum pool size exceeded
Exception ignored in: 'cupy.cuda.thrust.cupy_malloc'
Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 738, in cupy.cuda.memory.alloc
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/rmm/allocators/cupy.py", line 37, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:424: Maximum pool size exceeded
2024-03-04 07:14:08,355 - distributed.worker - WARNING - Compute Failed
Key:       ('generate-data-3393696d3757f92da87d0dddd0c6ae01', 3)
Function:  generate_chunk
args:      (3, 100000000, 8, 'other', 0.3, True)
kwargs:    {}
Exception: "RuntimeError('radix_sort: failed on 2nd step: cudaErrorInvalidValue: invalid argument')"

2024-03-04 07:14:08,390 - distributed.worker - WARNING - Compute Failed
Key:       ('generate-data-5366301a596b755bb8c33997d3ce7726', 4)
Function:  generate_chunk
args:      (4, 100000000, 8, 'build', 0.3, True)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:424: Maximum pool size exceeded')"

2024-03-04 07:14:08,418 - distributed.worker - WARNING - Compute Failed
Key:       ('generate-data-5366301a596b755bb8c33997d3ce7726', 5)
Function:  generate_chunk
args:      (5, 100000000, 8, 'build', 0.3, True)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:424: Maximum pool size exceeded')"

2024-03-04 07:14:15,015 - distributed.nanny - WARNING - Worker process still alive after 3.1999987792968754 seconds, killing
2024-03-04 07:14:15,488 - distributed.nanny - WARNING - Restarting worker
2024-03-04 07:14:16,964 - distributed.nanny - WARNING - Restarting worker
2024-03-04 07:14:19,223 - distributed.nanny - WARNING - Restarting worker
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 24 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
