/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/node.py:182: UserWarning: Port 8787 is already in use.
Perhaps you already have a cluster running?
Hosting the HTTP server on port 41783 instead
  warnings.warn(
[dgx13:93296:0:93296] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  93296) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f6a63a1cc0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f6a63a1ce04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f6a63a1cfca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f6aa271b420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f6a63a9f987]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f6a63ac983d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f6a639d393f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f6a639d6b18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f6a63a26509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f6a639d5c2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f6a63a9c85a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f6a63b5c06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55b0288e13f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55b0288dbfb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55b0288ed469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b0288dd4e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b0288ed712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x55b0288faa83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x55b028a0619c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55b0288a03ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55b0288e4723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55b0288e2929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b0288ed712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b0288dd4e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b0288ed712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b0288dd4e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b0288ed712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b0288dd4e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b0288ed712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b0288dd4e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55b0288dbfb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55b0288ed469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55b0288de042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55b0288dbfb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55b0288fa8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55b0288fb04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55b0289be80e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55b0288e56ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55b0288e13f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b0288ed712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55b0288fa9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55b0288e13f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b0288ed712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b0288dd4e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55b0288dbfb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55b0288ed469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b0288dd4e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55b0288ed712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55b0288dd232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55b0288dbfb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55b0288ed469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55b0288de042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55b0288dbfb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55b0288dbc88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55b0288dbc39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55b0289892cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55b0289b66ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55b0289b2a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55b0289aa87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55b0289aa76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55b0289a99a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55b02897d107]
=================================
[dgx13:93304:0:93304] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  93304) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f0528262c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f0528262e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f0528262fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f0560f69420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f05282e5987]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f052830f83d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f052821993f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f052821cb18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f052826c509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f052821bc2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f05282e285a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f05283a206a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x559f7c19b3f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x559f7c195fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559f7c1a7469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f7c1974e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559f7c1a7712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x559f7c1b4a83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x559f7c2c019c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x559f7c15a3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x559f7c19e723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x559f7c19c929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559f7c1a7712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f7c1974e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559f7c1a7712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f7c1974e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559f7c1a7712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f7c1974e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559f7c1a7712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f7c1974e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x559f7c195fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559f7c1a7469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x559f7c198042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x559f7c195fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x559f7c1b48cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x559f7c1b504c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x559f7c27880e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559f7c19f6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x559f7c19b3f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559f7c1a7712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x559f7c1b49ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x559f7c19b3f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559f7c1a7712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f7c1974e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x559f7c195fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559f7c1a7469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f7c1974e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559f7c1a7712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x559f7c197232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x559f7c195fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559f7c1a7469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x559f7c198042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x559f7c195fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x559f7c195c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559f7c195c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x559f7c2432cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x559f7c2706ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x559f7c26ca63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x559f7c26487a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x559f7c26476c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x559f7c2639a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x559f7c237107]
=================================
2024-02-08 07:07:33,397 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42199 -> ucx://127.0.0.1:38965
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3a49acc100, tag: 0x32b8ea724b374e4f, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-02-08 07:07:33,397 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:43961 -> ucx://127.0.0.1:38965
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f6cc49e1100, tag: 0x8e483adaca739501, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
[dgx13:93277:0:93277] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  93277) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f129304fc0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f129304fe04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f129304ffca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f12cbd30420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f12930d2987]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f12930fc83d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f129300693f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f1293009b18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f1293059509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f1293008c2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f12930cf85a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f129318f06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x561736cfa3f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x561736cf4fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561736d06469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561736cf64e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x561736da96d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f12b63071e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x561736cfe6ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x561736cb93ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x561736cfd723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x561736cfb929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x561736d06712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561736cf64e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x561736d06712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561736cf64e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x561736d06712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561736cf64e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x561736d06712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561736cf64e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x561736cf4fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561736d06469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x561736cf7042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x561736cf4fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x561736d138cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x561736d1404c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x561736dd780e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x561736cfe6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x561736cfa3f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x561736d06712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x561736d139ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x561736cfa3f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x561736d06712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561736cf64e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x561736cf4fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561736d06469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561736cf64e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x561736d06712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x561736cf6232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x561736cf4fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561736d06469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x561736cf7042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x561736cf4fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x561736cf4c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x561736cf4c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x561736da22cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x561736dcf6ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x561736dcba63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x561736dc387a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x561736dc376c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x561736dc29a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x561736d96107]
=================================
[dgx13:93300:0:93300] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  93300) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f98542c4c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f98542c4e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f98542c4fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f988ce47420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f9854347987]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f985437183d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f985427b93f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f985427eb18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f98542ce509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f985427dc2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f985434485a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f985440406a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c222b8d3f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c222b87fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c222b99469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c222b894e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c222b99712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x55c222ba6a83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x55c222cb219c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55c222b4c3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55c222b90723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55c222b8e929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c222b99712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c222b894e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c222b99712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c222b894e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c222b99712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c222b894e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c222b99712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c222b894e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c222b87fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c222b99469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55c222b8a042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c222b87fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55c222ba68cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55c222ba704c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55c222c6a80e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55c222b916ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c222b8d3f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c222b99712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55c222ba69ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c222b8d3f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c222b99712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c222b894e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c222b87fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c222b99469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c222b894e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c222b99712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55c222b89232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c222b87fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c222b99469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55c222b8a042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c222b87fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55c222b87c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55c222b87c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55c222c352cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55c222c626ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55c222c5ea63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55c222c5687a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55c222c5676c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55c222c559a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55c222c29107]
=================================
[dgx13:93287:0:93287] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  93287) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd288050c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7fd288050e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7fd288050fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd2c0a50420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fd281d5c987]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fd281d8683d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7fd281cf493f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7fd281cf7b18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd28805a509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd281cf6c2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd281d5985a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fd281e1906a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c916a6d3f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c916a67fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c916a79469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c916a694e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c916a79712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x55c916a86a83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x55c916b9219c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55c916a2c3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55c916a70723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55c916a6e929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c916a79712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c916a694e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c916a79712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c916a694e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c916a79712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c916a694e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c916a79712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c916a694e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c916a67fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c916a79469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55c916a6a042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c916a67fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55c916a868cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55c916a8704c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55c916b4a80e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55c916a716ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c916a6d3f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c916a79712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55c916a869ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c916a6d3f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c916a79712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c916a694e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c916a67fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c916a79469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c916a694e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c916a79712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55c916a69232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c916a67fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c916a79469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55c916a6a042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c916a67fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55c916a67c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55c916a67c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55c916b152cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55c916b426ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55c916b3ea63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55c916b3687a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55c916b3676c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55c916b359a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55c916b09107]
=================================
2024-02-08 07:07:36,299 - distributed.nanny - WARNING - Restarting worker
2024-02-08 07:07:36,800 - distributed.nanny - WARNING - Restarting worker
2024-02-08 07:07:37,161 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42199 -> ucx://127.0.0.1:35193
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3a49acc240, tag: 0xc7394cc0b88115b0, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-02-08 07:07:37,161 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35193
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f6cc49e1180, tag: 0xd798e718bfe2297b, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f6cc49e1180, tag: 0xd798e718bfe2297b, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-02-08 07:07:37,162 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35193
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f3a49acc100, tag: 0x39eee10a72c670c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f3a49acc100, tag: 0x39eee10a72c670c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-02-08 07:07:37,162 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:43961 -> ucx://127.0.0.1:35193
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #012] ep: 0x7f6cc49e1100, tag: 0xc94da037f403b8de, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1780, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #012] ep: 0x7f6cc49e1100, tag: 0xc94da037f403b8de, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-02-08 07:07:37,161 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35193
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f59e51cf100, tag: 0x7a2e1a3799b6cc3e, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f59e51cf100, tag: 0x7a2e1a3799b6cc3e, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2024-02-08 07:07:37,244 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42199 -> ucx://127.0.0.1:46849
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3a49acc280, tag: 0x97daad4744b71c51, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-02-08 07:07:37,246 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46849
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f3a49acc140, tag: 0x9071c21be3390a32, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f3a49acc140, tag: 0x9071c21be3390a32, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-02-08 07:07:37,292 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58359 -> ucx://127.0.0.1:46849
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f59e51cf240, tag: 0xacc3155b53361135, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-02-08 07:07:37,293 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46849
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f59e51cf140, tag: 0x4df5464b9f293927, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f59e51cf140, tag: 0x4df5464b9f293927, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-02-08 07:07:37,294 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46849
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #009] ep: 0x7f6cc49e1140, tag: 0xffbd2aba95e17776, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #009] ep: 0x7f6cc49e1140, tag: 0xffbd2aba95e17776, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2024-02-08 07:07:37,311 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50647
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f59e51cf180, tag: 0x7b65b37c48f3bfa8, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f59e51cf180, tag: 0x7b65b37c48f3bfa8, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-02-08 07:07:37,343 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50647
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: CancelledError()
2024-02-08 07:07:37,341 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:43961 -> ucx://127.0.0.1:50647
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f6cc49e1340, tag: 0x822a99e35457d60c, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-02-08 07:07:37,368 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50647
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f6cc49e11c0, tag: 0x2b5b87d8049d3cf9, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f6cc49e11c0, tag: 0x2b5b87d8049d3cf9, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-02-08 07:07:38,307 - distributed.worker - WARNING - Compute Failed
Key:       ('sort_index-86563d3c54ed11bf71e0c240596313fc', 5)
Function:  subgraph_callable-7a32e84e-a900-4bd4-899f-30e6ee25
args:      ('set_index_post_scalar-ceb9308523ab39bbcf59f6dccd678d89',                 key  shuffle   payload  _partitions
0             84000        5  68163435            5
1             84016        5  57260331            5
2             22624        5  77364842            5
3             84211        5  23318212            5
4             22626        5  51526491            5
...             ...      ...       ...          ...
99999995  799983649        5  62836408            5
99999996  799983652        5  28710518            5
99999997  799983653        5  44678054            5
99999998  799983668        5   7559899            5
99999999  799983670        5  26560330            5

[100000000 rows x 4 columns], 'simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e')
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:313: Maximum pool size exceeded')"

2024-02-08 07:07:38,459 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 3)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0            84010        3   7906625            3
1            84013        3  65089490            3
2            84015        3   3102559            3
3            84025        3  56211966            3
4            22640        3  23334859            3
...            ...      ...       ...          ...
12499995  99978653        3   5732236            3
12499996  99978691        3  26371922            3
12499997  99978707        3  38375654            3
12499998  99978709        3  43253909            3
12499999  99978713        3  70674704            3

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100014444        3  11775025            3
1         100093377        3  77437776            3
2         100014451        3  36821383            3
3         100093385        3  44822735            3
4         100014452        3  33659835            3
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:313: Maximum pool size exceeded')"

2024-02-08 07:07:47,082 - distributed.nanny - WARNING - Restarting worker
2024-02-08 07:07:47,285 - distributed.nanny - WARNING - Restarting worker
2024-02-08 07:07:47,446 - distributed.nanny - WARNING - Restarting worker
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
