[dgx13:80478:0:80478] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80478) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f71635a80cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f71635a82c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f71635a848a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f7203d06420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f7163627674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f71636507f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f71635623df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f7163565838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f71635b14f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f71635645dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f716362489a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f71636e55fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56523d67f6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56523d67b094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56523d68c519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56523d67c5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x56523d72f162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f71847bb1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56523d68477c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x56523d636d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x56523d6837f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x56523d681929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56523d68c7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56523d67c5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56523d68c7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56523d67c5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56523d68c7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56523d67c5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56523d68c7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56523d67c5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56523d67b094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56523d68c519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56523d67d128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56523d67b094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x56523d699ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56523d69a44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x56523d75d10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56523d68477c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56523d67f6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56523d68c7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x56523d699dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56523d67f6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56523d68c7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56523d67c5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56523d67b094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56523d68c519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56523d67c5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56523d68c7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x56523d67c312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56523d67b094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56523d68c519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56523d67d128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56523d67b094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x56523d67ad68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56523d67ad19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56523d72807b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x56523d754fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x56523d751353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x56523d74916a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x56523d74905c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x56523d748297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x56523d71bf07]
=================================
2023-09-17 07:28:31,809 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:52109 -> ucx://127.0.0.1:41049
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f35b72e6100, tag: 0xfebf51a29ea04c09, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
Task exception was never retrieved
future: <Task finished name='Task-754' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-09-17 07:28:31,903 - distributed.nanny - WARNING - Restarting worker
[dgx13:80481:0:80481] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
[dgx13:80461:0:80461] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80481) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f1010b7b0cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f1010b7b2c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f1010b7b48a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f10b115a420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f1010bfa674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f1010c237f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f1010b353df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f1010b38838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f1010b844f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f1010b375dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f1010bf789a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f1010cb85fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55a309a996fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55a309a95094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a309aa6519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a309a965c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a309aa67c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55a309ab3e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55a309bbeb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55a309a50d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55a309a9d7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55a309a9b929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a309aa67c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a309a965c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a309aa67c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a309a965c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a309aa67c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a309a965c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a309aa67c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a309a965c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55a309a95094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a309aa6519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55a309a97128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55a309a95094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55a309ab3ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55a309ab444c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55a309b7710e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55a309a9e77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55a309a996fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a309aa67c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55a309ab3dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55a309a996fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a309aa67c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a309a965c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55a309a95094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a309aa6519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a309a965c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a309aa67c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55a309a96312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55a309a95094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a309aa6519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55a309a97128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55a309a95094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55a309a94d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55a309a94d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55a309b4207b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55a309b6efca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55a309b6b353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55a309b6316a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55a309b6305c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55a309b62297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55a309b35f07]
=================================
==== backtrace (tid:  80461) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f35b75530cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f35b75532c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f35b755348a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f365bcc3420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f35b75d2674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f35b75fb7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f35b750d3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f35b7510838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f35b755c4f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f35b750f5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f35b75cf89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f35b76905fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x558665a3c6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558665a38094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558665a49519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558665a395c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x558665aec162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f35dc7791e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x558665a4177c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5586659f3d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x558665a407f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x558665a3e929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558665a497c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558665a395c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558665a497c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558665a395c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558665a497c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558665a395c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558665a497c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558665a395c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558665a38094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558665a49519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x558665a3a128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558665a38094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x558665a56ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x558665a5744c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x558665b1a10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x558665a4177c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x558665a3c6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558665a497c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x558665a56dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x558665a3c6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558665a497c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558665a395c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558665a38094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558665a49519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558665a395c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558665a497c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x558665a39312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558665a38094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558665a49519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x558665a3a128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558665a38094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x558665a37d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x558665a37d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x558665ae507b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x558665b11fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x558665b0e353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x558665b0616a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x558665b0605c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x558665b05297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x558665ad8f07]
=================================
2023-09-17 07:28:32,404 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:52109
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f4e60b3f180, tag: 0x78ddf90a9ebd640d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f4e60b3f180, tag: 0x78ddf90a9ebd640d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
[1694935712.406332] [dgx13:80475:0]            sock.c:323  UCX  ERROR     connect(fd=124, dest_addr=127.0.0.1:53769) failed: Connection refused
2023-09-17 07:28:32,404 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:52109
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7fa0a9433140, tag: 0xe02a2d13d1ec7123, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7fa0a9433140, tag: 0xe02a2d13d1ec7123, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-17 07:28:32,410 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35939
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f4e60b3f200, tag: 0xda65f57efb48db81, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f4e60b3f200, tag: 0xda65f57efb48db81, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-17 07:28:32,409 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:52109
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-09-17 07:28:32,413 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35939
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
[1694935712.419347] [dgx13:80473:0]            sock.c:323  UCX  ERROR     connect(fd=125, dest_addr=127.0.0.1:50787) failed: Connection refused
[dgx13:80475:0:80475] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80475) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fb5199100cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7fb5199102c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7fb51991048a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fb5be059420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fb51998f674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fb5199b87f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fb5198ca3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fb5198cd838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fb5199194f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fb5198cc5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fb51998c89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fb519a4d5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x557de11ad6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x557de11a9094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x557de11ba519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557de11aa5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x557de11ba7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x557de11c7e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x557de12d2b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x557de1164d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x557de11b17f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x557de11af929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x557de11ba7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557de11aa5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x557de11ba7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557de11aa5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x557de11ba7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557de11aa5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x557de11ba7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557de11aa5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x557de11a9094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x557de11ba519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x557de11ab128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x557de11a9094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x557de11c7ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x557de11c844c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x557de128b10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x557de11b277c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x557de11ad6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x557de11ba7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x557de11c7dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x557de11ad6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x557de11ba7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557de11aa5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x557de11a9094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x557de11ba519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557de11aa5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x557de11ba7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x557de11aa312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x557de11a9094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x557de11ba519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x557de11ab128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x557de11a9094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x557de11a8d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x557de11a8d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x557de125607b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x557de1282fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x557de127f353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x557de127716a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x557de127705c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x557de1276297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x557de1249f07]
=================================
2023-09-17 07:28:32,506 - distributed.nanny - WARNING - Restarting worker
[dgx13:80473:0:80473] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80473) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f97346830cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f97346832c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f973468348a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f97c6c61420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f9734702674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f973472b7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f973463d3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f9734640838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f973468c4f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f973463f5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f97346ff89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f97347c05fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5637944e36fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5637944df094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5637944f0519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5637944e05c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x563794593162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f97477161e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5637944e877c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x56379449ad05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5637944e77f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5637944e5929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5637944f07c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5637944e05c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5637944f07c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5637944e05c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5637944f07c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5637944e05c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5637944f07c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5637944e05c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5637944df094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5637944f0519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5637944e1128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5637944df094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5637944fdccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5637944fe44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5637945c110e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5637944e877c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5637944e36fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5637944f07c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5637944fddac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5637944e36fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5637944f07c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5637944e05c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5637944df094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5637944f0519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5637944e05c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5637944f07c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5637944e0312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5637944df094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5637944f0519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5637944e1128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5637944df094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5637944ded68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5637944ded19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56379458c07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5637945b8fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5637945b5353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5637945ad16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5637945ad05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5637945ac297]
2023-09-17 07:28:32,548 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35939
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7fa0a9433180, tag: 0x311d7d0340a68f49, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7fa0a9433180, tag: 0x311d7d0340a68f49, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x56379457ff07]
=================================
2023-09-17 07:28:32,576 - distributed.nanny - WARNING - Restarting worker
Task exception was never retrieved
future: <Task finished name='Task-4111' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-09-17 07:28:32,744 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59251 -> ucx://127.0.0.1:33639
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fec62d52200, tag: 0xf7db90a3d6d09790, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-17 07:28:32,744 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:33639
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f4e60b3f240, tag: 0x27a89dec5cfe31c7, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f4e60b3f240, tag: 0x27a89dec5cfe31c7, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-17 07:28:32,744 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:33639
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fec62d523c0, tag: 0x6f3dab923971e55a, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fec62d523c0, tag: 0x6f3dab923971e55a, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
Task exception was never retrieved
future: <Task finished name='Task-912' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-09-17 07:28:32,746 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:33639
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fa0a9433200, tag: 0xe451d00a4fdc2575, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fa0a9433200, tag: 0xe451d00a4fdc2575, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
Task exception was never retrieved
future: <Task finished name='Task-913' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-09-17 07:28:32,818 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:45091
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fa0a9433100, tag: 0x1659e286376058d2, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fa0a9433100, tag: 0x1659e286376058d2, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-17 07:28:32,827 - distributed.nanny - WARNING - Restarting worker
2023-09-17 07:28:32,866 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59251 -> ucx://127.0.0.1:45091
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fec62d52240, tag: 0x6029f73d86018d20, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-17 07:28:32,868 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:45091
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fec62d52340, tag: 0x1262e8ccc16df6a2, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fec62d52340, tag: 0x1262e8ccc16df6a2, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
Task exception was never retrieved
future: <Task finished name='Task-4122' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-09-17 07:28:32,891 - distributed.nanny - WARNING - Restarting worker
2023-09-17 07:28:32,870 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:45091
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f4e60b3f140, tag: 0xd4bfa98009c5156d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f4e60b3f140, tag: 0xd4bfa98009c5156d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-09-17 07:28:34,356 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-b0648aa7f9e27a40d5f4d39e31c5b5a2', 1)
Function:  shuffle_group
args:      (               key   payload
shuffle                     
1            14400  56308165
1            60105   3579789
1            60107  12954710
1            14410  71462416
1            60111  63481829
...            ...       ...
1        799938597  93237096
1        799938601  88100857
1        799938602  11668547
1        799938612  97097055
1        799938615  91705121

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

[dgx13:80633:0:80633] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80633) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f98f02220cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f98f02222c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f98f022248a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f9982803420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f98f02a1674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f98f02ca7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f98f01dc3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f98f01df838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f98f022b4f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f98f01de5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f98f029e89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f98f035f5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559b6661f6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559b6661b094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559b6662c519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559b6661c5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x559b666cf162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f99032b71e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559b6662477c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x559b665d6d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x559b666237f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x559b66621929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559b6662c7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559b6661c5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559b6662c7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559b6661c5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559b6662c7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559b6661c5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559b6662c7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559b6661c5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559b6661b094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559b6662c519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x559b6661d128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559b6661b094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x559b66639ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x559b6663a44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x559b666fd10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559b6662477c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559b6661f6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559b6662c7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x559b66639dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559b6661f6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559b6662c7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559b6661c5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559b6661b094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559b6662c519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559b6661c5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559b6662c7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x559b6661c312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559b6661b094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559b6662c519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x559b6661d128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559b6661b094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x559b6661ad68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559b6661ad19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x559b666c807b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x559b666f4fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x559b666f1353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x559b666e916a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x559b666e905c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x559b666e8297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x559b666bbf07]
=================================
[dgx13:80653:0:80653] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80653) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f23a82aa0cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f23a82aa2c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f23a82aa48a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f2448885420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f23a8329674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f23a83527f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f23a82643df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f23a8267838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f23a82b34f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f23a82665dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f23a832689a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f23a83e75fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5599a019e6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5599a019a094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5599a01ab519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5599a019b5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5599a024e162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f23c932f1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5599a01a377c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5599a0155d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5599a01a27f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5599a01a0929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5599a01ab7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5599a019b5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5599a01ab7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5599a019b5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5599a01ab7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5599a019b5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5599a01ab7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5599a019b5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5599a019a094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5599a01ab519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5599a019c128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5599a019a094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5599a01b8ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5599a01b944c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5599a027c10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5599a01a377c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5599a019e6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5599a01ab7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5599a01b8dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5599a019e6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5599a01ab7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5599a019b5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5599a019a094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5599a01ab519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5599a019b5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5599a01ab7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5599a019b312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5599a019a094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5599a01ab519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5599a019c128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5599a019a094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5599a0199d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5599a0199d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5599a024707b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5599a0273fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5599a0270353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5599a026816a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5599a026805c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5599a0267297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5599a023af07]
=================================
2023-09-17 07:28:37,902 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58105 -> ucx://127.0.0.1:60217
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f4e60b3f200, tag: 0x2494eb26afc28320, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-17 07:28:37,902 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:60217
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fec62d52240, tag: 0xf04b790a5b47fb66, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fec62d52240, tag: 0xf04b790a5b47fb66, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-17 07:28:37,902 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:60217
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7fa0a9433380, tag: 0x2f8221deea5f6f81, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7fa0a9433380, tag: 0x2f8221deea5f6f81, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-09-17 07:28:37,903 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:60217
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f4e60b3f140, tag: 0x2ea8d9808b8a2693, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f4e60b3f140, tag: 0x2ea8d9808b8a2693, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-17 07:28:37,972 - distributed.nanny - WARNING - Restarting worker
2023-09-17 07:28:37,983 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:53319 -> ucx://127.0.0.1:36661
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fa0a9433340, tag: 0x29abfb7e5300b001, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-17 07:28:37,983 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59251 -> ucx://127.0.0.1:36661
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fec62d52200, tag: 0x955eea485504a08b, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-17 07:28:38,045 - distributed.nanny - WARNING - Restarting worker
[dgx13:80738:0:80738] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80738) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7ff84d38f0cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7ff84d38f2c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7ff84d38f48a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7ff8f1979420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7ff84d40e674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7ff84d4377f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7ff84d3493df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7ff84d34c838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7ff84d3984f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7ff84d34b5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7ff84d40b89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7ff8600555fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55984ffbc6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55984ffb8094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55984ffc9519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55984ffb95c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55984ffc97c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55984ffd6e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x5598500e1b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55984ff73d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55984ffc07f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55984ffbe929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55984ffc97c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55984ffb95c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55984ffc97c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55984ffb95c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55984ffc97c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55984ffb95c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55984ffc97c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55984ffb95c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55984ffb8094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55984ffc9519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55984ffba128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55984ffb8094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55984ffd6ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55984ffd744c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55985009a10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55984ffc177c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55984ffbc6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55984ffc97c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55984ffd6dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55984ffbc6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55984ffc97c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55984ffb95c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55984ffb8094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55984ffc9519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55984ffb95c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55984ffc97c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55984ffb9312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55984ffb8094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55984ffc9519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55984ffba128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55984ffb8094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55984ffb7d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55984ffb7d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55985006507b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x559850091fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55985008e353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55985008616a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55985008605c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x559850085297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x559850058f07]
=================================
2023-09-17 07:28:41,449 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58105 -> ucx://127.0.0.1:53245
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f4e60b3f380, tag: 0x28950091ecea6467, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
Task exception was never retrieved
future: <Task finished name='Task-6008' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Endpoint timeout')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Endpoint timeout
2023-09-17 07:28:41,492 - distributed.nanny - WARNING - Restarting worker
[dgx13:80650:0:80650] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80650) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f539402a0cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f539402a2c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f539402a48a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f5421307420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f5380d61674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f5380d8a7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f5380cfb3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f5380cfe838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f53940334f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f5380cfd5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f5380d5e89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f5380e1f5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x563377a6b6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x563377a67094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563377a78519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563377a685c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x563377b1b162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f54141311e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x563377a7077c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x563377a22d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x563377a6f7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x563377a6d929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563377a787c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563377a685c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563377a787c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563377a685c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563377a787c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563377a685c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563377a787c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563377a685c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x563377a67094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563377a78519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x563377a69128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x563377a67094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x563377a85ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x563377a8644c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x563377b4910e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x563377a7077c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x563377a6b6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563377a787c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x563377a85dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x563377a6b6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563377a787c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563377a685c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x563377a67094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563377a78519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563377a685c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563377a787c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x563377a68312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x563377a67094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563377a78519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x563377a69128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x563377a67094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x563377a66d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x563377a66d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x563377b1407b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x563377b40fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x563377b3d353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x563377b3516a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x563377b3505c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x563377b34297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x563377b07f07]
=================================
2023-09-17 07:28:41,957 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59251 -> ucx://127.0.0.1:55195
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fec62d52240, tag: 0x635b176620066655, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-17 07:28:41,957 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:53319 -> ucx://127.0.0.1:55195
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fa0a9433380, tag: 0xff85b0127c4ba652, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-17 07:28:41,958 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55195
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fec62d52200, tag: 0xd34ee331db256730, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fec62d52200, tag: 0xd34ee331db256730, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-17 07:28:41,958 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58105 -> ucx://127.0.0.1:55195
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f4e60b3f200, tag: 0x4bee89473143a086, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-17 07:28:41,958 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55195
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fa0a9433340, tag: 0xdf7e93f770ad3c0d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fa0a9433340, tag: 0xdf7e93f770ad3c0d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-17 07:28:41,959 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55195
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f4e60b3f140, tag: 0xd9764c8b3ff5ea80, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f4e60b3f140, tag: 0xd9764c8b3ff5ea80, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-17 07:28:41,978 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55195
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f238437a100, tag: 0x1a0e47be8d7b10f4, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f238437a100, tag: 0x1a0e47be8d7b10f4, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-17 07:28:42,032 - distributed.nanny - WARNING - Restarting worker
[dgx13:80645:0:80645] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80645) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f48b1ca40cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f48b1ca42c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f48b1ca448a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f495427f420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f48b1d23674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f48b1d4c7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f48b1c5e3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f48b1c61838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f48b1cad4f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f48b1c605dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f48b1d2089a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f48b1de15fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ec4ce326fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ec4ce2e094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ec4ce3f519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec4ce2f5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec4ce3f7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55ec4ce4ce83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55ec4cf57b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55ec4cde9d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55ec4ce367f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55ec4ce34929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec4ce3f7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec4ce2f5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec4ce3f7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec4ce2f5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec4ce3f7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec4ce2f5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec4ce3f7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec4ce2f5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ec4ce2e094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ec4ce3f519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55ec4ce30128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ec4ce2e094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55ec4ce4cccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55ec4ce4d44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55ec4cf1010e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55ec4ce3777c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ec4ce326fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec4ce3f7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55ec4ce4cdac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ec4ce326fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec4ce3f7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec4ce2f5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ec4ce2e094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ec4ce3f519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec4ce2f5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec4ce3f7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55ec4ce2f312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ec4ce2e094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ec4ce3f519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55ec4ce30128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ec4ce2e094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55ec4ce2dd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55ec4ce2dd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55ec4cedb07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55ec4cf07fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55ec4cf04353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55ec4cefc16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55ec4cefc05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55ec4cefb297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55ec4cecef07]
=================================
2023-09-17 07:28:42,569 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:53319 -> ucx://127.0.0.1:56625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fa0a9433380, tag: 0x97f1e31a7d1be578, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-17 07:28:42,569 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:56625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7fec62d52200, tag: 0xfff604bd2951817c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7fec62d52200, tag: 0xfff604bd2951817c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-09-17 07:28:42,569 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58105 -> ucx://127.0.0.1:56625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f4e60b3f200, tag: 0xd9f93d0ae150bfee, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-17 07:28:42,569 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:56625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fa0a9433340, tag: 0x4b669e0a8ad78300, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fa0a9433340, tag: 0x4b669e0a8ad78300, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-17 07:28:42,570 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:56625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f4e60b3f140, tag: 0xca70676c16112243, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f4e60b3f140, tag: 0xca70676c16112243, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-17 07:28:42,633 - distributed.nanny - WARNING - Restarting worker
[dgx13:80741:0:80741] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80741) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f23846270cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f23846272c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f238462748a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f2416c0f420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f23846a6674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f23846cf7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f23845e13df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f23845e4838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f23846304f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f23845e35dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f23846a389a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f23847645fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5621c3c216fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5621c3c1d094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5621c3c2e519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5621c3c1e5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5621c3cd1162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f23976c31e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5621c3c2677c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5621c3bd8d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5621c3c257f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5621c3c23929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5621c3c2e7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5621c3c1e5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5621c3c2e7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5621c3c1e5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5621c3c2e7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5621c3c1e5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5621c3c2e7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5621c3c1e5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5621c3c1d094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5621c3c2e519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5621c3c1f128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5621c3c1d094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5621c3c3bccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5621c3c3c44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5621c3cff10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5621c3c2677c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5621c3c216fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5621c3c2e7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5621c3c3bdac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5621c3c216fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5621c3c2e7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5621c3c1e5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5621c3c1d094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5621c3c2e519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5621c3c1e5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5621c3c2e7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5621c3c1e312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5621c3c1d094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5621c3c2e519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5621c3c1f128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5621c3c1d094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5621c3c1cd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5621c3c1cd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5621c3cca07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5621c3cf6fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5621c3cf3353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5621c3ceb16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5621c3ceb05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5621c3cea297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5621c3cbdf07]
=================================
2023-09-17 07:28:45,030 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58631
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fa0a9433340, tag: 0x6775d599d17e1ea1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fa0a9433340, tag: 0x6775d599d17e1ea1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-17 07:28:45,030 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58631
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fec62d52200, tag: 0xb6ac15b0c54c40cd, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fec62d52200, tag: 0xb6ac15b0c54c40cd, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-17 07:28:45,030 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58631
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f4e60b3f140, tag: 0xb6828948d0f817c1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f4e60b3f140, tag: 0xb6828948d0f817c1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-09-17 07:28:45,030 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:53319 -> ucx://127.0.0.1:58631
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fa0a9433380, tag: 0xf2c4dbd195f3ea9f, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-17 07:28:45,030 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58105 -> ucx://127.0.0.1:58631
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #012] ep: 0x7f4e60b3f180, tag: 0x4bb638928b1f17a7, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1783, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #012] ep: 0x7f4e60b3f180, tag: 0x4bb638928b1f17a7, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-17 07:28:45,091 - distributed.nanny - WARNING - Restarting worker
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
