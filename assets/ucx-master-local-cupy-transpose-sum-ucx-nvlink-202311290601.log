[dgx13:75053:0:75053] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  75053) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f7f1c8b306d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f7f1c8b3264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f7f1c8b342a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f7fbdc71420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f7f1c9316a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f7f1c95a829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f7f1c86d46f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f7f1c8708c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f7f1c8bc499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f7f1c86f66d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f7f1c92e8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f7f1c9e706a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5587f96cc6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5587f96c8094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5587f96d9519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5587f96c95c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5587f977c162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f7fafc111e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5587f96d177c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5587f9683d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5587f96d07f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5587f96ce929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5587f96d97c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5587f96c95c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5587f96d97c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5587f96c95c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5587f96d97c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5587f96c95c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5587f96d97c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5587f96c95c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5587f96c8094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5587f96d9519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5587f96ca128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5587f96c8094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5587f96e6ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5587f96e744c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5587f97aa10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5587f96d177c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5587f96cc6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5587f96d97c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5587f96e6dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5587f96cc6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5587f96d97c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5587f96c95c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5587f96c8094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5587f96d9519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5587f96c95c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5587f96d97c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5587f96c9312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5587f96c8094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5587f96d9519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5587f96ca128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5587f96c8094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5587f96c7d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5587f96c7d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5587f977507b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5587f97a1fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5587f979e353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5587f979616a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5587f979605c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5587f9795297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5587f9768f07]
=================================
[dgx13:75065:0:75065] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  75065) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f6e9487a06d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f6e9487a264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f6e9487a42a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f6f27c57420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f6e948f86a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f6e94921829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f6e9483446f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f6e948378c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f6e94883499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f6e9483666d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f6e948f58ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f6e949ae06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x556398bf36fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556398bef094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556398c00519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556398bf05c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556398c007c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x556398c0de83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x556398d18b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x556398baad05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x556398bf77f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x556398bf5929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556398c007c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556398bf05c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556398c007c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556398bf05c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556398c007c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556398bf05c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556398c007c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556398bf05c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556398bef094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556398c00519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x556398bf1128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556398bef094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x556398c0dccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x556398c0e44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x556398cd110e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x556398bf877c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x556398bf36fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556398c007c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x556398c0ddac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x556398bf36fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556398c007c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556398bf05c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556398bef094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556398c00519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556398bf05c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556398c007c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x556398bf0312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556398bef094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556398c00519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x556398bf1128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556398bef094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x556398beed68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x556398beed19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x556398c9c07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x556398cc8fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x556398cc5353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x556398cbd16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x556398cbd05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x556398cbc297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x556398c8ff07]
=================================
[dgx13:75041:0:75041] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  75041) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f2d000e306d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f2d000e3264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f2d000e342a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f2d93496420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f2d001616a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f2d0018a829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f2d0009d46f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f2d000a08c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f2d000ec499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f2d0009f66d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f2d0015e8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f2d0021706a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559bb1c916fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559bb1c8d094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559bb1c9e519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559bb1c8e5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559bb1c9e7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x559bb1cabe83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x559bb1db6b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x559bb1c48d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x559bb1c957f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x559bb1c93929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559bb1c9e7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559bb1c8e5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559bb1c9e7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559bb1c8e5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559bb1c9e7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559bb1c8e5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559bb1c9e7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559bb1c8e5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559bb1c8d094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559bb1c9e519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x559bb1c8f128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559bb1c8d094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x559bb1cabccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x559bb1cac44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x559bb1d6f10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559bb1c9677c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559bb1c916fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559bb1c9e7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x559bb1cabdac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559bb1c916fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559bb1c9e7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559bb1c8e5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559bb1c8d094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559bb1c9e519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559bb1c8e5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559bb1c9e7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x559bb1c8e312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559bb1c8d094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559bb1c9e519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x559bb1c8f128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559bb1c8d094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x559bb1c8cd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559bb1c8cd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x559bb1d3a07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x559bb1d66fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x559bb1d63353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x559bb1d5b16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x559bb1d5b05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x559bb1d5a297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x559bb1d2df07]
=================================
2023-11-29 07:16:47,162 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58431 -> ucx://127.0.0.1:48021
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f32d4394240, tag: 0x2c29b00bcac140b2, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-29 07:16:47,162 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48021
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7fc7c2719200, tag: 0xf4dd397ae3769e1b, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7fc7c2719200, tag: 0xf4dd397ae3769e1b, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:47,162 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48021
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f14ec378100, tag: 0xb4b6a3c840fe79c7, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f14ec378100, tag: 0xb4b6a3c840fe79c7, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:47,163 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48021
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f32d4394180, tag: 0x8814c0b5e7ab3553, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f32d4394180, tag: 0x8814c0b5e7ab3553, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:47,162 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48021
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fe2f0553200, tag: 0xf6a91c75a87fb79b, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fe2f0553200, tag: 0xf6a91c75a87fb79b, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:47,198 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:49637 -> ucx://127.0.0.1:46179
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f14ec378280, tag: 0x8256e04f14e5e8d6, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-29 07:16:47,198 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46179
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f32d4394100, tag: 0xb730d441681d8f61, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f32d4394100, tag: 0xb730d441681d8f61, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:47,199 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:56955 -> ucx://127.0.0.1:46179
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7fc7c2719280, tag: 0xc939a792594e79d9, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1783, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7fc7c2719280, tag: 0xc939a792594e79d9, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:47,199 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46179
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f14ec378180, tag: 0x37364330fa6d042c, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f14ec378180, tag: 0x37364330fa6d042c, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-11-29 07:16:47,199 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46179
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7fe2f0553140, tag: 0x1012b6a3f79a60c5, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7fe2f0553140, tag: 0x1012b6a3f79a60c5, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:47,203 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46179
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f0750193200, tag: 0xc1fdb022950a8d88, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f0750193200, tag: 0xc1fdb022950a8d88, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:47,224 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:45171
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f32d4394200, tag: 0x43d5f0465fc4bbdc, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f32d4394200, tag: 0x43d5f0465fc4bbdc, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:47,224 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:45171
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fe2f05531c0, tag: 0xf1a0258312ae8dd0, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fe2f05531c0, tag: 0xf1a0258312ae8dd0, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:47,224 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:52949 -> ucx://127.0.0.1:45171
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0750193240, tag: 0xe71d1fbc57cf0eee, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
Task exception was never retrieved
future: <Task finished name='Task-297' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-11-29 07:16:47,230 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:45171
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
[dgx13:75056:0:75056] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  75056) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fe2f085a06d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7fe2f085a264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7fe2f085a42a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fe383c0d420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fe2f08d86a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fe2f0901829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7fe2f081446f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7fe2f08178c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fe2f0863499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fe2f081666d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fe2f08d58ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fe2f098e06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564de41af6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564de41ab094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564de41bc519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564de41ac5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564de41bc7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x564de41c9e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x564de42d4b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x564de4166d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x564de41b37f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x564de41b1929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564de41bc7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564de41ac5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564de41bc7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564de41ac5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564de41bc7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564de41ac5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564de41bc7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564de41ac5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564de41ab094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564de41bc519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x564de41ad128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564de41ab094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x564de41c9ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x564de41ca44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x564de428d10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x564de41b477c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564de41af6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564de41bc7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x564de41c9dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564de41af6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564de41bc7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564de41ac5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564de41ab094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564de41bc519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564de41ac5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564de41bc7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x564de41ac312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564de41ab094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564de41bc519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x564de41ad128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564de41ab094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x564de41aad68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x564de41aad19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x564de425807b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x564de4284fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x564de4281353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x564de427916a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x564de427905c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x564de4278297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x564de424bf07]
=================================
2023-11-29 07:16:48,381 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49627
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fc7c27191c0, tag: 0xbb015bbe8bac24c6, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fc7c27191c0, tag: 0xbb015bbe8bac24c6, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-11-29 07:16:48,381 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:52949 -> ucx://127.0.0.1:49627
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0750193200, tag: 0xc99ca18e42784ddf, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-29 07:16:48,382 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:56955 -> ucx://127.0.0.1:49627
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7fc7c2719300, tag: 0x6cf3ba94bc0dd18d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1783, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7fc7c2719300, tag: 0x6cf3ba94bc0dd18d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:51,425 - distributed.nanny - WARNING - Restarting worker
2023-11-29 07:16:51,643 - distributed.nanny - WARNING - Restarting worker
2023-11-29 07:16:51,698 - distributed.nanny - WARNING - Restarting worker
2023-11-29 07:16:52,149 - distributed.nanny - WARNING - Restarting worker
[dgx13:75059:0:75059] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  75059) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f14ec65206d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f14ec652264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f14ec65242a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f158da1e420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f14ec6d06a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f14ec6f9829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f14ec60c46f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f14ec60f8c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f14ec65b499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f14ec60e66d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f14ec6cd8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f14ec78606a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56255ccee6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56255ccea094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56255ccfb519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56255cceb5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56255ccfb7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x56255cd08e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x56255ce13b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x56255cca5d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x56255ccf27f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x56255ccf0929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56255ccfb7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56255cceb5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56255ccfb7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56255cceb5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56255ccfb7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56255cceb5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56255ccfb7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56255cceb5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56255ccea094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56255ccfb519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56255ccec128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56255ccea094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x56255cd08ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56255cd0944c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x56255cdcc10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56255ccf377c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56255ccee6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56255ccfb7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x56255cd08dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56255ccee6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56255ccfb7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56255cceb5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56255ccea094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56255ccfb519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56255cceb5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56255ccfb7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x56255cceb312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56255ccea094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56255ccfb519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56255ccec128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56255ccea094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x56255cce9d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56255cce9d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56255cd9707b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x56255cdc3fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x56255cdc0353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x56255cdb816a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x56255cdb805c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x56255cdb7297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x56255cd8af07]
=================================
[dgx13:75202:0:75202] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  75202) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7faed75f106d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7faed75f1264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7faed75f142a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7faf7c85e420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7faed766f6a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7faed7698829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7faed75ab46f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7faed75ae8c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7faed75fa499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7faed75ad66d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7faed766c8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7faed772506a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56042390a6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560423906094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560423917519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5604239075c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5604239ba162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7faf7281f1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56042390f77c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5604238c1d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x56042390e7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x56042390c929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5604239177c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5604239075c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5604239177c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5604239075c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5604239177c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5604239075c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5604239177c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5604239075c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560423906094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560423917519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x560423908128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560423906094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x560423924ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56042392544c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5604239e810e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56042390f77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56042390a6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5604239177c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x560423924dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56042390a6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5604239177c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5604239075c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560423906094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560423917519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5604239075c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5604239177c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x560423907312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560423906094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560423917519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x560423908128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560423906094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x560423905d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x560423905d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5604239b307b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5604239dffca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5604239dc353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5604239d416a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5604239d405c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5604239d3297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5604239a6f07]
=================================
[dgx13:75207:0:75207] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  75207) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f756108a06d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f756108a264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f756108a42a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f75f4336420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f75611086a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f7561131829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f756104446f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f75610478c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f7561093499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f756104666d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f75611058ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f75611be06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5560793016fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5560792fd094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55607930e519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5560792fe5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5560793b1162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f75ea2df1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55607930677c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5560792b8d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5560793057f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x556079303929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55607930e7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5560792fe5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55607930e7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5560792fe5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55607930e7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5560792fe5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55607930e7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5560792fe5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5560792fd094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55607930e519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5560792ff128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5560792fd094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55607931bccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55607931c44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5560793df10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55607930677c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5560793016fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55607930e7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55607931bdac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5560793016fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55607930e7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5560792fe5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5560792fd094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55607930e519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5560792fe5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55607930e7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5560792fe312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5560792fd094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55607930e519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5560792ff128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5560792fd094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5560792fcd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5560792fcd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5560793aa07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5560793d6fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5560793d3353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5560793cb16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5560793cb05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5560793ca297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55607939df07]
=================================
2023-11-29 07:16:55,332 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49637
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f0750193140, tag: 0x10b0588d0845981a, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f0750193140, tag: 0x10b0588d0845981a, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-11-29 07:16:55,332 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49637
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #013] ep: 0x7fc7c2719140, tag: 0x2fdaf7554404a03f, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #013] ep: 0x7fc7c2719140, tag: 0x2fdaf7554404a03f, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:55,333 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:52949 -> ucx://127.0.0.1:49637
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7f0750193240, tag: 0xa83085a99fedbd0d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1783, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7f0750193240, tag: 0xa83085a99fedbd0d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:55,332 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58577 -> ucx://127.0.0.1:49637
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f6ec107a0c0, tag: 0xcffdf81c3656c71, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-29 07:16:55,340 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49637
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
[dgx13:75199:0:75199] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  75199) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd24051806d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7fd240518264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7fd24051842a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd2d3784420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fd2405966a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fd2405bf829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7fd2404d246f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7fd2404d58c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd240521499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd2404d466d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd2405938ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fd24064c06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5636e43596fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5636e4355094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5636e4366519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636e43565c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636e43667c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x5636e4373e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x5636e447eb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5636e4310d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5636e435d7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5636e435b929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636e43667c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636e43565c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636e43667c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636e43565c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636e43667c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636e43565c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636e43667c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636e43565c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5636e4355094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5636e4366519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5636e4357128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5636e4355094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5636e4373ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5636e437444c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5636e443710e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5636e435e77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5636e43596fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636e43667c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5636e4373dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5636e43596fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636e43667c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636e43565c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5636e4355094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5636e4366519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636e43565c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636e43667c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5636e4356312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5636e4355094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5636e4366519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5636e4357128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5636e4355094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5636e4354d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5636e4354d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5636e440207b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5636e442efca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5636e442b353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5636e442316a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5636e442305c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5636e4422297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5636e43f5f07]
=================================
[dgx13:75195:0:75195] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  75195) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f6ec1ae506d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f6ec1ae5264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f6ec1ae542a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f6f64dca420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f6ec1b636a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f6ec1b8c829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f6ec1a9f46f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f6ec1aa28c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f6ec1aee499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f6ec1aa166d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f6ec1b608ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f6ec1c1906a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x562f5b4cb6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x562f5b4c7094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x562f5b4d8519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562f5b4c85c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x562f5b4d87c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x562f5b4e5e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x562f5b5f0b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x562f5b482d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x562f5b4cf7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x562f5b4cd929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x562f5b4d87c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562f5b4c85c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x562f5b4d87c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562f5b4c85c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x562f5b4d87c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562f5b4c85c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x562f5b4d87c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562f5b4c85c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x562f5b4c7094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x562f5b4d8519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x562f5b4c9128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x562f5b4c7094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x562f5b4e5ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x562f5b4e644c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x562f5b5a910e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x562f5b4d077c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x562f5b4cb6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x562f5b4d87c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x562f5b4e5dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x562f5b4cb6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x562f5b4d87c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562f5b4c85c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x562f5b4c7094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x562f5b4d8519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562f5b4c85c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x562f5b4d87c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x562f5b4c8312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x562f5b4c7094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x562f5b4d8519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x562f5b4c9128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x562f5b4c7094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x562f5b4c6d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x562f5b4c6d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x562f5b57407b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x562f5b5a0fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x562f5b59d353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x562f5b59516a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x562f5b59505c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x562f5b594297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x562f5b567f07]
=================================
2023-11-29 07:16:55,557 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:52949 -> ucx://127.0.0.1:53687
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0750193280, tag: 0xc1db70d9a3521ef, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-29 07:16:55,557 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53687
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f0750193200, tag: 0x4c04af2e80b6d50f, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f0750193200, tag: 0x4c04af2e80b6d50f, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
Task exception was never retrieved
future: <Task finished name='Task-4139' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-11-29 07:16:55,646 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:52949 -> ucx://127.0.0.1:59431
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0750193380, tag: 0xb0390c0b2ab5ec25, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-29 07:16:55,647 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59431
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f0750193340, tag: 0x4b9b185e27d242c2, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f0750193340, tag: 0x4b9b185e27d242c2, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-29 07:16:56,162 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58431 -> ucx://127.0.0.1:54631
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f32d4394300, tag: 0x90ccb29ed086fccb, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-29 07:16:56,259 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58431 -> ucx://127.0.0.1:58577
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #014] ep: 0x7f32d4394280, tag: 0xc5a4560fa5cc6c99, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-29 07:16:56,265 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58577
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-11-29 07:17:00,286 - distributed.nanny - WARNING - Restarting worker
2023-11-29 07:17:01,108 - distributed.nanny - WARNING - Restarting worker
2023-11-29 07:17:01,441 - distributed.nanny - WARNING - Restarting worker
2023-11-29 07:17:01,596 - distributed.nanny - WARNING - Restarting worker
2023-11-29 07:17:01,597 - distributed.nanny - WARNING - Restarting worker
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 24 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
