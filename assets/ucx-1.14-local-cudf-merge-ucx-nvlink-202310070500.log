[dgx13:76086:0:76086] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  76086) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fbf81c93f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7fbf81c94114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7fbf81c942da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fc024d73420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fbf81d0d5d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fbf81d32859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7fbf81c4f42f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7fbf81c52798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fbf81c9c989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fbf81c5162d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fbf81d0ac4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fbf81dbc06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5650023426fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56500233e094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56500234f519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56500233f5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56500234f7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x56500235ce83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x565002467b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5650022f9d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5650023467f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x565002344929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56500234f7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56500233f5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56500234f7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56500233f5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56500234f7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56500233f5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56500234f7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56500233f5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56500233e094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56500234f519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x565002340128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56500233e094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x56500235cccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56500235d44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x56500242010e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56500234777c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5650023426fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56500234f7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x56500235cdac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5650023426fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56500234f7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56500233f5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56500233e094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56500234f519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56500233f5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56500234f7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x56500233f312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56500233e094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56500234f519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x565002340128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56500233e094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x56500233dd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56500233dd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5650023eb07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x565002417fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x565002414353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x56500240c16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x56500240c05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x56500240b297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5650023def07]
=================================
[dgx13:76099:0:76099] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  76099) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f1073af0f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f1073af1114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f1073af12da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f111abe6420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f1073b6a5d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f1073b8f859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f1073aac42f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f1073aaf798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f1073af9989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f1073aae62d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f1073b67c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f1073c1906a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55f02d77b6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f02d777094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f02d788519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f02d7785c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f02d7887c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55f02d795e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55f02d8a0b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55f02d732d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55f02d77f7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55f02d77d929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f02d7887c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f02d7785c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f02d7887c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f02d7785c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f02d7887c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f02d7785c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f02d7887c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f02d7785c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f02d777094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f02d788519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55f02d779128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f02d777094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55f02d795ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55f02d79644c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55f02d85910e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55f02d78077c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55f02d77b6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f02d7887c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55f02d795dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55f02d77b6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f02d7887c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f02d7785c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f02d777094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f02d788519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f02d7785c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f02d7887c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55f02d778312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f02d777094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f02d788519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55f02d779128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f02d777094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55f02d776d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55f02d776d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55f02d82407b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55f02d850fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55f02d84d353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55f02d84516a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55f02d84505c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55f02d844297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55f02d817f07]
=================================
[dgx13:76107:0:76107] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  76107) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f0e9061af1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f0e9061b114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f0e9061b2da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f0f316be420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f0e906945d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f0e906b9859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f0e905d642f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f0e905d9798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f0e90623989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f0e905d862d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f0e90691c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f0e9074306a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55e72b7aa6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55e72b7a6094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55e72b7b7519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e72b7a75c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e72b7b77c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55e72b7c4e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55e72b8cfb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55e72b761d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55e72b7ae7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55e72b7ac929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e72b7b77c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e72b7a75c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e72b7b77c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e72b7a75c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e72b7b77c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e72b7a75c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e72b7b77c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e72b7a75c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55e72b7a6094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55e72b7b7519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55e72b7a8128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55e72b7a6094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55e72b7c4ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55e72b7c544c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55e72b88810e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55e72b7af77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55e72b7aa6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e72b7b77c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55e72b7c4dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55e72b7aa6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e72b7b77c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e72b7a75c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55e72b7a6094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55e72b7b7519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e72b7a75c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e72b7b77c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55e72b7a7312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55e72b7a6094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55e72b7b7519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55e72b7a8128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55e72b7a6094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55e72b7a5d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55e72b7a5d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55e72b85307b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55e72b87ffca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55e72b87c353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55e72b87416a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55e72b87405c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55e72b873297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55e72b846f07]
=================================
Task exception was never retrieved
future: <Task finished name='Task-872' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-10-07 06:38:17,987 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:39609
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7ff84c83d1c0, tag: 0x1db8f562a0a7128, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7ff84c83d1c0, tag: 0x1db8f562a0a7128, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-10-07 06:38:17,987 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:39609
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f077c1f5100, tag: 0xee65c4c58d21ed40, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f077c1f5100, tag: 0xee65c4c58d21ed40, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-10-07 06:38:17,988 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:39609
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7f3144a90100, tag: 0x23c57661967e3c1c, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f3144a90100, tag: 0x23c57661967e3c1c, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-10-07 06:38:18,035 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37345
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7ff84c83d300, tag: 0x530564b1ee05a0eb, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7ff84c83d300, tag: 0x530564b1ee05a0eb, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-10-07 06:38:18,035 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37345
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f3144a90200, tag: 0x75799cf6531cb674, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f3144a90200, tag: 0x75799cf6531cb674, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-10-07 06:38:18,056 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55225
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #010] ep: 0x7ff84c83d280, tag: 0xada793d44cd230e1, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #010] ep: 0x7ff84c83d280, tag: 0xada793d44cd230e1, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-10-07 06:38:18,074 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55225
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f077c1f5200, tag: 0xad702ec7f9ce4ade, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f077c1f5200, tag: 0xad702ec7f9ce4ade, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-10-07 06:38:18,094 - distributed.nanny - WARNING - Restarting worker
2023-10-07 06:38:18,106 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37345
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 376, in connect
    await comm.write(local_info)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 294, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message
[dgx13:76104:0:76104] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  76104) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f3144d64f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f3144d65114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f3144d652da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f31d7e07420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f3144dde5d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f3144e03859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f3144d2042f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f3144d23798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f3144d6d989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f3144d2262d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f3144ddbc4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f3144e8d06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5605126bb6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5605126b7094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5605126c8519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5605126b85c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5605126c87c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x5605126d5e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x5605127e0b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x560512672d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5605126bf7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5605126bd929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5605126c87c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5605126b85c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5605126c87c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5605126b85c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5605126c87c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5605126b85c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5605126c87c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5605126b85c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5605126b7094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5605126c8519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5605126b9128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5605126b7094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5605126d5ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5605126d644c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x56051279910e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5605126c077c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5605126bb6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5605126c87c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5605126d5dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5605126bb6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5605126c87c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5605126b85c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5605126b7094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5605126c8519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5605126b85c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5605126c87c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5605126b8312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5605126b7094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5605126c8519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5605126b9128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5605126b7094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5605126b6d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5605126b6d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56051276407b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x560512790fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x56051278d353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x56051278516a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x56051278505c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x560512784297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x560512757f07]
=================================
2023-10-07 06:38:18,168 - distributed.nanny - WARNING - Restarting worker
2023-10-07 06:38:18,236 - distributed.nanny - WARNING - Restarting worker
2023-10-07 06:38:18,443 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43683
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #011] ep: 0x7f077c1f5140, tag: 0xb0648a52b91382a9, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #011] ep: 0x7f077c1f5140, tag: 0xb0648a52b91382a9, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-10-07 06:38:18,466 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:49067 -> ucx://127.0.0.1:43683
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f35b8b581c0, tag: 0x155ec75bd594b47f, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-07 06:38:18,467 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43683
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f35b8b583c0, tag: 0x382a23f51e2c461f, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f35b8b583c0, tag: 0x382a23f51e2c461f, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
[dgx13:76094:0:76094] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  76094) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f35b8e1ef1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f35b8e1f114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f35b8e1f2da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f3659ecc420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f35b8e985d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f35b8ebd859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f35b8dda42f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f35b8ddd798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f35b8e27989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f35b8ddc62d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f35b8e95c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f35b8f4706a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5580a96c96fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5580a96c5094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5580a96d6519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5580a96c65c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5580a96d67c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x5580a96e3e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x5580a97eeb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5580a9680d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5580a96cd7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5580a96cb929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5580a96d67c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5580a96c65c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5580a96d67c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5580a96c65c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5580a96d67c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5580a96c65c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5580a96d67c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5580a96c65c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5580a96c5094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5580a96d6519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5580a96c7128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5580a96c5094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5580a96e3ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5580a96e444c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5580a97a710e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5580a96ce77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5580a96c96fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5580a96d67c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5580a96e3dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5580a96c96fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5580a96d67c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5580a96c65c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5580a96c5094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5580a96d6519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5580a96c65c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5580a96d67c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5580a96c6312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5580a96c5094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5580a96d6519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5580a96c7128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5580a96c5094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5580a96c4d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5580a96c4d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5580a977207b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5580a979efca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5580a979b353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5580a979316a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5580a979305c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5580a9792297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5580a9765f07]
=================================
2023-10-07 06:38:18,522 - distributed.nanny - WARNING - Restarting worker
2023-10-07 06:38:18,788 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55487 -> ucx://127.0.0.1:49067
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff84c83d3c0, tag: 0x89fcfa846fc10f3b, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-07 06:38:18,789 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:33977 -> ucx://127.0.0.1:49067
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f077c1f53c0, tag: 0xbdf529a7665091d9, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-07 06:38:18,789 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49067
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f077c1f51c0, tag: 0x7f0a3ab7dc6352d9, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f077c1f51c0, tag: 0x7f0a3ab7dc6352d9, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-10-07 06:38:18,790 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49067
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7ff84c83d200, tag: 0xd73b5fa4e89e2ab, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7ff84c83d200, tag: 0xd73b5fa4e89e2ab, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-10-07 06:38:18,884 - distributed.nanny - WARNING - Restarting worker
[dgx13:76090:0:76090] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  76090) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fbd455c8f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7fbd455c9114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7fbd455c92da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fbdea6a5420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fbd456425d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fbd45667859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7fbd4558442f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7fbd45587798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fbd455d1989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fbd4558662d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fbd4563fc4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fbd456f106a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564f55c966fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564f55c92094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564f55ca3519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564f55c935c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564f55ca37c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x564f55cb0e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x564f55dbbb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x564f55c4dd05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x564f55c9a7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x564f55c98929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564f55ca37c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564f55c935c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564f55ca37c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564f55c935c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564f55ca37c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564f55c935c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564f55ca37c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564f55c935c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564f55c92094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564f55ca3519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x564f55c94128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564f55c92094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x564f55cb0ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x564f55cb144c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x564f55d7410e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x564f55c9b77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564f55c966fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564f55ca37c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x564f55cb0dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564f55c966fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564f55ca37c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564f55c935c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564f55c92094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564f55ca3519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564f55c935c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564f55ca37c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x564f55c93312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564f55c92094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564f55ca3519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x564f55c94128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564f55c92094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x564f55c91d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x564f55c91d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x564f55d3f07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x564f55d6bfca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x564f55d68353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x564f55d6016a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x564f55d6005c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x564f55d5f297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x564f55d32f07]
=================================
Task exception was never retrieved
future: <Task finished name='Task-4495' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-10-07 06:38:19,417 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:33977 -> ucx://127.0.0.1:59839
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f077c1f51c0, tag: 0xbb7b85e730c512f9, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-07 06:38:19,418 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59839
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7ff84c83d200, tag: 0xc35b6a029285256d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7ff84c83d200, tag: 0xc35b6a029285256d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-10-07 06:38:19,418 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59839
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f077c1f5180, tag: 0x470e86f602ee9a75, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f077c1f5180, tag: 0x470e86f602ee9a75, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-10-07 06:38:19,512 - distributed.nanny - WARNING - Restarting worker
2023-10-07 06:38:20,354 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 2)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0            93894        2  26576369            2
1            93900        2  32808481            2
2            93901        2  22482788            2
3            93902        2  59128335            2
4            93905        2  17161317            2
...            ...      ...       ...          ...
12499995  99980224        2    371215            2
12499996  99980205        2  38881911            2
12499997  99980211        2  64848137            2
12499998  99980214        2  16164296            2
12499999  99980220        2  40720219            2

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100015080        2  42393821            2
1         100015081        2  50454509            2
2         100015084        2  94816258            2
3         100015089        2  88523329            2
4         100015103        2   2673707            2
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-10-07 06:38:20,406 - distributed.worker - WARNING - Compute Failed
Key:       ('sort_index-86563d3c54ed11bf71e0c240596313fc', 0)
Function:  subgraph_callable-45fff1ae-6843-42ca-969f-7e90af29
args:      ('set_index_post_scalar-ceb9308523ab39bbcf59f6dccd678d89',                 key  shuffle   payload  _partitions
0             93898        0  95497573            0
1             93904        0  60695124            0
2             93912        0   1739346            0
3             93917        0  21972059            0
4             20035        0  71695639            0
...             ...      ...       ...          ...
99999995  799995622        0   2895126            0
99999996  799995624        0  41827370            0
99999997  799995630        0  71614408            0
99999998  799995631        0  63748282            0
99999999  799995636        0  36807028            0

[100000000 rows x 4 columns], 'simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e')
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-10-07 06:38:20,745 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 4)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0            20995        4  40353206            4
1            21007        4  79677067            4
2            82465        4  59337720            4
3            82466        4  97301858            4
4            63202        4  91793200            4
...            ...      ...       ...          ...
12499995  99989320        4  42816940            4
12499996  99989322        4  60727366            4
12499997  99989330        4  44332867            4
12499998  99989411        4  53093817            4
12499999  99989422        4  11856039            4

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100015072        4  44213652            4
1         100015078        4  36575511            4
2         100015079        4  98356232            4
3         100015085        4  83984862            4
4         100015090        4  35891782            4
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-10-07 06:38:20,864 - distributed.core - ERROR - std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 377, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 378, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
2023-10-07 06:38:20,864 - distributed.worker - ERROR - std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 377, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 378, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
2023-10-07 06:38:20,867 - distributed.worker - ERROR - ('Unexpected response', {'op': 'get_data', 'keys': {('split-simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 6, 2)}, 'who': 'ucx://127.0.0.1:55487', 'reply': True})
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2861, in get_data_from_worker
    status = response["status"]
KeyError: 'status'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    raise ValueError("Unexpected response", response)
ValueError: ('Unexpected response', {'op': 'get_data', 'keys': {('split-simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 6, 2)}, 'who': 'ucx://127.0.0.1:55487', 'reply': True})
2023-10-07 06:38:20,871 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55487
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 364, in read
    await self.ep.recv(header)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #105] ep: 0x7f077c1f5240, tag: 0x6505e54a6c496d7c, nbytes: 16, type: <class 'numpy.ndarray'>>: Message truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #105] ep: 0x7f077c1f5240, tag: 0x6505e54a6c496d7c, nbytes: 16, type: <class 'numpy.ndarray'>>: Message truncated")
2023-10-07 06:38:21,191 - distributed.core - ERROR - std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 377, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 378, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
2023-10-07 06:38:21,191 - distributed.worker - ERROR - std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 377, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 378, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
2023-10-07 06:38:21,202 - distributed.core - ERROR - not enough values to unpack (expected 2, got 0)
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 381, in read
    cuda_recv_frames, recv_frames = zip(
ValueError: not enough values to unpack (expected 2, got 0)
2023-10-07 06:38:21,203 - distributed.worker - ERROR - not enough values to unpack (expected 2, got 0)
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 381, in read
    cuda_recv_frames, recv_frames = zip(
ValueError: not enough values to unpack (expected 2, got 0)
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
