[dgx13:85385:0:85385] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85385) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f71899f407d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f71899f4274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f71899f443a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f71c6514420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f7189a736b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f7189a9c839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f71899ae3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f71899b1838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f71899fd4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f71899b05dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f7189a708da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f7189b2906a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55962bb073f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55962bb01fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55962bb13469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55962bb034e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x55962bbb66d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f71b0afb1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55962bb0b6ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55962bac63ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55962bb0a723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55962bb08929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55962bb13712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55962bb034e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55962bb13712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55962bb034e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55962bb13712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55962bb034e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55962bb13712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55962bb034e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55962bb01fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55962bb13469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55962bb04042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55962bb01fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55962bb208cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55962bb2104c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55962bbe480e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55962bb0b6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55962bb073f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55962bb13712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55962bb209ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55962bb073f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55962bb13712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55962bb034e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55962bb01fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55962bb13469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55962bb034e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55962bb13712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55962bb03232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55962bb01fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55962bb13469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55962bb04042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55962bb01fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55962bb01c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55962bb01c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55962bbaf2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55962bbdc6ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55962bbd8a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55962bbd087a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55962bbd076c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55962bbcf9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55962bba3107]
=================================
[dgx13:85370:0:85370] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85370) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f81dc37007d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f81dc370274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f81dc37043a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f8207001420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f81dc3ef6b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f81dc418839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f81dc32a3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f81dc32d838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f81dc3794a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f81dc32c5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f81dc3ec8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f81dc4a506a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x555b44da03f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x555b44d9afb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x555b44dac469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555b44d9c4e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x555b44e4f6d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f81f15e81e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x555b44da46ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x555b44d5f3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x555b44da3723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x555b44da1929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555b44dac712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555b44d9c4e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555b44dac712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555b44d9c4e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555b44dac712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555b44d9c4e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555b44dac712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555b44d9c4e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x555b44d9afb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x555b44dac469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x555b44d9d042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x555b44d9afb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x555b44db98cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x555b44dba04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x555b44e7d80e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x555b44da46ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x555b44da03f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555b44dac712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x555b44db99ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x555b44da03f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555b44dac712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555b44d9c4e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x555b44d9afb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x555b44dac469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555b44d9c4e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555b44dac712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x555b44d9c232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x555b44d9afb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x555b44dac469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x555b44d9d042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x555b44d9afb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x555b44d9ac88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x555b44d9ac39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x555b44e482cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x555b44e756ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x555b44e71a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x555b44e6987a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x555b44e6976c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x555b44e689a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x555b44e3c107]
=================================
[dgx13:85360:0:85360] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85360) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f16ec46207d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f16ec462274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f16ec46243a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f1716f8b420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f16ec4e16b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f16ec50a839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f16ec41c3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f16ec41f838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f16ec46b4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f16ec41e5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f16ec4de8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f16ec59706a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d92b35c3f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55d92b356fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d92b368469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92b3584e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x55d92b40b6d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f17015731e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55d92b3606ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55d92b31b3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55d92b35f723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55d92b35d929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d92b368712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92b3584e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d92b368712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92b3584e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d92b368712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92b3584e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d92b368712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92b3584e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55d92b356fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d92b368469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55d92b359042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55d92b356fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55d92b3758cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55d92b37604c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55d92b43980e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55d92b3606ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d92b35c3f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d92b368712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55d92b3759ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d92b35c3f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d92b368712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92b3584e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55d92b356fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d92b368469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92b3584e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d92b368712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55d92b358232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55d92b356fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d92b368469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55d92b359042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55d92b356fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55d92b356c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55d92b356c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55d92b4042cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55d92b4316ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55d92b42da63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55d92b42587a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55d92b42576c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55d92b4249a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55d92b3f8107]
=================================
2024-01-24 07:56:40,226 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7ff7f0445140, tag: 0x2ad67e6583244b3d, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7ff7f0445140, tag: 0x2ad67e6583244b3d, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
Task exception was never retrieved
future: <Task finished name='Task-286' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:140> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 155, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 55, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2024-01-24 07:56:40,227 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7f147964b200, tag: 0x559596bf4fdd652b, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f147964b200, tag: 0x559596bf4fdd652b, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-01-24 07:56:40,228 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:51307 -> ucx://127.0.0.1:37923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff7f0445200, tag: 0x1be11a926230d9cf, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
Task exception was never retrieved
future: <Task finished name='Task-286' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:140> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 155, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 55, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2024-01-24 07:56:40,233 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-01-24 07:56:40,232 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-01-24 07:56:40,261 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55503 -> ucx://127.0.0.1:37975
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fcdf8031240, tag: 0xed60da20f973e84a, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:40,262 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37975
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fe88cd30180, tag: 0xef950192e913d82e, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fe88cd30180, tag: 0xef950192e913d82e, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-01-24 07:56:40,261 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59617 -> ucx://127.0.0.1:37975
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7f1372b46280, tag: 0x9f59658b22fe39b5, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1780, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7f1372b46280, tag: 0x9f59658b22fe39b5, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-01-24 07:56:40,269 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37975
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-01-24 07:56:40,270 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37975
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-01-24 07:56:40,366 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48789
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f147964b180, tag: 0xde4e37c0143d7838, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f147964b180, tag: 0xde4e37c0143d7838, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-01-24 07:56:40,366 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55503 -> ucx://127.0.0.1:48789
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7fcdf8031300, tag: 0x17ee9bdaf892bc2d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1780, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7fcdf8031300, tag: 0x17ee9bdaf892bc2d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-01-24 07:56:40,366 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48789
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f1372b46100, tag: 0xc4dd540eee8da7fb, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f1372b46100, tag: 0xc4dd540eee8da7fb, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-01-24 07:56:40,366 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55235 -> ucx://127.0.0.1:48789
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f147964b2c0, tag: 0x8275869fed9c8577, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:40,366 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48789
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fcdf80311c0, tag: 0xd7be74cc0476fdeb, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fcdf80311c0, tag: 0xd7be74cc0476fdeb, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-01-24 07:56:40,367 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59617 -> ucx://127.0.0.1:48789
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #012] ep: 0x7f1372b461c0, tag: 0x4affb36c245ab95d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1780, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #012] ep: 0x7f1372b461c0, tag: 0x4affb36c245ab95d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
[dgx13:85377:0:85377] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85377) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fcdf8e3b07d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7fcdf8e3b274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7fcdf8e3b43a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fce31acb420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fcdf8eba6b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fcdf8ee3839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fcdf8df53df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fcdf8df8838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fcdf8e444a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fcdf8df75dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fcdf8eb78da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fcdf8f7006a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c531f533f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c531f4dfb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c531f5f469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c531f4f4e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c531f5f712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x55c531f6ca83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x55c53207819c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55c531f123ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55c531f56723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55c531f54929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c531f5f712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c531f4f4e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c531f5f712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c531f4f4e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c531f5f712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c531f4f4e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c531f5f712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c531f4f4e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c531f4dfb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c531f5f469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55c531f50042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c531f4dfb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55c531f6c8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55c531f6d04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55c53203080e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55c531f576ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c531f533f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c531f5f712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55c531f6c9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c531f533f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c531f5f712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c531f4f4e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c531f4dfb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c531f5f469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c531f4f4e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55c531f5f712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55c531f4f232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c531f4dfb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c531f5f469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55c531f50042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55c531f4dfb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55c531f4dc88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55c531f4dc39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55c531ffb2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55c5320286ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55c532024a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55c53201c87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55c53201c76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55c53201b9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55c531fef107]
=================================
2024-01-24 07:56:41,010 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:51307 -> ucx://127.0.0.1:55503
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff7f04453c0, tag: 0x7ceb9847805cddfb, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:41,011 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55503
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7ff7f0445300, tag: 0xe4e75915d578d1cf, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7ff7f0445300, tag: 0xe4e75915d578d1cf, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-01-24 07:56:41,012 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59617 -> ucx://127.0.0.1:55503
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1372b46100, tag: 0xd14681117d29dc00, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:41,013 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55503
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f1372b461c0, tag: 0x2045ac98745954b, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f1372b461c0, tag: 0x2045ac98745954b, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-01-24 07:56:41,861 - distributed.nanny - WARNING - Restarting worker
2024-01-24 07:56:42,121 - distributed.nanny - WARNING - Restarting worker
2024-01-24 07:56:42,173 - distributed.nanny - WARNING - Restarting worker
2024-01-24 07:56:42,402 - distributed.nanny - WARNING - Restarting worker
[dgx13:85518:0:85518] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85518) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fa95d5bc07d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7fa95d5bc274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7fa95d5bc43a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fa99a0f6420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fa95d63b6b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fa95d664839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fa95d5763df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fa95d579838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fa95d5c54a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fa95d5785dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fa95d6388da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fa95d6f106a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x556e0f0233f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556e0f01dfb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556e0f02f469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e0f01f4e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556e0f02f712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x556e0f03ca83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x556e0f14819c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x556e0efe23ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x556e0f026723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x556e0f024929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556e0f02f712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e0f01f4e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556e0f02f712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e0f01f4e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556e0f02f712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e0f01f4e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556e0f02f712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e0f01f4e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556e0f01dfb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556e0f02f469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x556e0f020042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556e0f01dfb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x556e0f03c8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x556e0f03d04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x556e0f10080e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x556e0f0276ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x556e0f0233f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556e0f02f712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x556e0f03c9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x556e0f0233f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556e0f02f712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e0f01f4e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556e0f01dfb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556e0f02f469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e0f01f4e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556e0f02f712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x556e0f01f232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556e0f01dfb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556e0f02f469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x556e0f020042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556e0f01dfb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x556e0f01dc88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x556e0f01dc39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x556e0f0cb2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x556e0f0f86ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x556e0f0f4a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x556e0f0ec87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x556e0f0ec76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x556e0f0eb9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x556e0f0bf107]
=================================
2024-01-24 07:56:44,837 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:51307 -> ucx://127.0.0.1:55189
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff7f0445300, tag: 0xe194b50d80bf088d, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:44,839 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55189
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7ff7f04452c0, tag: 0xd02c30a9f54f8f3a, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7ff7f04452c0, tag: 0xd02c30a9f54f8f3a, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
[dgx13:85533:0:85533] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85533) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fbfef48607d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7fbfef486274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7fbfef48643a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fc037f9f420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fbfef5056b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fbfef52e839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fbfef4403df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fbfef443838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fbfef48f4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fbfef4425dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fbfef5028da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fbfef5bb06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x563640b8b3f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x563640b85fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563640b97469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563640b874e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563640b97712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x563640ba4a83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x563640cb019c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x563640b4a3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x563640b8e723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x563640b8c929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563640b97712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563640b874e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563640b97712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563640b874e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563640b97712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563640b874e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563640b97712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563640b874e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x563640b85fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563640b97469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x563640b88042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x563640b85fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x563640ba48cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x563640ba504c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x563640c6880e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x563640b8f6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x563640b8b3f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563640b97712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x563640ba49ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x563640b8b3f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563640b97712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563640b874e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x563640b85fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563640b97469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563640b874e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563640b97712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x563640b87232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x563640b85fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563640b97469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x563640b88042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x563640b85fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x563640b85c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x563640b85c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x563640c332cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x563640c606ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x563640c5ca63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x563640c5487a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x563640c5476c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x563640c539a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x563640c27107]
=================================
2024-01-24 07:56:45,215 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:51307 -> ucx://127.0.0.1:60013
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff7f0445440, tag: 0x6306270df06a6202, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:45,216 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:60013
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7ff7f0445400, tag: 0x9a811841102a4bdd, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7ff7f0445400, tag: 0x9a811841102a4bdd, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-01-24 07:56:45,220 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:60013
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 467, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1016, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 328, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 60, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXNotConnected: <stream_recv>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 469, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
[dgx13:85527:0:85527] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85527) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fc0d876c07d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7fc0d876c274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7fc0d876c43a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fc111285420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fc0d87eb6b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fc0d8814839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fc0d87263df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fc0d8729838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fc0d87754a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fc0d87285dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fc0d87e88da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fc0d88a106a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55e19f1de3f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55e19f1d8fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55e19f1ea469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e19f1da4e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55e19f1ea712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x55e19f1f7a83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x55e19f30319c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55e19f19d3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55e19f1e1723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55e19f1df929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55e19f1ea712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e19f1da4e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55e19f1ea712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e19f1da4e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55e19f1ea712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e19f1da4e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55e19f1ea712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e19f1da4e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55e19f1d8fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55e19f1ea469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55e19f1db042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55e19f1d8fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55e19f1f78cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55e19f1f804c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55e19f2bb80e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55e19f1e26ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55e19f1de3f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55e19f1ea712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55e19f1f79ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55e19f1de3f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55e19f1ea712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e19f1da4e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55e19f1d8fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55e19f1ea469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e19f1da4e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55e19f1ea712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55e19f1da232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55e19f1d8fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55e19f1ea469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55e19f1db042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55e19f1d8fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55e19f1d8c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55e19f1d8c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55e19f2862cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55e19f2b36ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55e19f2afa63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55e19f2a787a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55e19f2a776c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55e19f2a69a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55e19f27a107]
=================================
2024-01-24 07:56:45,391 - distributed.nanny - WARNING - Restarting worker
2024-01-24 07:56:45,499 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:45653 -> ucx://127.0.0.1:38471
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #012] ep: 0x7fe88cd30400, tag: 0x833ac8e0819eb173, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
[dgx13:85523:0:85523] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85523) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f6be8fc507d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f6be8fc5274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f6be8fc543a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f6c21ae9420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f6be90446b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f6be906d839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f6be8f7f3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f6be8f82838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f6be8fce4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f6be8f815dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f6be90418da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f6be90fa06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x56209a7583f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x56209a752fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56209a764469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56209a7544e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x56209a764712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x56209a771a83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x56209a87d19c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x56209a7173ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x56209a75b723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x56209a759929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x56209a764712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56209a7544e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x56209a764712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56209a7544e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x56209a764712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56209a7544e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x56209a764712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56209a7544e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x56209a752fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56209a764469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x56209a755042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x56209a752fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x56209a7718cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56209a77204c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x56209a83580e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56209a75c6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x56209a7583f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x56209a764712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x56209a7719ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x56209a7583f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x56209a764712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56209a7544e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x56209a752fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56209a764469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56209a7544e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x56209a764712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x56209a754232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x56209a752fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56209a764469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x56209a755042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x56209a752fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x56209a752c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56209a752c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56209a8002cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x56209a82d6ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x56209a829a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x56209a82187a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x56209a82176c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x56209a8209a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x56209a7f4107]
=================================
2024-01-24 07:56:45,799 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:45653 -> ucx://127.0.0.1:55065
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #017] ep: 0x7fe88cd30100, tag: 0x7be61fc1a809c623, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:45,799 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55065
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f1372b461c0, tag: 0xd83b74a6178a3d25, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f1372b461c0, tag: 0xd83b74a6178a3d25, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-01-24 07:56:45,824 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55065
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 467, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1016, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 328, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 60, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 469, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-01-24 07:56:46,190 - distributed.nanny - WARNING - Restarting worker
2024-01-24 07:56:46,721 - distributed.nanny - WARNING - Restarting worker
2024-01-24 07:56:46,880 - distributed.nanny - WARNING - Restarting worker
[dgx13:85596:0:85596] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85596) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7ff6c0ae207d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7ff6c0ae2274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7ff6c0ae243a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7ff6f960c420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7ff6c0b616b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7ff6c0b8a839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7ff6c0a9c3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7ff6c0a9f838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7ff6c0aeb4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7ff6c0a9e5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7ff6c0b5e8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7ff6c0c1706a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5555ae39b3f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5555ae395fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5555ae3a7469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5555ae3974e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5555ae3a7712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x5555ae3b4a83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x5555ae4c019c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x5555ae35a3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x5555ae39e723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x5555ae39c929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5555ae3a7712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5555ae3974e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5555ae3a7712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5555ae3974e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5555ae3a7712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5555ae3974e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5555ae3a7712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5555ae3974e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5555ae395fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5555ae3a7469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5555ae398042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5555ae395fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x5555ae3b48cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5555ae3b504c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x5555ae47880e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5555ae39f6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5555ae39b3f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5555ae3a7712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x5555ae3b49ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5555ae39b3f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5555ae3a7712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5555ae3974e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5555ae395fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5555ae3a7469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5555ae3974e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5555ae3a7712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5555ae397232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5555ae395fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5555ae3a7469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5555ae398042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5555ae395fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5555ae395c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5555ae395c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5555ae4432cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x5555ae4706ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x5555ae46ca63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5555ae46487a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5555ae46476c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5555ae4639a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5555ae437107]
=================================
[dgx13:85601:0:85601] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
[dgx13:85610:0:85610] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85601) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f098406e07d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f098406e274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f098406e43a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f09bc69d420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f0981b636b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f0981b8c839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f09840283df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f098402b838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f09840774a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f098402a5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f0981b608da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f0981c1906a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55f6f979c3f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55f6f9796fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f6f97a8469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6f97984e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55f6f97a8712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x55f6f97b5a83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x55f6f98c119c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55f6f975b3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55f6f979f723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55f6f979d929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55f6f97a8712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6f97984e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55f6f97a8712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6f97984e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55f6f97a8712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6f97984e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55f6f97a8712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6f97984e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55f6f9796fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f6f97a8469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55f6f9799042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55f6f9796fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55f6f97b58cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55f6f97b604c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55f6f987980e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55f6f97a06ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55f6f979c3f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55f6f97a8712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55f6f97b59ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55f6f979c3f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55f6f97a8712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6f97984e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55f6f9796fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f6f97a8469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6f97984e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55f6f97a8712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55f6f9798232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55f6f9796fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f6f97a8469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55f6f9799042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55f6f9796fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55f6f9796c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55f6f9796c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55f6f98442cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55f6f98716ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55f6f986da63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55f6f986587a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55f6f986576c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55f6f98649a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55f6f9838107]
=================================
==== backtrace (tid:  85610) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd5d55bc07d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7fd5d55bc274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7fd5d55bc43a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd6120e4420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fd5d563b6b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fd5d5664839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fd5d55763df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fd5d5579838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd5d55c54a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd5d55785dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd5d56388da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fd5d56f106a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55bda6c353f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55bda6c2ffb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55bda6c41469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bda6c314e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55bda6c41712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x55bda6c4ea83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x55bda6d5a19c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55bda6bf43ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55bda6c38723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55bda6c36929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55bda6c41712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bda6c314e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55bda6c41712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bda6c314e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55bda6c41712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bda6c314e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55bda6c41712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bda6c314e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55bda6c2ffb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55bda6c41469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55bda6c32042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55bda6c2ffb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55bda6c4e8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55bda6c4f04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55bda6d1280e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55bda6c396ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55bda6c353f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55bda6c41712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55bda6c4e9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55bda6c353f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55bda6c41712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bda6c314e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55bda6c2ffb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55bda6c41469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bda6c314e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55bda6c41712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55bda6c31232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55bda6c2ffb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55bda6c41469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55bda6c32042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55bda6c2ffb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55bda6c2fc88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55bda6c2fc39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55bda6cdd2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55bda6d0a6ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55bda6d06a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55bda6cfe87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55bda6cfe76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55bda6cfd9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55bda6cd1107]
=================================
[dgx13:85606:0:85606] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85606) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7ffa1069007d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7ffa10690274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7ffa1069043a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7ffa3b19e420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7ffa1070f6b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7ffa10738839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7ffa1064a3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7ffa1064d838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7ffa106994a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7ffa1064c5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7ffa1070c8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7ffa107c506a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55cee67a23f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55cee679cfb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55cee67ae469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cee679e4e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55cee67ae712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x55cee67bba83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x55cee68c719c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55cee67613ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55cee67a5723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55cee67a3929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55cee67ae712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cee679e4e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55cee67ae712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cee679e4e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55cee67ae712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cee679e4e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55cee67ae712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cee679e4e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55cee679cfb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55cee67ae469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55cee679f042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55cee679cfb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55cee67bb8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55cee67bc04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55cee687f80e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55cee67a66ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55cee67a23f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55cee67ae712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55cee67bb9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55cee67a23f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55cee67ae712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cee679e4e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55cee679cfb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55cee67ae469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cee679e4e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55cee67ae712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55cee679e232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55cee679cfb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55cee67ae469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55cee679f042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55cee679cfb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55cee679cc88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55cee679cc39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55cee684a2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55cee68776ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55cee6873a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55cee686b87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55cee686b76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55cee686a9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55cee683e107]
=================================
2024-01-24 07:56:50,297 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:45653 -> ucx://127.0.0.1:38377
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fe88cd30100, tag: 0x2483705855c7347c, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:50,300 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:45653 -> ucx://127.0.0.1:58083
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #014] ep: 0x7fe88cd302c0, tag: 0xf69df04e1e64a98e, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:50,329 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59617 -> ucx://127.0.0.1:50057
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1372b461c0, tag: 0xd1b1b4d588c7d7bb, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:50,335 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:51307 -> ucx://127.0.0.1:32779
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff7f0445300, tag: 0xf951e7fe1485c9e7, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:51,601 - distributed.nanny - WARNING - Restarting worker
2024-01-24 07:56:51,648 - distributed.nanny - WARNING - Restarting worker
2024-01-24 07:56:51,676 - distributed.nanny - WARNING - Restarting worker
2024-01-24 07:56:51,703 - distributed.nanny - WARNING - Restarting worker
[dgx13:85680:0:85680] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85680) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7eff744e207d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7eff744e2274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7eff744e243a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7effacff5420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7eff745616b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7eff7458a839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7eff7449c3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7eff7449f838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7eff744eb4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7eff7449e5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7eff7455e8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7eff7461706a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55a0574f63f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55a0574f0fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a057502469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a0574f24e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55a057502712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x55a05750fa83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x55a05761b19c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55a0574b53ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55a0574f9723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55a0574f7929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55a057502712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a0574f24e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55a057502712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a0574f24e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55a057502712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a0574f24e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55a057502712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a0574f24e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55a0574f0fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a057502469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55a0574f3042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55a0574f0fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55a05750f8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55a05751004c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55a0575d380e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55a0574fa6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55a0574f63f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55a057502712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55a05750f9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55a0574f63f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55a057502712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a0574f24e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55a0574f0fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a057502469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a0574f24e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55a057502712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55a0574f2232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55a0574f0fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a057502469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55a0574f3042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55a0574f0fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55a0574f0c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55a0574f0c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55a05759e2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55a0575cb6ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55a0575c7a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55a0575bf87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55a0575bf76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55a0575be9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55a057592107]
=================================
[dgx13:85668:0:85668] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85668) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f6a99cb007d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f6a99cb0274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f6a99cb043a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f6ad6804420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f6a99d2f6b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f6a99d58839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f6a99c6a3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f6a99c6d838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f6a99cb94a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f6a99c6c5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f6a99d2c8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f6a99de506a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x558f9ad4b3f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x558f9ad45fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558f9ad57469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558f9ad474e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x558f9ad57712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x558f9ad64a83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x558f9ae7019c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x558f9ad0a3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x558f9ad4e723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x558f9ad4c929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x558f9ad57712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558f9ad474e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x558f9ad57712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558f9ad474e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x558f9ad57712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558f9ad474e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x558f9ad57712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558f9ad474e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x558f9ad45fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558f9ad57469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x558f9ad48042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x558f9ad45fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x558f9ad648cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x558f9ad6504c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x558f9ae2880e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x558f9ad4f6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x558f9ad4b3f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x558f9ad57712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x558f9ad649ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x558f9ad4b3f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x558f9ad57712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558f9ad474e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x558f9ad45fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558f9ad57469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558f9ad474e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x558f9ad57712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x558f9ad47232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x558f9ad45fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558f9ad57469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x558f9ad48042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x558f9ad45fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x558f9ad45c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x558f9ad45c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x558f9adf32cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x558f9ae206ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x558f9ae1ca63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x558f9ae1487a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x558f9ae1476c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x558f9ae139a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x558f9ade7107]
=================================
[dgx13:85672:0:85672] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  85672) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fdfd8a4e07d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7fdfd8a4e274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7fdfd8a4e43a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fe011586420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fdfd8acd6b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fdfd8af6839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fdfd8a083df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fdfd8a0b838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fdfd8a574a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fdfd8a0a5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fdfd8aca8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fdfd8b8306a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x556d4f1bd3f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556d4f1b7fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556d4f1c9469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d4f1b94e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d4f1c9712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x556d4f1d6a83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x556d4f2e219c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x556d4f17c3ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x556d4f1c0723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x556d4f1be929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d4f1c9712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d4f1b94e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d4f1c9712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d4f1b94e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d4f1c9712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d4f1b94e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d4f1c9712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d4f1b94e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556d4f1b7fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556d4f1c9469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x556d4f1ba042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556d4f1b7fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x556d4f1d68cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x556d4f1d704c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x556d4f29a80e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x556d4f1c16ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x556d4f1bd3f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d4f1c9712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x556d4f1d69ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x556d4f1bd3f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d4f1c9712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d4f1b94e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556d4f1b7fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556d4f1c9469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556d4f1b94e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x556d4f1c9712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x556d4f1b9232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556d4f1b7fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556d4f1c9469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x556d4f1ba042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x556d4f1b7fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x556d4f1b7c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x556d4f1b7c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x556d4f2652cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x556d4f2926ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x556d4f28ea63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x556d4f28687a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x556d4f28676c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x556d4f2859a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x556d4f259107]
=================================
2024-01-24 07:56:56,760 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:51307 -> ucx://127.0.0.1:38205
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #016] ep: 0x7ff7f0445600, tag: 0x9501604b69d18ccc, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:56,781 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55235 -> ucx://127.0.0.1:52651
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f147964b100, tag: 0xe1c4e53afdafeaf0, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:56,796 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59617 -> ucx://127.0.0.1:45885
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1372b46100, tag: 0x6bdda3b0c14e57ea, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-01-24 07:56:59,584 - distributed.nanny - WARNING - Restarting worker
2024-01-24 07:56:59,670 - distributed.nanny - WARNING - Restarting worker
2024-01-24 07:56:59,672 - distributed.nanny - WARNING - Restarting worker
2024-01-24 07:57:10,033 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48789
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 467, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1016, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 328, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 60, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 490, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 492, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 368, in connect
    raise OSError(
OSError: Timed out trying to connect to ucx://127.0.0.1:48789 after 30 s
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 30 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
