============================= test session starts ==============================
platform linux -- Python 3.9.18, pytest-7.4.3, pluggy-1.3.0 -- /opt/conda/envs/gdf/bin/python3.9
cachedir: .pytest_cache
rootdir: /usr/src/ucx-py
configfile: pyproject.toml
plugins: asyncio-0.12.0
collecting ... collected 8 items

debug-tests/test_send_recv_many_workers.py::test_send_recv_cu[True-dataframe] [0, 1, 2, 3, 4, 5, 6, 7]
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
CREATING CUDA OBJECT IN SERVER...
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  3
ITER:  3
ITER:  4
ITER:  3
ITER:  4
ITER:  3
CONFIRM RECEIPT
ITER:  4
CONFIRM RECEIPT
ITER:  3
ITER:  3
ITER:  3
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  4
ITER:  0
ITER:  0
ITER:  4
ITER:  4
ITER:  4
CONFIRM RECEIPT
CONFIRM RECEIPT
ITER:  1
ITER:  0
ITER:  1
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
ITER:  2
ITER:  1
ITER:  2
ITER:  0
ITER:  0
ITER:  3
ITER:  2
ITER:  3
ITER:  0
ITER:  1
ITER:  0
ITER:  0
ITER:  1
ITER:  4
ITER:  3
ITER:  4
ITER:  1
ITER:  2
ITER:  1
ITER:  1
ITER:  2
CONFIRM RECEIPT
ITER:  4
CONFIRM RECEIPT
ITER:  2
ITER:  3
ITER:  2
ITER:  2
ITER:  3
CONFIRM RECEIPT
ITER:  0
ITER:  3
ITER:  0
ITER:  4
ITER:  3
ITER:  3
ITER:  0
ITER:  4
ITER:  1
ITER:  4
ITER:  1
CONFIRM RECEIPT
ITER:  4
ITER:  4
ITER:  1
CONFIRM RECEIPT
ITER:  2
CONFIRM RECEIPT
ITER:  2
CONFIRM RECEIPT
CONFIRM RECEIPT
ITER:  0
ITER:  2
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  3
ITER:  3
ITER:  1
ITER:  3
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  4
ITER:  4
ITER:  2
ITER:  4
ITER:  2
ITER:  2
ITER:  2
ITER:  2
CONFIRM RECEIPT
CONFIRM RECEIPT
ITER:  3
CONFIRM RECEIPT
ITER:  3
ITER:  3
ITER:  3
ITER:  3
ITER:  4
ITER:  4
ITER:  4
ITER:  4
ITER:  4
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
Closing listener
sys:1: RuntimeWarning: coroutine 'BlockingMode._arm_worker' was never awaited
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
Task was destroyed but it is pending!
task: <Task cancelling name='Task-138' coro=<BlockingMode._arm_worker() running at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/continuous_ucx_progress.py:88>>
PASSED
debug-tests/test_send_recv_many_workers.py::test_send_recv_cu[True-empty_dataframe] [0, 1, 2, 3, 4, 5, 6, 7]
ITER:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  1
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  2
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  1
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  2
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  1
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  2
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  1
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  2
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  1
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  2
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  1
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  2
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  1
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  2
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  1
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
ITER:  2
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
size of the message:  0
Shutting Down Client...
FINISHED
sys:1: RuntimeWarning: coroutine 'BlockingMode._arm_worker' was never awaited
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
Task was destroyed but it is pending!
task: <Task cancelling name='Task-33' coro=<BlockingMode._arm_worker() running at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/continuous_ucx_progress.py:88>>
CREATING CUDA OBJECT IN SERVER...
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
Closing listener
sys:1: RuntimeWarning: coroutine 'BlockingMode._arm_worker' was never awaited
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
Task was destroyed but it is pending!
task: <Task cancelling name='Task-24' coro=<BlockingMode._arm_worker() running at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/continuous_ucx_progress.py:88>>
PASSED
debug-tests/test_send_recv_many_workers.py::test_send_recv_cu[True-series] [0, 1, 2, 3, 4, 5, 6, 7]
ITER:  0
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  1
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  2
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  1
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  2
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  1
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  2
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  1
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  2
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  1
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  2
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  1
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  2
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  1
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  2
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  1
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
ITER:  2
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
size of the message:  90000
Shutting Down Client...
FINISHED
CREATING CUDA OBJECT IN SERVER...
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  1
ITER:  1
ITER:  0
ITER:  0
ITER:  1
ITER:  0
ITER:  0
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  0
ITER:  4
ITER:  1
CONFIRM RECEIPT
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
ITER:  0
CONFIRM RECEIPT
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  0
ITER:  3
ITER:  1
ITER:  4
CONFIRM RECEIPT
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
Closing listener
PASSED
debug-tests/test_send_recv_many_workers.py::test_send_recv_cu[True-cupy_obj] [0, 1, 2, 3, 4, 5, 6, 7]
ITER:  0
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  1
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  2
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  1
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  2
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  1
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  2
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  1
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  2
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  1
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  2
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  1
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  2
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  1
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  2
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  1
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
ITER:  2
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
size of the message:  100000000
Shutting Down Client...
FINISHED
CREATING CUDA OBJECT IN SERVER...
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  3
ITER:  3
ITER:  3
ITER:  3
ITER:  3
ITER:  3
ITER:  3
ITER:  3
ITER:  4
ITER:  4
ITER:  4
ITER:  4
ITER:  4
ITER:  4
ITER:  4
ITER:  4
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  0
ITER:  2
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  1
ITER:  3
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  2
ITER:  4
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  3
CONFIRM RECEIPT
ITER:  3
ITER:  3
ITER:  3
ITER:  3
ITER:  3
ITER:  3
ITER:  4
ITER:  4
ITER:  4
ITER:  4
ITER:  4
ITER:  4
ITER:  4
CONFIRM RECEIPT
CONFIRM RECEIPT
ITER:  0
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
ITER:  1
ITER:  2
ITER:  3
ITER:  4
CONFIRM RECEIPT
ITER:  0
ITER:  1
ITER:  0
ITER:  2
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  0
ITER:  1
ITER:  3
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  1
ITER:  2
ITER:  4
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  2
ITER:  3
CONFIRM RECEIPT
ITER:  3
ITER:  3
ITER:  3
ITER:  3
ITER:  3
ITER:  4
ITER:  4
ITER:  4
ITER:  4
ITER:  4
ITER:  4
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
CONFIRM RECEIPT
Closing listener
Task was destroyed but it is pending!
task: <Task cancelling name='Task-41' coro=<BlockingMode._arm_worker() running at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/continuous_ucx_progress.py:88>>
sys:1: RuntimeWarning: coroutine 'BlockingMode._arm_worker' was never awaited
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
PASSED
debug-tests/test_send_recv_many_workers.py::test_send_recv_cu[False-dataframe] [0, 1, 2, 3, 4, 5, 6, 7]
Process client_0:
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/opt/conda/envs/gdf/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/src/ucx-py/debug-tests/test_send_recv_many_workers.py", line 72, in client
    get_event_loop().run_until_complete(read())
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/base_events.py", line 647, in run_until_complete
    return future.result()
  File "/usr/src/ucx-py/debug-tests/test_send_recv_many_workers.py", line 61, in read
    frames, msg = await recv(ep)
  File "/usr/src/ucx-py/debug-tests/utils.py", line 110, in recv
    frame = cuda_array(size)
  File "/usr/src/ucx-py/debug-tests/utils.py", line 66, in cuda_array
    return rmm.DeviceBuffer(size=size)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Task exception was never retrieved
future: <Task finished name='Task-504' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError("<[Send #039] ep: 0x7fd05bfe9080, tag: 0x715d8a8cce097ad2, nbytes: 536870912, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer")>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 178, in _listener_handler_coroutine
    await func(ep)
  File "/usr/src/ucx-py/debug-tests/test_send_recv_many_workers.py", line 129, in write
    await send(ep, _frames)
  File "/usr/src/ucx-py/debug-tests/utils.py", line 85, in send
    await ep.send(frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #039] ep: 0x7fd05bfe9080, tag: 0x715d8a8cce097ad2, nbytes: 536870912, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer
Future exception was never retrieved
future: <Future finished exception=UCXCanceled('<[Recv shutdown] ep: 0x7f13bc2eb080, tag: 0xd02d98de388fb814>: ')>
ucp._libs.exceptions.UCXCanceled: <[Recv shutdown] ep: 0x7f13bc2eb080, tag: 0xd02d98de388fb814>: 
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
sys:1: RuntimeWarning: coroutine 'BlockingMode._arm_worker' was never awaited
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
Task was destroyed but it is pending!
task: <Task cancelling name='Task-128' coro=<BlockingMode._arm_worker() running at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/continuous_ucx_progress.py:88>>
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
ITER:  0
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  1
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
ITER:  2
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
size of the message:  67108864
Shutting Down Client...
FINISHED
