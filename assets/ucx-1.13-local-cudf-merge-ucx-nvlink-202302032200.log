2023-02-03 22:47:53,260 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:47:53,260 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:47:53,270 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:47:53,270 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:47:53,273 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:47:53,273 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:47:53,273 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:47:53,273 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:47:53,273 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:47:53,273 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:47:53,312 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:47:53,312 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:47:53,313 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:47:53,313 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:47:53,322 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:47:53,322 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:36365:0:36365] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  36365) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f97e08386b4]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2d88f) [0x7f97e083888f]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2dbb4) [0x7f97e0838bb4]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f9855f2b980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f97e0ab41b7]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f97e0add638]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f0ff) [0x7f97e05f00ff]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f674) [0x7f97e05f0674]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21a78) [0x7f97e05f2a78]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f97e08428a9]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f97e05f2b1b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f97e0ab0f5a]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f97e0d5cc79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x55efa1782b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55efa1773112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55efa176c27a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55efa177dc05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55efa176d81b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55efa177def3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x55efa178ba16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x55efa189b9b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x55efa1729817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x55efa1774f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55efa1772d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55efa177def3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55efa176d81b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55efa177def3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55efa176d81b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55efa177def3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55efa176d81b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55efa177def3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55efa176d81b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55efa176c27a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55efa177dc05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55efa1771fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55efa176c27a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x55efa178b935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55efa178c104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x55efa1852fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55efa17762bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55efa17711bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55efa177def3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x55efa178bc72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55efa17711bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55efa177def3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55efa176d81b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55efa176c27a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55efa177dc05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55efa176d81b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55efa177def3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55efa176d568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55efa176c27a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55efa177dc05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55efa176e3cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55efa176c27a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55efa176bf07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55efa176beb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55efa181c8bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x55efa184aadc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x55efa1846c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55efa183e7ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55efa183e6bd]
=================================
Task exception was never retrieved
future: <Task finished name='Task-835' coro=<_listener_handler_coroutine() done, defined at /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Endpoint timeout')>
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Endpoint timeout
2023-02-03 22:48:01,767 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:40785 -> ucx://127.0.0.1:51771
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fd0240d3100, tag: 0x8b3be62abebf7557, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-03 22:48:01,863 - distributed.nanny - WARNING - Restarting worker
[dgx13:36363:0:36363] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  36363) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7fc4a0b176b4]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2d88f) [0x7fc4a0b1788f]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2dbb4) [0x7fc4a0b17bb4]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7fc516217980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fc4a0d931b7]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fc4a0dbc638]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f0ff) [0x7fc4a08cf0ff]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f674) [0x7fc4a08cf674]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21a78) [0x7fc4a08d1a78]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fc4a0b218a9]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fc4a08d1b1b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fc4a0d8ff5a]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7fc4a103bc79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x563f2f65cb08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x563f2f64d112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x563f2f64627a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x563f2f657c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563f2f64781b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x563f2f657ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x563f2f665a16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x563f2f7759b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x563f2f603817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x563f2f64ef83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x563f2f64cd36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x563f2f657ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563f2f64781b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x563f2f657ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563f2f64781b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x563f2f657ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563f2f64781b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x563f2f657ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563f2f64781b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x563f2f64627a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x563f2f657c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x563f2f64bfa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x563f2f64627a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x563f2f665935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x563f2f666104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x563f2f72cfc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x563f2f6502bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x563f2f64b1bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x563f2f657ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x563f2f665c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x563f2f64b1bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x563f2f657ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563f2f64781b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x563f2f64627a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x563f2f657c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563f2f64781b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x563f2f657ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x563f2f647568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x563f2f64627a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x563f2f657c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x563f2f6483cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x563f2f64627a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x563f2f645f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x563f2f645eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x563f2f6f68bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x563f2f724adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x563f2f720c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x563f2f7187ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x563f2f7186bd]
=================================
2023-02-03 22:48:02,104 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:43385 -> ucx://127.0.0.1:36181
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f2818167100, tag: 0x94e2406107477928, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-03 22:48:02,185 - distributed.nanny - WARNING - Restarting worker
[dgx13:36359:0:36359] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  36359) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f43853ca6b4]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2d88f) [0x7f43853ca88f]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2dbb4) [0x7f43853cabb4]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f43faad5980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f43856461b7]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f438566f638]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f0ff) [0x7f43851820ff]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f674) [0x7f4385182674]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21a78) [0x7f4385184a78]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f43853d48a9]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f4385184b1b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f4385642f5a]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f43858eec79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x55d6b9f76b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55d6b9f67112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55d6b9f6027a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d6b9f71c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d6b9f6181b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x55d6b9f8670e]
19  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f43950c22fe]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55d6b9f6a2bc]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x55d6b9f1d817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x55d6b9f68f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55d6b9f66d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55d6b9f71ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d6b9f6181b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55d6b9f71ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d6b9f6181b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55d6b9f71ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d6b9f6181b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55d6b9f71ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d6b9f6181b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55d6b9f6027a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d6b9f71c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55d6b9f65fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55d6b9f6027a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x55d6b9f7f935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55d6b9f80104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x55d6ba046fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55d6b9f6a2bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55d6b9f651bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55d6b9f71ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x55d6b9f7fc72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55d6b9f651bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55d6b9f71ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d6b9f6181b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55d6b9f6027a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d6b9f71c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d6b9f6181b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55d6b9f71ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55d6b9f61568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55d6b9f6027a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d6b9f71c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55d6b9f623cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55d6b9f6027a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55d6b9f5ff07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55d6b9f5feb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55d6ba0108bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x55d6ba03eadc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x55d6ba03ac24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55d6ba0327ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55d6ba0326bd]
=================================
2023-02-03 22:48:02,608 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:42099
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f2818167200, tag: 0x1d66202ab3368570, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f2818167200, tag: 0x1d66202ab3368570, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Endpoint timeout")
2023-02-03 22:48:02,608 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:42099
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fd0240d31c0, tag: 0x7bcccc16b17c52c7, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fd0240d31c0, tag: 0x7bcccc16b17c52c7, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-02-03 22:48:02,609 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:43385 -> ucx://127.0.0.1:42099
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f2818167340, tag: 0x66b6eca210d936f6, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-03 22:48:02,608 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:46777 -> ucx://127.0.0.1:42099
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f32d4125340, tag: 0x20c0d10fd4ac241d, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-03 22:48:02,608 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:42099
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #009] ep: 0x7fcc240561c0, tag: 0xa7d80592d737fc21, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #009] ep: 0x7fcc240561c0, tag: 0xa7d80592d737fc21, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-02-03 22:48:02,612 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:42099
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f32d4125180, tag: 0xbecbdbfa0582cafe, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f32d4125180, tag: 0xbecbdbfa0582cafe, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
[dgx13:36353:0:36353] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  36353) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f28188546b4]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2d88f) [0x7f281885488f]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2dbb4) [0x7f2818854bb4]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f289bfe8980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f2818ad01b7]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f2818af9638]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f0ff) [0x7f281860c0ff]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f674) [0x7f281860c674]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21a78) [0x7f281860ea78]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f281885e8a9]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f281860eb1b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f2818accf5a]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f2818d78c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x564e71088b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x564e71079112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x564e7107227a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x564e71083c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7107381b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x564e71083ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x564e71091a16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x564e711a19b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x564e7102f817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x564e7107af83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x564e71078d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x564e71083ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7107381b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x564e71083ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7107381b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x564e71083ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7107381b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x564e71083ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7107381b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x564e7107227a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x564e71083c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x564e71077fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x564e7107227a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x564e71091935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x564e71092104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x564e71158fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x564e7107c2bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x564e710771bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x564e71083ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x564e71091c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x564e710771bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x564e71083ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7107381b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x564e7107227a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x564e71083c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7107381b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x564e71083ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x564e71073568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x564e7107227a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x564e71083c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x564e710743cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x564e7107227a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x564e71071f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x564e71071eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x564e711228bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x564e71150adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x564e7114cc24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x564e711447ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x564e711446bd]
=================================
2023-02-03 22:48:02,717 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:42099
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 329, in connect
    await asyncio.wait_for(comm.write(local_info), time_left())
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 289, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in _get_data
    comm = await rpc.connect(worker)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1439, in connect
    return await connect_attempt
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1375, in _connect
    comm = await connect(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 333, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:42099 after 30 s
[dgx13:36356:0:36356] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  36356) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7fe1a82146b4]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2d88f) [0x7fe1a821488f]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2dbb4) [0x7fe1a8214bb4]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7fe21d921980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fe1a84901b7]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fe1a84b9638]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f0ff) [0x7fe191de50ff]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f674) [0x7fe191de5674]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21a78) [0x7fe191de7a78]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fe1a821e8a9]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fe191de7b1b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fe1a848cf5a]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7fe1a8738c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x55cfab7bdb08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55cfab7ae112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55cfab7a727a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55cfab7b8c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cfab7a881b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x55cfab7cd70e]
19  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7fe1b7f0e2fe]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55cfab7b12bc]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x55cfab764817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x55cfab7aff83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55cfab7add36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55cfab7b8ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cfab7a881b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55cfab7b8ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cfab7a881b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55cfab7b8ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cfab7a881b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55cfab7b8ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cfab7a881b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55cfab7a727a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55cfab7b8c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55cfab7acfa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55cfab7a727a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x55cfab7c6935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55cfab7c7104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x55cfab88dfc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55cfab7b12bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55cfab7ac1bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55cfab7b8ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x55cfab7c6c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55cfab7ac1bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55cfab7b8ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cfab7a881b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55cfab7a727a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55cfab7b8c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cfab7a881b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55cfab7b8ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55cfab7a8568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55cfab7a727a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55cfab7b8c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55cfab7a93cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55cfab7a727a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55cfab7a6f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55cfab7a6eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55cfab8578bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x55cfab885adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x55cfab881c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55cfab8797ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55cfab8796bd]
=================================
2023-02-03 22:48:02,977 - distributed.nanny - WARNING - Restarting worker
2023-02-03 22:48:03,034 - distributed.nanny - WARNING - Restarting worker
2023-02-03 22:48:03,100 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54073
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fcc24056140, tag: 0x3e45e8d806898493, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fcc24056140, tag: 0x3e45e8d806898493, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Endpoint timeout")
2023-02-03 22:48:03,101 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50813 -> ucx://127.0.0.1:54073
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fcc24056300, tag: 0x655198df3900442b, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-03 22:48:03,101 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:40785 -> ucx://127.0.0.1:54073
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fd0240d32c0, tag: 0xb2537d19ef0817f0, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-03 22:48:03,101 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54073
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fd0240d3140, tag: 0x460d99668b1a5713, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fd0240d3140, tag: 0x460d99668b1a5713, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Endpoint timeout")
2023-02-03 22:48:03,124 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54073
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f32d4125100, tag: 0xd3db066c32e8d96a, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f32d4125100, tag: 0xd3db066c32e8d96a, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-02-03 22:48:03,174 - distributed.nanny - WARNING - Restarting worker
2023-02-03 22:48:03,740 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:48:03,740 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:48:04,053 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:48:04,053 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:48:04,831 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:48:04,831 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:48:04,859 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:48:04,859 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:48:05,016 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:48:05,016 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:36966:0:36966] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  36966) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7fba593406b4]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2d88f) [0x7fba5934088f]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2dbb4) [0x7fba59340bb4]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7fbadc8e7980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fba595bc1b7]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fba595e5638]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f0ff) [0x7fba590f80ff]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f674) [0x7fba590f8674]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21a78) [0x7fba590faa78]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fba5934a8a9]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fba590fab1b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fba595b8f5a]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7fba59864c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x55e7ef24db08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55e7ef23e112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55e7ef23727a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e7ef248c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e7ef23881b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55e7ef248ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x55e7ef256a16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x55e7ef3669b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x55e7ef1f4817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x55e7ef23ff83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55e7ef23dd36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55e7ef248ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e7ef23881b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55e7ef248ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e7ef23881b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55e7ef248ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e7ef23881b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55e7ef248ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e7ef23881b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55e7ef23727a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e7ef248c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55e7ef23cfa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55e7ef23727a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x55e7ef256935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55e7ef257104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x55e7ef31dfc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55e7ef2412bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55e7ef23c1bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55e7ef248ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x55e7ef256c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55e7ef23c1bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55e7ef248ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e7ef23881b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55e7ef23727a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e7ef248c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e7ef23881b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55e7ef248ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55e7ef238568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55e7ef23727a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e7ef248c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55e7ef2393cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55e7ef23727a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55e7ef236f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55e7ef236eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55e7ef2e78bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x55e7ef315adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x55e7ef311c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55e7ef3097ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55e7ef3096bd]
=================================
2023-02-03 22:48:05,441 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-a408cea21990d80a08ee08e688747144', 3)
Function:  <dask.layers.CallableLazyImport object at 0x7fcfe2
args:      (               key   payload
shuffle                     
3            94850  23915526
3            18546  75563922
3            94854  80367257
3            18557  19304696
3           153312   6506234
...            ...       ...
3        799982294  27931258
3        799982302  26192090
3        799982152  73926289
3        799982166  33628181
3        799982170  65357061

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/datasets/pentschev/miniconda3/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:193: Maximum pool size exceeded')"

2023-02-03 22:48:05,446 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:46777 -> ucx://127.0.0.1:43925
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f32d41252c0, tag: 0xb7cf8bdafa0738cb, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-03 22:48:05,542 - distributed.nanny - WARNING - Restarting worker
2023-02-03 22:48:05,552 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-a408cea21990d80a08ee08e688747144', 2)
Function:  <dask.layers.CallableLazyImport object at 0x7f2e1c
args:      (               key   payload
shuffle                     
2            94857  41434981
2            18540  88153678
2            94864   5532855
2            18544  47930234
2           153317  57372398
...            ...       ...
2        799982297  17662659
2        799986339  43958869
2        799982299   9769581
2        799982150  96470358
2        799982156  54209779

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/datasets/pentschev/miniconda3/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:193: Maximum pool size exceeded')"

2023-02-03 22:48:07,441 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:48:07,441 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:36345:0:36345] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  36345) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7fcc25b8a6b4]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2d88f) [0x7fcc25b8a88f]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2dbb4) [0x7fcc25b8abb4]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7fcc9b29d980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fcc25e061b7]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fcc25e2f638]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f0ff) [0x7fcc259420ff]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f674) [0x7fcc25942674]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21a78) [0x7fcc25944a78]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fcc25b948a9]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fcc25944b1b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fcc25e02f5a]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7fcc260aec79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x556829616b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x556829607112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55682960027a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x556829611c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55682960181b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556829611ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x55682961fa16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x55682972f9b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x5568295bd817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x556829608f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x556829606d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556829611ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55682960181b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556829611ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55682960181b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556829611ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55682960181b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556829611ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55682960181b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55682960027a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x556829611c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x556829605fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55682960027a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x55682961f935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x556829620104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x5568296e6fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55682960a2bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5568296051bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556829611ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x55682961fc72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5568296051bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556829611ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55682960181b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55682960027a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x556829611c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55682960181b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556829611ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x556829601568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55682960027a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x556829611c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5568296023cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55682960027a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5568295fff07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5568295ffeb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5568296b08bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x5568296deadc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x5568296dac24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5568296d27ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5568296d26bd]
=================================
[1675493289.044103] [dgx13:36341:0]    cuda_copy_md.c:172  UCX  ERROR   cuMemAlloc_v2((CUdeviceptr*)address_p, *length_p)() failed: out of memory
[1675493289.044117] [dgx13:36341:0]         uct_mem.c:155  UCX  ERROR   failed to allocate 536870912 bytes using md cuda_cpy for ucp_rndv_frags: Input/output error
[1675493289.044122] [dgx13:36341:0]           mpool.c:226  UCX  ERROR Failed to allocate memory pool (name=ucp_rndv_frags) chunk: Out of memory
[dgx13:36341:0:36341]        rndv.c:1332 Fatal: failed to allocate fragment memory buffer
==== backtrace (tid:  36341) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f32d4d0d6b4]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0xb8) [0x7f32d4d0a668]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2a749) [0x7f32d4d0a749]
 3  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(+0x6d584) [0x7f32d4fad584]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_receive+0x45c) [0x7f32d4fae0cc]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nbx+0xc0a) [0x7f32d4fc6afa]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nb+0x56) [0x7f32d4fc5ed6]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x501e5) [0x7f32d525b1e5]
 8  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x149dc7) [0x5576fd621dc7]
 9  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0x158) [0x5576fd6201a8]
10  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5576fd606d36]
11  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5576fd60027a]
12  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5576fd611c05]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5576fd6023cb]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5576fd60027a]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5576fd611c05]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5576fd6023cb]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x5576fd62670e]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5576fd607923]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x5576fd62670e]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5576fd607923]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x5576fd62670e]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5576fd607923]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x5576fd62670e]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5576fd607923]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x5576fd62670e]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5576fd607923]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x5576fd62670e]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5576fd607923]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x5576fd62670e]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5576fd607923]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x5576fd62670e]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5576fd607923]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x5576fd62670e]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5576fd607923]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x5576fd62670e]
36  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f32f2a0c2fe]
37  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x8b4e) [0x7f32f2a0cb4e]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5576fd60a2bc]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x5576fd5bd817]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x5576fd608f83]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5576fd606d36]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5576fd611ef3]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5576fd60181b]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5576fd611ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5576fd60181b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5576fd611ef3]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5576fd60181b]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5576fd611ef3]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5576fd60181b]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5576fd60027a]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5576fd611c05]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5576fd605fa7]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5576fd60027a]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x5576fd61f935]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5576fd620104]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x5576fd6e6fc8]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5576fd60a2bc]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5576fd6051bb]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5576fd611ef3]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x5576fd61fc72]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5576fd6051bb]
=================================
[dgx13:36996:0:36996] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  36996) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f7fe050c6b4]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2d88f) [0x7f7fe050c88f]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2dbb4) [0x7f7fe050cbb4]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f8063aec980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f7fe07881b7]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f7fe07b1638]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f0ff) [0x7f7fe02c40ff]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x1f674) [0x7f7fe02c4674]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21a78) [0x7f7fe02c6a78]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f7fe05168a9]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f7fe02c6b1b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f7fe0784f5a]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f7fe0a30c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x559e45515b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x559e45506112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559e454ff27a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559e45510c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559e4550081b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559e45510ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x559e4551ea16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x559e4562e9b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x559e454bc817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x559e45507f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x559e45505d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559e45510ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559e4550081b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559e45510ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559e4550081b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559e45510ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559e4550081b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559e45510ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559e4550081b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559e454ff27a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559e45510c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x559e45504fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559e454ff27a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x559e4551e935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x559e4551f104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x559e455e5fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x559e455092bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x559e455041bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559e45510ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x559e4551ec72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x559e455041bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559e45510ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559e4550081b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559e454ff27a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559e45510c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559e4550081b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559e45510ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x559e45500568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559e454ff27a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559e45510c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x559e455013cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559e454ff27a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x559e454fef07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559e454feeb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x559e455af8bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x559e455ddadc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x559e455d9c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x559e455d17ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x559e455d16bd]
=================================
2023-02-03 22:48:09,224 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50813
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7faeb00aa200, tag: 0xd17fee5b1b1d0836, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7faeb00aa200, tag: 0xd17fee5b1b1d0836, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-02-03 22:48:09,224 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50813
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f62e8d0a1c0, tag: 0x516ed25af480e41c, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f62e8d0a1c0, tag: 0x516ed25af480e41c, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-02-03 22:48:09,228 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55981 -> ucx://127.0.0.1:50813
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7faeb00aa300, tag: 0x35e7f1997e8f32e5, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-03 22:48:09,242 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46777
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7faeb00aa100, tag: 0x3d0668c2cc9ae5ea, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7faeb00aa100, tag: 0x3d0668c2cc9ae5ea, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-02-03 22:48:09,236 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46777
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f62e8d0a140, tag: 0x26613dfa235ac07d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f62e8d0a140, tag: 0x26613dfa235ac07d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-02-03 22:48:09,254 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55981 -> ucx://127.0.0.1:51145
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7faeb00aa340, tag: 0x10d97c0097945c9, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-03 22:48:09,254 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:51145
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7faeb00aa1c0, tag: 0x63062b367ce6964d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7faeb00aa1c0, tag: 0x63062b367ce6964d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-02-03 22:48:09,255 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:51145
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f62e8d0a200, tag: 0x5bcd18b9b80ec501, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f62e8d0a200, tag: 0x5bcd18b9b80ec501, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-02-03 22:48:09,313 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50813
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 708, in recv
    self._ep.raise_on_error()
  File "ucp/_libs/ucx_endpoint.pyx", line 355, in ucp._libs.ucx_api.UCXEndpoint.raise_on_error
ucp._libs.exceptions.UCXError: Endpoint 0x7fd0240d3180 error: Endpoint timeout

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError('Endpoint 0x7fd0240d3180 error: Endpoint timeout')
2023-02-03 22:48:09,315 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:40785 -> ucx://127.0.0.1:50813
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 629, in send
    self._ep.raise_on_error()
  File "ucp/_libs/ucx_endpoint.pyx", line 353, in ucp._libs.ucx_api.UCXEndpoint.raise_on_error
ucp._libs.exceptions.UCXConnectionReset: Endpoint 0x7fd0240d3340 error: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-03 22:48:09,325 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46777
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2867, in _get_data
    await comm.write("OK")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 289, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message
2023-02-03 22:48:09,327 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:40785 -> ucx://127.0.0.1:51145
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 289, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message
2023-02-03 22:48:09,445 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:51145
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 329, in connect
    await asyncio.wait_for(comm.write(local_info), time_left())
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 289, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in _get_data
    comm = await rpc.connect(worker)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1439, in connect
    return await connect_attempt
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1375, in _connect
    comm = await connect(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 333, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:51145 after 30 s
2023-02-03 22:48:09,479 - distributed.nanny - WARNING - Restarting worker
2023-02-03 22:48:09,482 - distributed.nanny - WARNING - Restarting worker
2023-02-03 22:48:09,558 - distributed.nanny - WARNING - Restarting worker
2023-02-03 22:48:11,394 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:48:11,394 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:48:11,394 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:48:11,394 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-03 22:48:11,457 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-03 22:48:11,457 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
