[dgx13:86078:0:86078] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  86078) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f02e803f07d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f02e803f274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f02e803f43a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f037ae1c420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f02d3d636b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f02d3d8c839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f02d3cfd3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f02d3d00838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f02e80484a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f02d3cff5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f02d3d608da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f02d3e1906a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56017d1b86fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56017d1b4094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56017d1c5519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56017d1b55c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x56017d268162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f02fafb01e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56017d1bd77c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x56017d16fd05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x56017d1bc7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x56017d1ba929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56017d1c57c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56017d1b55c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56017d1c57c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56017d1b55c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56017d1c57c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56017d1b55c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56017d1c57c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56017d1b55c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56017d1b4094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56017d1c5519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56017d1b6128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56017d1b4094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x56017d1d2ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56017d1d344c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x56017d29610e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56017d1bd77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56017d1b86fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56017d1c57c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x56017d1d2dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56017d1b86fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56017d1c57c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56017d1b55c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56017d1b4094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56017d1c5519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56017d1b55c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56017d1c57c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x56017d1b5312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56017d1b4094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56017d1c5519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56017d1b6128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56017d1b4094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x56017d1b3d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56017d1b3d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56017d26107b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x56017d28dfca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x56017d28a353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x56017d28216a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x56017d28205c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x56017d281297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x56017d254f07]
=================================
[dgx13:86098:0:86098] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  86098) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f09649e507d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f09649e5274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f09649e543a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f0a05abe420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f0964a646b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f0964a8d839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f096499f3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f09649a2838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f09649ee4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f09649a15dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f0964a618da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f0964b1a06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5629c24a46fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5629c24a0094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5629c24b1519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5629c24a15c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5629c2554162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f0985c4e1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5629c24a977c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5629c245bd05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5629c24a87f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5629c24a6929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5629c24b17c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5629c24a15c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5629c24b17c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5629c24a15c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5629c24b17c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5629c24a15c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5629c24b17c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5629c24a15c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5629c24a0094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5629c24b1519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5629c24a2128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5629c24a0094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5629c24beccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5629c24bf44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5629c258210e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5629c24a977c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5629c24a46fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5629c24b17c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5629c24bedac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5629c24a46fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5629c24b17c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5629c24a15c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5629c24a0094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5629c24b1519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5629c24a15c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5629c24b17c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5629c24a1312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5629c24a0094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5629c24b1519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5629c24a2128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5629c24a0094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5629c249fd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5629c249fd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5629c254d07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5629c2579fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5629c2576353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5629c256e16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5629c256e05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5629c256d297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5629c2540f07]
=================================
[dgx13:86074:0:86074] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  86074) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f77806e107d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f77806e1274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f77806e143a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f78217b7420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f77807606b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f7780789839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f778069b3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f778069e838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f77806ea4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f778069d5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f778075d8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f778081606a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55bdb68706fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55bdb686c094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55bdb687d519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bdb686d5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bdb687d7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55bdb688ae83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55bdb6995b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55bdb6827d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55bdb68747f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55bdb6872929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bdb687d7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bdb686d5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bdb687d7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bdb686d5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bdb687d7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bdb686d5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bdb687d7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bdb686d5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55bdb686c094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55bdb687d519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55bdb686e128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55bdb686c094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55bdb688accb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55bdb688b44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55bdb694e10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55bdb687577c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55bdb68706fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bdb687d7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55bdb688adac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55bdb68706fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bdb687d7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bdb686d5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55bdb686c094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55bdb687d519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bdb686d5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bdb687d7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55bdb686d312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55bdb686c094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55bdb687d519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55bdb686e128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55bdb686c094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55bdb686bd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55bdb686bd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55bdb691907b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55bdb6945fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55bdb6942353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55bdb693a16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55bdb693a05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55bdb6939297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55bdb690cf07]
=================================
2023-10-06 06:09:21,819 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50961 -> ucx://127.0.0.1:36373
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3744e0b140, tag: 0x2e2b4ec9644774e8, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-06 06:09:21,819 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36373
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7f12f16b21c0, tag: 0x159a2ba09cf42a7f, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f12f16b21c0, tag: 0x159a2ba09cf42a7f, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
Task exception was never retrieved
future: <Task finished name='Task-475' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
Task exception was never retrieved
future: <Task finished name='Task-279' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-10-06 06:09:21,829 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36373
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-10-06 06:09:21,830 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36373
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-10-06 06:09:21,866 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53159
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f7e954351c0, tag: 0xff015eb032130b06, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f7e954351c0, tag: 0xff015eb032130b06, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-10-06 06:09:21,877 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:39589
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f12f16b2140, tag: 0xc7a1860b412de225, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f12f16b2140, tag: 0xc7a1860b412de225, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-10-06 06:09:21,892 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:39589
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
Task exception was never retrieved
future: <Task finished name='Task-284' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-10-06 06:09:21,956 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53159
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f6248154280, tag: 0x1388f60b255df1fc, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f6248154280, tag: 0x1388f60b255df1fc, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-10-06 06:09:21,966 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:39589
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    await comm.write("OK")
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 294, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message
2023-10-06 06:09:21,997 - distributed.nanny - WARNING - Restarting worker
2023-10-06 06:09:22,031 - distributed.nanny - WARNING - Restarting worker
2023-10-06 06:09:22,033 - distributed.nanny - WARNING - Restarting worker
[dgx13:86228:0:86228] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  86228) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f75487ed07d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f75487ed274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f75487ed43a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f75e9750420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f754886c6b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f7548895839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f75487a73df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f75487aa838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f75487f64a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f75487a95dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f75488698da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f754892206a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55af6e0f06fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55af6e0ec094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55af6e0fd519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55af6e0ed5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55af6e1a0162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f75dc3161e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55af6e0f577c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55af6e0a7d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55af6e0f47f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55af6e0f2929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55af6e0fd7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55af6e0ed5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55af6e0fd7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55af6e0ed5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55af6e0fd7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55af6e0ed5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55af6e0fd7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55af6e0ed5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55af6e0ec094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55af6e0fd519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55af6e0ee128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55af6e0ec094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55af6e10accb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55af6e10b44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55af6e1ce10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55af6e0f577c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55af6e0f06fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55af6e0fd7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55af6e10adac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55af6e0f06fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55af6e0fd7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55af6e0ed5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55af6e0ec094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55af6e0fd519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55af6e0ed5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55af6e0fd7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55af6e0ed312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55af6e0ec094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55af6e0fd519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55af6e0ee128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55af6e0ec094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55af6e0ebd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55af6e0ebd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55af6e19907b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55af6e1c5fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55af6e1c2353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55af6e1ba16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55af6e1ba05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55af6e1b9297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55af6e18cf07]
=================================
[dgx13:86234:0:86234] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  86234) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7ff32c09607d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7ff32c096274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7ff32c09643a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7ff3ccf1e420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7ff325f7c6b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7ff325fa5839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7ff32c0503df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7ff32c053838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7ff32c09f4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7ff32c0525dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7ff325f798da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7ff32c0fd06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56278eccd6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56278ecc9094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56278ecda519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56278ecca5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56278ecda7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x56278ece7e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x56278edf2b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x56278ec84d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x56278ecd17f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x56278eccf929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56278ecda7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56278ecca5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56278ecda7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56278ecca5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56278ecda7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56278ecca5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56278ecda7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56278ecca5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56278ecc9094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56278ecda519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56278eccb128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56278ecc9094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x56278ece7ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56278ece844c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x56278edab10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56278ecd277c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56278eccd6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56278ecda7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x56278ece7dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56278eccd6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56278ecda7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56278ecca5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56278ecc9094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56278ecda519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56278ecca5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56278ecda7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x56278ecca312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56278ecc9094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56278ecda519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56278eccb128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56278ecc9094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x56278ecc8d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56278ecc8d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56278ed7607b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x56278eda2fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x56278ed9f353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x56278ed9716a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x56278ed9705c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x56278ed96297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x56278ed69f07]
=================================
2023-10-06 06:09:25,059 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:37259 -> ucx://127.0.0.1:58677
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f12f16b21c0, tag: 0x8949a444d6546a3f, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-06 06:09:25,060 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:47009 -> ucx://127.0.0.1:48051
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f6248154380, tag: 0xb2f39b4c32b63c47, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-06 06:09:25,060 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58677
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f12f16b2240, tag: 0x3a883fdeaa4b1ef9, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f12f16b2240, tag: 0x3a883fdeaa4b1ef9, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-10-06 06:09:25,065 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58677
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-10-06 06:09:25,111 - distributed.nanny - WARNING - Restarting worker
[dgx13:86231:0:86231] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  86231) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f9ab506207d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f9ab5062274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f9ab506243a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f9b55fbb420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f9ab50e16b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f9ab510a839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f9ab501c3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f9ab501f838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f9ab506b4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f9ab501e5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f9ab50de8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f9ab519706a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55e76e14c6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55e76e148094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55e76e159519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e76e1495c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e76e1597c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55e76e166e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55e76e271b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55e76e103d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55e76e1507f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55e76e14e929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e76e1597c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e76e1495c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e76e1597c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e76e1495c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e76e1597c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e76e1495c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e76e1597c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e76e1495c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55e76e148094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55e76e159519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55e76e14a128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55e76e148094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55e76e166ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55e76e16744c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55e76e22a10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55e76e15177c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55e76e14c6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e76e1597c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55e76e166dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55e76e14c6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e76e1597c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e76e1495c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55e76e148094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55e76e159519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55e76e1495c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55e76e1597c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55e76e149312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55e76e148094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55e76e159519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55e76e14a128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55e76e148094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55e76e147d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55e76e147d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55e76e1f507b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55e76e221fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55e76e21e353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55e76e21616a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55e76e21605c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55e76e215297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55e76e1e8f07]
=================================
2023-10-06 06:09:25,141 - distributed.nanny - WARNING - Restarting worker
2023-10-06 06:09:25,339 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55343 -> ucx://127.0.0.1:47629
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f7e954351c0, tag: 0x40473756af731e4c, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-06 06:09:25,385 - distributed.nanny - WARNING - Restarting worker
[dgx13:86285:0:86285] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  86285) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f69b81f807d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f69b81f8274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f69b81f843a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f6a4b156420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f69b82776b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f69b82a0839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f69b81b23df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f69b81b5838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f69b82014a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f69b81b45dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f69b82748da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f69b832d06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564db698f6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564db698b094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564db699c519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564db698c5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x564db6a3f162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f69cb2e81e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x564db699477c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x564db6946d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x564db69937f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x564db6991929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564db699c7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564db698c5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564db699c7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564db698c5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564db699c7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564db698c5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564db699c7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564db698c5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564db698b094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564db699c519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x564db698d128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564db698b094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x564db69a9ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x564db69aa44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x564db6a6d10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x564db699477c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564db698f6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564db699c7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x564db69a9dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564db698f6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564db699c7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564db698c5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564db698b094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564db699c519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564db698c5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564db699c7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x564db698c312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564db698b094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564db699c519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x564db698d128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564db698b094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x564db698ad68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x564db698ad19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x564db6a3807b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x564db6a64fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x564db6a61353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x564db6a5916a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x564db6a5905c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x564db6a58297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x564db6a2bf07]
=================================
2023-10-06 06:09:28,117 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:47009 -> ucx://127.0.0.1:38047
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f6248154480, tag: 0x4cf7f999e5478419, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
[dgx13:86293:0:86293] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  86293) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fb8074e307d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7fb8074e3274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7fb8074e343a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fb8ac494420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fb8075626b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fb80758b839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fb80c0273df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fb80c02a838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fb8074ec4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fb80c0295dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fb80755f8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fb80761806a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5617a8ef96fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5617a8ef5094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5617a8f06519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5617a8ef65c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5617a8f067c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x5617a8f13e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x5617a901eb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5617a8eb0d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5617a8efd7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5617a8efb929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5617a8f067c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5617a8ef65c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5617a8f067c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5617a8ef65c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5617a8f067c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5617a8ef65c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5617a8f067c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5617a8ef65c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5617a8ef5094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5617a8f06519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5617a8ef7128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5617a8ef5094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5617a8f13ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5617a8f1444c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5617a8fd710e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5617a8efe77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5617a8ef96fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5617a8f067c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5617a8f13dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5617a8ef96fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5617a8f067c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5617a8ef65c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5617a8ef5094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5617a8f06519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5617a8ef65c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5617a8f067c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5617a8ef6312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5617a8ef5094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5617a8f06519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5617a8ef7128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5617a8ef5094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5617a8ef4d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5617a8ef4d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5617a8fa207b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5617a8fcefca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5617a8fcb353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5617a8fc316a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5617a8fc305c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5617a8fc2297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5617a8f95f07]
=================================
[dgx13:86090:0:86090] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  86090) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f13081b707d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f13081b7274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f13081b743a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f139b282420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f13082366b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f130825f839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f13081713df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f1308174838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f13081c04a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f13081735dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f13082338da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f13082ec06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564813e186fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564813e14094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564813e25519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564813e155c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564813e257c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x564813e32e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x564813f3db2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x564813dcfd05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x564813e1c7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x564813e1a929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564813e257c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564813e155c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564813e257c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564813e155c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564813e257c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564813e155c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564813e257c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564813e155c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564813e14094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564813e25519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x564813e16128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564813e14094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x564813e32ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x564813e3344c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x564813ef610e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x564813e1d77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564813e186fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564813e257c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x564813e32dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564813e186fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564813e257c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564813e155c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564813e14094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564813e25519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564813e155c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564813e257c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x564813e15312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564813e14094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564813e25519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x564813e16128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564813e14094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x564813e13d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x564813e13d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x564813ec107b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x564813eedfca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x564813eea353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x564813ee216a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x564813ee205c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x564813ee1297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x564813eb4f07]
=================================
2023-10-06 06:09:28,163 - distributed.nanny - WARNING - Restarting worker
2023-10-06 06:09:28,348 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37259
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f7e95435200, tag: 0x47f31a607373492d, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f7e95435200, tag: 0x47f31a607373492d, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-10-06 06:09:28,349 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:40839 -> ucx://127.0.0.1:37259
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7f312456b200, tag: 0xa20ae0f6738408e4, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1783, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7f312456b200, tag: 0xa20ae0f6738408e4, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-10-06 06:09:28,349 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37259
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fa4985c4180, tag: 0x71ed8306fee4a82d, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fa4985c4180, tag: 0x71ed8306fee4a82d, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-10-06 06:09:28,351 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42095 -> ucx://127.0.0.1:35415
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fa4985c4140, tag: 0xe271c3ae64391196, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-06 06:09:28,352 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42095 -> ucx://127.0.0.1:37259
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fa4985c41c0, tag: 0x1dd8cf6f3225d954, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-06 06:09:28,352 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35415
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fa4985c4100, tag: 0x3dc0764ec53588a, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fa4985c4100, tag: 0x3dc0764ec53588a, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-10-06 06:09:28,495 - distributed.nanny - WARNING - Restarting worker
2023-10-06 06:09:28,545 - distributed.nanny - WARNING - Restarting worker
2023-10-06 06:09:51,482 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36373
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 490, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 492, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 368, in connect
    raise OSError(
OSError: Timed out trying to connect to ucx://127.0.0.1:36373 after 30 s
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
