[dgx13:76891:0:76891] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  76891) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7faf14ee6c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7faf14ee6e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7faf14ee6fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7faf3feff420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7faf14f69997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7faf14f9388d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7faf14e9d93f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7faf14ea0b18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7faf14ef0509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7faf14e9fc2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7faf14f6686a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7faf1502606a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55ba5a2563f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ba5a250fb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ba5a262469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ba5a2524e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x55ba5a3056d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7faf35d7d1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55ba5a25a6ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55ba5a2153ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55ba5a259723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55ba5a257929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ba5a262712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ba5a2524e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ba5a262712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ba5a2524e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ba5a262712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ba5a2524e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ba5a262712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ba5a2524e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ba5a250fb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ba5a262469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55ba5a253042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ba5a250fb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55ba5a26f8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55ba5a27004c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55ba5a33380e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55ba5a25a6ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55ba5a2563f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ba5a262712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55ba5a26f9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55ba5a2563f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ba5a262712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ba5a2524e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ba5a250fb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ba5a262469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ba5a2524e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ba5a262712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55ba5a252232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ba5a250fb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ba5a262469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55ba5a253042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ba5a250fb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55ba5a250c88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55ba5a250c39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55ba5a2fe2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55ba5a32b6ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55ba5a327a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55ba5a31f87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55ba5a31f76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55ba5a31e9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55ba5a2f2107]
=================================
[dgx13:76895:0:76895] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  76895) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f23072a4c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f23072a4e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f23072a4fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f23442ec420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f2307327997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f230735188d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f230725b93f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f230725eb18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f23072ae509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f230725dc2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f230732486a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f23073e406a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d3f50043f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55d3f4ffefb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d3f5010469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d3f50004e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x55d3f50b36d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f233a1721e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55d3f50086ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55d3f4fc33ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55d3f5007723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55d3f5005929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d3f5010712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d3f50004e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d3f5010712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d3f50004e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d3f5010712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d3f50004e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d3f5010712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d3f50004e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55d3f4ffefb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d3f5010469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55d3f5001042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55d3f4ffefb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55d3f501d8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55d3f501e04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55d3f50e180e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55d3f50086ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d3f50043f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d3f5010712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55d3f501d9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d3f50043f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d3f5010712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d3f50004e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55d3f4ffefb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d3f5010469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d3f50004e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55d3f5010712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55d3f5000232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55d3f4ffefb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d3f5010469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55d3f5001042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55d3f4ffefb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55d3f4ffec88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55d3f4ffec39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55d3f50ac2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55d3f50d96ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55d3f50d5a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55d3f50cd87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55d3f50cd76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55d3f50cc9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55d3f50a0107]
=================================
[dgx13:76899:0:76899] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  76899) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fbdcf444c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7fbdcf444e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7fbdcf444fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fbe1846c420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fbdcf4c7997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fbdcf4f188d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7fbdcf3fb93f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7fbdcf3feb18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fbdcf44e509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fbdcf3fdc2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fbdcf4c486a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fbdcf58406a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x559acdc143f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x559acdc0efb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559acdc20469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559acdc104e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x559acdcc36d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7fbe0e2f21e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559acdc186ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x559acdbd33ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x559acdc17723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x559acdc15929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559acdc20712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559acdc104e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559acdc20712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559acdc104e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559acdc20712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559acdc104e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559acdc20712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559acdc104e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x559acdc0efb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559acdc20469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x559acdc11042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x559acdc0efb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x559acdc2d8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x559acdc2e04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x559acdcf180e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559acdc186ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x559acdc143f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559acdc20712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x559acdc2d9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x559acdc143f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559acdc20712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559acdc104e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x559acdc0efb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559acdc20469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559acdc104e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x559acdc20712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x559acdc10232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x559acdc0efb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559acdc20469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x559acdc11042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x559acdc0efb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x559acdc0ec88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559acdc0ec39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x559acdcbc2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x559acdce96ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x559acdce5a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x559acdcdd87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x559acdcdd76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x559acdcdc9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x559acdcb0107]
=================================
[dgx13:76878:0:76878] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  76878) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f75885c2c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f75885c2e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f75885c2fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f75c1458420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f7588645997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f758866f88d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f758857993f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f758857cb18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f75885cc509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f758857bc2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f758864286a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f758870206a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x555ee91053f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x555ee90fffb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x555ee9111469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555ee91014e6]
16  /opt/conda/envs/gdf/bin/python(+0x1e26d2) [0x555ee91b46d2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f75b32d01e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x555ee91096ac]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x555ee90c43ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x555ee9108723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x555ee9106929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555ee9111712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555ee91014e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555ee9111712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555ee91014e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555ee9111712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555ee91014e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555ee9111712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555ee91014e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x555ee90fffb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x555ee9111469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x555ee9102042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x555ee90fffb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x555ee911e8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x555ee911f04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x555ee91e280e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x555ee91096ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x555ee91053f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555ee9111712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x555ee911e9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x555ee91053f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555ee9111712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555ee91014e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x555ee90fffb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x555ee9111469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555ee91014e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x555ee9111712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x555ee9101232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x555ee90fffb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x555ee9111469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x555ee9102042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x555ee90fffb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x555ee90ffc88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x555ee90ffc39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x555ee91ad2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x555ee91da6ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x555ee91d6a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x555ee91ce87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x555ee91ce76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x555ee91cd9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x555ee91a1107]
=================================
Task exception was never retrieved
future: <Task finished name='Task-275' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:140> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 155, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 55, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
Task exception was never retrieved
future: <Task finished name='Task-264' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:140> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 155, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 55, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2024-03-10 07:48:04,494 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50587 -> ucx://127.0.0.1:40483
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fce550b3200, tag: 0x7b42122a944ddb7b, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-10 07:48:04,495 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40483
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fe290484140, tag: 0x9088aa14dfbc7a84, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fe290484140, tag: 0x9088aa14dfbc7a84, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-10 07:48:04,495 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40483
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fce550b3100, tag: 0xb2bf63713f89f244, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fce550b3100, tag: 0xb2bf63713f89f244, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-10 07:48:04,500 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40483
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 467, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1016, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 328, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 60, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 469, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-03-10 07:48:04,546 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58861
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fe2904841c0, tag: 0x2d0726e54ffbe24e, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fe2904841c0, tag: 0x2d0726e54ffbe24e, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-10 07:48:04,547 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:43291 -> ucx://127.0.0.1:58861
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3dfc4281c0, tag: 0xcc9e0fd54a623a45, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-10 07:48:04,548 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58861
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f3dfc428180, tag: 0x1b05af06adbef1ff, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f3dfc428180, tag: 0x1b05af06adbef1ff, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-10 07:48:04,551 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35283
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fce550b3180, tag: 0xd876828df97820f4, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fce550b3180, tag: 0xd876828df97820f4, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-10 07:48:04,551 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:36163 -> ucx://127.0.0.1:35283
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fe290484280, tag: 0x5729122a2499193c, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-10 07:48:04,552 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50587 -> ucx://127.0.0.1:35283
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fce550b3300, tag: 0xb64153b3578a9c40, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-10 07:48:04,551 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35283
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7fa9bc1e1140, tag: 0xe2a7737237328be7, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7fa9bc1e1140, tag: 0xe2a7737237328be7, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-10 07:48:04,553 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35283
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fe290484100, tag: 0x95b3414cfd49baed, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fe290484100, tag: 0x95b3414cfd49baed, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
[dgx13:76884:0:76884] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x3e2530)
==== backtrace (tid:  76884) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fe2907a5c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7fe2907a5e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7fe2907a5fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fe2c97c8420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fe290828997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fe29085288d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7fe29075c93f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7fe29075fb18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fe2907af509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fe29075ec2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fe29082586a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fe2908e506a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5614281e43f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5614281defb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5614281f0469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5614281e04e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5614281f0712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x5614281fda83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x56142830919c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x5614281a33ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x5614281e7723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x5614281e5929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5614281f0712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5614281e04e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5614281f0712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5614281e04e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5614281f0712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5614281e04e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5614281f0712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5614281e04e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5614281defb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5614281f0469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5614281e1042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5614281defb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x5614281fd8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5614281fe04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x5614282c180e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5614281e86ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5614281e43f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5614281f0712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x5614281fd9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5614281e43f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5614281f0712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5614281e04e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5614281defb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5614281f0469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5614281e04e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x5614281f0712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5614281e0232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5614281defb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5614281f0469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5614281e1042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x5614281defb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5614281dec88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5614281dec39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56142828c2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x5614282b96ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x5614282b5a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5614282ad87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5614282ad76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5614282ac9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x561428280107]
=================================
2024-03-10 07:48:04,732 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:47333 -> ucx://127.0.0.1:46677
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fa9bc1e12c0, tag: 0xdf4f7db118245d58, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-10 07:48:04,733 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:47333 -> ucx://127.0.0.1:58861
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fa9bc1e1280, tag: 0x599270fdb92ca2e3, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-10 07:48:04,733 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46677
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fa9bc1e11c0, tag: 0x88ca0ca28b78d0cf, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fa9bc1e11c0, tag: 0x88ca0ca28b78d0cf, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-10 07:48:04,989 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:43291 -> ucx://127.0.0.1:36163
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3dfc428180, tag: 0x6643aaae96ba476a, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-10 07:48:04,989 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36163
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #018] ep: 0x7fce550b31c0, tag: 0x8765bc4504a14238, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #018] ep: 0x7fce550b31c0, tag: 0x8765bc4504a14238, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-10 07:48:04,994 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36163
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 467, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1016, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 328, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 60, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 469, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-03-10 07:48:06,921 - distributed.nanny - WARNING - Restarting worker
2024-03-10 07:48:06,922 - distributed.nanny - WARNING - Restarting worker
2024-03-10 07:48:07,056 - distributed.nanny - WARNING - Restarting worker
2024-03-10 07:48:07,137 - distributed.nanny - WARNING - Restarting worker
2024-03-10 07:48:07,175 - distributed.nanny - WARNING - Restarting worker
[dgx13:77041:0:77041] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  77041) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f1d2c62cc0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f1d2c62ce04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f1d2c62cfca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f1d654c8420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f1d2c6af997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f1d2c6d988d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f1d2c5e393f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f1d2c5e6b18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f1d2c636509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f1d2c5e5c2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f1d2c6ac86a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f1d2c76c06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55ec10f413f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ec10f3bfb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ec10f4d469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec10f3d4e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ec10f4d712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x55ec10f5aa83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x55ec1106619c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55ec10f003ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55ec10f44723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55ec10f42929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ec10f4d712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec10f3d4e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ec10f4d712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec10f3d4e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ec10f4d712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec10f3d4e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ec10f4d712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec10f3d4e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ec10f3bfb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ec10f4d469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55ec10f3e042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ec10f3bfb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55ec10f5a8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55ec10f5b04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55ec1101e80e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55ec10f456ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55ec10f413f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ec10f4d712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55ec10f5a9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55ec10f413f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ec10f4d712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec10f3d4e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ec10f3bfb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ec10f4d469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec10f3d4e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ec10f4d712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55ec10f3d232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ec10f3bfb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ec10f4d469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55ec10f3e042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ec10f3bfb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55ec10f3bc88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55ec10f3bc39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55ec10fe92cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55ec110166ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55ec11012a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55ec1100a87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55ec1100a76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55ec110099a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55ec10fdd107]
=================================
2024-03-10 07:48:10,389 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:34437
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fce550b3300, tag: 0x4ebed784b9c80c0a, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fce550b3300, tag: 0x4ebed784b9c80c0a, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-03-10 07:48:10,390 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50587 -> ucx://127.0.0.1:34437
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fce550b3100, tag: 0x20f80b5585f4ffaa, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
[dgx13:77051:0:77051] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  77051) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f0f31b85c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f0f31b85e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f0f31b85fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f0f70bc2420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f0f31c08997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f0f31c3288d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f0f31b3c93f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f0f31b3fb18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f0f31b8f509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f0f31b3ec2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f0f31c0586a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f0f31cc506a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x563b375443f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x563b3753efb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563b37550469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563b375404e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563b37550712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x563b3755da83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x563b3766919c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x563b375033ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x563b37547723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x563b37545929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563b37550712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563b375404e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563b37550712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563b375404e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563b37550712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563b375404e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563b37550712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563b375404e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x563b3753efb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563b37550469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x563b37541042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x563b3753efb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x563b3755d8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x563b3755e04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x563b3762180e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x563b375486ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x563b375443f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563b37550712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x563b3755d9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x563b375443f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563b37550712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563b375404e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x563b3753efb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563b37550469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563b375404e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x563b37550712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x563b37540232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x563b3753efb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563b37550469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x563b37541042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x563b3753efb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x563b3753ec88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x563b3753ec39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x563b375ec2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x563b376196ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x563b37615a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x563b3760d87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x563b3760d76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x563b3760c9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x563b375e0107]
=================================
2024-03-10 07:48:10,821 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50587 -> ucx://127.0.0.1:49157
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fce550b3300, tag: 0x81cf1bfa6aefb18b, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-10 07:48:10,821 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49157
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fce550b3100, tag: 0xa1f044f3d58e4cf1, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fce550b3100, tag: 0xa1f044f3d58e4cf1, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
[dgx13:77045:0:77045] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  77045) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f9e03ca5c0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2de04) [0x7f9e03ca5e04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2dfca) [0x7f9e03ca5fca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f9e42cdc420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f9e03d28997]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f9e03d5288d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2193f) [0x7f9e03c5c93f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24b18) [0x7f9e03c5fb18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f9e03caf509]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f9e03c5ec2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f9e03d2586a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f9e03de506a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55ed002c33f6]
13  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ed002bdfb4]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ed002cf469]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed002bf4e6]
16  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed002cf712]
17  /opt/conda/envs/gdf/bin/python(+0x14ca83) [0x55ed002dca83]
18  /opt/conda/envs/gdf/bin/python(+0x25819c) [0x55ed003e819c]
19  /opt/conda/envs/gdf/bin/python(+0xf23ff) [0x55ed002823ff]
20  /opt/conda/envs/gdf/bin/python(+0x136723) [0x55ed002c6723]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ad9) [0x55ed002c4929]
22  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed002cf712]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed002bf4e6]
24  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed002cf712]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed002bf4e6]
26  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed002cf712]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed002bf4e6]
28  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed002cf712]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed002bf4e6]
30  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ed002bdfb4]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ed002cf469]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55ed002c0042]
33  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ed002bdfb4]
34  /opt/conda/envs/gdf/bin/python(+0x14c8cb) [0x55ed002dc8cb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55ed002dd04c]
36  /opt/conda/envs/gdf/bin/python(+0x21080e) [0x55ed003a080e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55ed002c76ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55ed002c33f6]
39  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed002cf712]
40  /opt/conda/envs/gdf/bin/python(+0x14c9ac) [0x55ed002dc9ac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55ed002c33f6]
42  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed002cf712]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed002bf4e6]
44  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ed002bdfb4]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ed002cf469]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed002bf4e6]
47  /opt/conda/envs/gdf/bin/python(+0x13f712) [0x55ed002cf712]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55ed002bf232]
49  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ed002bdfb4]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ed002cf469]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55ed002c0042]
52  /opt/conda/envs/gdf/bin/python(+0x12dfb4) [0x55ed002bdfb4]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55ed002bdc88]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55ed002bdc39]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55ed0036b2cb]
56  /opt/conda/envs/gdf/bin/python(+0x2086ca) [0x55ed003986ca]
57  /opt/conda/envs/gdf/bin/python(+0x204a63) [0x55ed00394a63]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55ed0038c87a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55ed0038c76c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55ed0038b9a7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55ed0035f107]
=================================
2024-03-10 07:48:11,243 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50587 -> ucx://127.0.0.1:49313
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fce550b3340, tag: 0xd4593ff32c78b11a, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1779, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-10 07:48:11,246 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49313
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fce550b3300, tag: 0x97bc05fefb1cf093, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fce550b3300, tag: 0x97bc05fefb1cf093, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-03-10 07:48:14,248 - distributed.nanny - WARNING - Restarting worker
2024-03-10 07:48:14,339 - distributed.nanny - WARNING - Restarting worker
2024-03-10 07:48:14,341 - distributed.nanny - WARNING - Restarting worker
2024-03-10 07:48:34,588 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46677
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 467, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1016, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 328, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 60, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 490, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 492, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2056, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2857, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 368, in connect
    raise OSError(
OSError: Timed out trying to connect to ucx://127.0.0.1:46677 after 30 s
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
