2023-04-30 06:09:07,521 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:07,521 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-30 06:09:07,521 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:07,521 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-30 06:09:07,529 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:07,529 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-30 06:09:07,607 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:07,607 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-30 06:09:07,607 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:07,607 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-30 06:09:07,607 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:07,607 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-30 06:09:07,610 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:07,610 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-30 06:09:07,654 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:07,654 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:76820:0:76820] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  76820) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f3c45cbcdec]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31fcf) [0x7f3c45cbcfcf]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x32304) [0x7f3c45cbd304]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f3cfefa9420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f3c45d4c838]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f3c45d810d8]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23457) [0x7f3c45c6c457]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a38) [0x7f3c45c6ca38]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x260fc) [0x7f3c45c6f0fc]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f3c45cc84d9]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f3c45c6f1ab]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f3c45d48caa]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f3c45e0b6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x5654ce1e4b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x5654ce1d5112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5654ce1ce27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5654ce1dfc05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654ce1cf81b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5654ce1f470e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f3c7e86d2fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5654ce1d82bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5654ce18b817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x5654ce1d6f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5654ce1d4d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654ce1dfef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654ce1cf81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654ce1dfef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654ce1cf81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654ce1dfef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654ce1cf81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654ce1dfef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654ce1cf81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5654ce1ce27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5654ce1dfc05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5654ce1d3fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5654ce1ce27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x5654ce1ed935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5654ce1ee104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x5654ce2b4fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5654ce1d82bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5654ce1d31bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654ce1dfef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x5654ce1edc72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5654ce1d31bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654ce1dfef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654ce1cf81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5654ce1ce27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5654ce1dfc05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654ce1cf81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654ce1dfef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5654ce1cf568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5654ce1ce27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5654ce1dfc05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5654ce1d03cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5654ce1ce27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5654ce1cdf07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5654ce1cdeb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5654ce27e8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x5654ce2acadc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x5654ce2a8c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5654ce2a07ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5654ce2a06bd]
=================================
2023-04-30 06:09:15,409 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:32973 -> ucx://127.0.0.1:42687
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f9b13e96100, tag: 0x5cacdd9e2fbf40f0, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-04-30 06:09:15,559 - distributed.nanny - WARNING - Restarting worker
[dgx13:76813:0:76813] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  76813) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f502580bdec]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31fcf) [0x7f502580bfcf]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x32304) [0x7f502580c304]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f50c8c45420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f502589b838]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f50258d00d8]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23457) [0x7f50257bb457]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a38) [0x7f50257bba38]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x260fc) [0x7f50257be0fc]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f50258174d9]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f50257be1ab]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f5025897caa]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f502595a6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x561576656b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x561576647112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56157664027a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x561576651c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56157664181b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561576651ef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x56157665fa16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x56157676f9b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5615765fd817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x561576648f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x561576646d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561576651ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56157664181b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561576651ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56157664181b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561576651ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56157664181b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561576651ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56157664181b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56157664027a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x561576651c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x561576645fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56157664027a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x56157665f935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x561576660104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x561576726fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x56157664a2bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5615766451bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561576651ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x56157665fc72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5615766451bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561576651ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56157664181b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56157664027a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x561576651c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56157664181b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561576651ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x561576641568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56157664027a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x561576651c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5615766423cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56157664027a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x56157663ff07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56157663feb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5615766f08bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x56157671eadc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x56157671ac24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5615767127ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5615767126bd]
=================================
2023-04-30 06:09:16,032 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:41809 -> ucx://127.0.0.1:37943
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fbe7ca72200, tag: 0x22b8260c4ac28498, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-04-30 06:09:16,032 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37943
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #010] ep: 0x7f4d9d85e100, tag: 0x9e4e6e792ab70da6, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #010] ep: 0x7f4d9d85e100, tag: 0x9e4e6e792ab70da6, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-04-30 06:09:16,032 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:46829 -> ucx://127.0.0.1:37943
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f02755bb140, tag: 0xbb97379010d09530, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-04-30 06:09:16,033 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37943
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fbe7ca72380, tag: 0x25861f421e2d7c4a, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fbe7ca72380, tag: 0x25861f421e2d7c4a, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-04-30 06:09:16,033 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37943
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f02755bb300, tag: 0x5901b851b51eefc7, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f02755bb300, tag: 0x5901b851b51eefc7, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
[dgx13:76808:0:76808] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
[dgx13:76822:0:76822] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  76808) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f9b40167dec]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31fcf) [0x7f9b40167fcf]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x32304) [0x7f9b40168304]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f9bdf5b9420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f9b401f7838]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f9b4022c0d8]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23457) [0x7f9b40117457]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a38) [0x7f9b40117a38]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x260fc) [0x7f9b4011a0fc]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f9b401734d9]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f9b4011a1ab]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f9b401f3caa]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f9b402b66e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x555732f5cb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x555732f4d112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x555732f4627a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x555732f57c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555732f4781b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x555732f6c70e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f9b5ee832fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x555732f502bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x555732f03817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x555732f4ef83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x555732f4cd36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555732f57ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555732f4781b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555732f57ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555732f4781b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555732f57ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555732f4781b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555732f57ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555732f4781b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x555732f4627a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x555732f57c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x555732f4bfa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x555732f4627a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x555732f65935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x555732f66104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55573302cfc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x555732f502bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x555732f4b1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555732f57ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x555732f65c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x555732f4b1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555732f57ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555732f4781b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x555732f4627a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x555732f57c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555732f4781b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555732f57ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x555732f47568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x555732f4627a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x555732f57c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x555732f483cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x555732f4627a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x555732f45f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x555732f45eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x555732ff68bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x555733024adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x555733020c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5557330187ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5557330186bd]
=================================
==== backtrace (tid:  76822) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7fbe7cd41dec]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31fcf) [0x7fbe7cd41fcf]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x32304) [0x7fbe7cd42304]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fbf0e191420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7fbe7cdd1838]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fbe7ce060d8]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23457) [0x7fbe7ccf1457]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a38) [0x7fbe7ccf1a38]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x260fc) [0x7fbe7ccf40fc]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7fbe7cd4d4d9]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fbe7ccf41ab]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fbe7cdcdcaa]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7fbe7ce906e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x5611a21e3b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x5611a21d4112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5611a21cd27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5611a21dec05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5611a21ce81b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5611a21deef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x5611a21eca16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x5611a22fc9b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5611a218a817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x5611a21d5f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5611a21d3d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5611a21deef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5611a21ce81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5611a21deef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5611a21ce81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5611a21deef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5611a21ce81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5611a21deef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5611a21ce81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5611a21cd27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5611a21dec05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5611a21d2fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5611a21cd27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x5611a21ec935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5611a21ed104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x5611a22b3fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5611a21d72bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5611a21d21bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5611a21deef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x5611a21ecc72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5611a21d21bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5611a21deef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5611a21ce81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5611a21cd27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5611a21dec05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5611a21ce81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5611a21deef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5611a21ce568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5611a21cd27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5611a21dec05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5611a21cf3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5611a21cd27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5611a21ccf07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5611a21cceb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5611a227d8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x5611a22abadc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x5611a22a7c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5611a229f7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5611a229f6bd]
=================================
2023-04-30 06:09:16,066 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38095 -> ucx://127.0.0.1:37943
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 629, in send
    self._ep.raise_on_error()
  File "ucp/_libs/ucx_endpoint.pyx", line 353, in ucp._libs.ucx_api.UCXEndpoint.raise_on_error
ucp._libs.exceptions.UCXConnectionReset: Endpoint 0x7fb7312d4280 error: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-04-30 06:09:16,067 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37943
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 708, in recv
    self._ep.raise_on_error()
  File "ucp/_libs/ucx_endpoint.pyx", line 353, in ucp._libs.ucx_api.UCXEndpoint.raise_on_error
ucp._libs.exceptions.UCXConnectionReset: Endpoint 0x7fb7312d4180 error: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXConnectionReset('Endpoint 0x7fb7312d4180 error: Connection reset by remote peer')
2023-04-30 06:09:16,110 - distributed.nanny - WARNING - Restarting worker
[dgx13:76804:0:76804] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  76804) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7fdf98a5fdec]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31fcf) [0x7fdf98a5ffcf]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x32304) [0x7fdf98a60304]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fe029ea0420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7fdf98aef838]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fdf98b240d8]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23457) [0x7fdf98a0f457]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a38) [0x7fdf98a0fa38]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x260fc) [0x7fdf98a120fc]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7fdf98a6b4d9]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fdf98a121ab]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fdf98aebcaa]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7fdf98bae6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55e0c2d3ab08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55e0c2d2b112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e0c2d2427a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e0c2d35c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e0c2d2581b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55e0c2d4a70e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7fdfa976c2fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55e0c2d2e2bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55e0c2ce1817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55e0c2d2cf83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55e0c2d2ad36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e0c2d35ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e0c2d2581b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e0c2d35ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e0c2d2581b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e0c2d35ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e0c2d2581b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e0c2d35ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e0c2d2581b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e0c2d2427a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e0c2d35c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55e0c2d29fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e0c2d2427a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55e0c2d43935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55e0c2d44104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55e0c2e0afc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55e0c2d2e2bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55e0c2d291bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e0c2d35ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55e0c2d43c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55e0c2d291bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e0c2d35ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e0c2d2581b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e0c2d2427a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e0c2d35c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e0c2d2581b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e0c2d35ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55e0c2d25568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e0c2d2427a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e0c2d35c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55e0c2d263cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e0c2d2427a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55e0c2d23f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55e0c2d23eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55e0c2dd48bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55e0c2e02adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55e0c2dfec24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55e0c2df67ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55e0c2df66bd]
=================================
2023-04-30 06:09:16,230 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:32973
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #009] ep: 0x7fb7312d4240, tag: 0x22c4809819cc34d1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #009] ep: 0x7fb7312d4240, tag: 0x22c4809819cc34d1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-04-30 06:09:16,256 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:32973
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 329, in connect
    handshake = await wait_for(comm.read(), time_left())
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 469, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f02755bb380, tag: 0xc447ee6622a21576, nbytes: 16, type: <class 'numpy.ndarray'>>: ")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 334, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:32973 after 30 s
2023-04-30 06:09:16,288 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:40631 -> ucx://127.0.0.1:32973
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f4d9d85e300, tag: 0x6b4b96ea90643c59, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-04-30 06:09:16,289 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:32973
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f4d9d85e200, tag: 0xf45c7c7fcf87834a, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f4d9d85e200, tag: 0xf45c7c7fcf87834a, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-04-30 06:09:16,276 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38095 -> ucx://127.0.0.1:41809
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fb7312d4380, tag: 0xede9e5447ff47de4, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-04-30 06:09:16,296 - distributed.nanny - WARNING - Restarting worker
2023-04-30 06:09:16,292 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41809
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fb7312d4140, tag: 0xe3b5727239c5a28d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fb7312d4140, tag: 0xe3b5727239c5a28d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-04-30 06:09:16,321 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:56239
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f02755bb340, tag: 0xdf193133ff628f3a, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f02755bb340, tag: 0xdf193133ff628f3a, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-04-30 06:09:16,383 - distributed.nanny - WARNING - Restarting worker
2023-04-30 06:09:16,389 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:56239
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f4d9d85e140, tag: 0x43600492279355ed, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f4d9d85e140, tag: 0x43600492279355ed, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-04-30 06:09:16,437 - distributed.nanny - WARNING - Restarting worker
2023-04-30 06:09:16,448 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:56239
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fb7312d41c0, tag: 0x79a6e9c6e709a9ff, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fb7312d41c0, tag: 0x79a6e9c6e709a9ff, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-04-30 06:09:17,200 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:17,200 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-30 06:09:17,770 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:17,770 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-30 06:09:17,813 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:17,813 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-30 06:09:17,945 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:17,946 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-30 06:09:18,043 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-30 06:09:18,043 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
