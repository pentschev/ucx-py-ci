/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/node.py:182: UserWarning: Port 8787 is already in use.
Perhaps you already have a cluster running?
Hosting the HTTP server on port 38275 instead
  warnings.warn(
[dgx13:72850:0:72850] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  72850) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f52952b006d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f52952b0264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f52952b042a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f533a444420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f529532e6a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f5295357829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f529526a46f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f529526d8c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f52952b9499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f529526c66d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f529532b8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f52953e406a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5563f6bf46fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5563f6bf0094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5563f6c01519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5563f6bf15c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5563f6ca4162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f52ba5cc1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5563f6bf977c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5563f6babd05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5563f6bf87f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5563f6bf6929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5563f6c017c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5563f6bf15c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5563f6c017c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5563f6bf15c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5563f6c017c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5563f6bf15c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5563f6c017c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5563f6bf15c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5563f6bf0094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5563f6c01519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5563f6bf2128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5563f6bf0094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5563f6c0eccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5563f6c0f44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5563f6cd210e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5563f6bf977c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5563f6bf46fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5563f6c017c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5563f6c0edac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5563f6bf46fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5563f6c017c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5563f6bf15c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5563f6bf0094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5563f6c01519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5563f6bf15c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5563f6c017c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5563f6bf1312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5563f6bf0094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5563f6c01519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5563f6bf2128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5563f6bf0094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5563f6befd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5563f6befd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5563f6c9d07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5563f6cc9fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5563f6cc6353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5563f6cbe16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5563f6cbe05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5563f6cbd297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5563f6c90f07]
=================================
Task exception was never retrieved
future: <Task finished name='Task-976' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-11-01 05:54:54,852 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:47473 -> ucx://127.0.0.1:43047
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f7938a72100, tag: 0xa8945ac9dd1963ea, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
Task exception was never retrieved
future: <Task finished name='Task-979' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
[dgx13:72844:0:72844] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  72844) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fe8538e806d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7fe8538e8264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7fe8538e842a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fe8faa5d420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fe8539666a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fe85398f829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7fe8538a246f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7fe8538a58c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fe8538f1499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fe8538a466d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fe8539638ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fe853a1c06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55afff2da6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55afff2d6094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55afff2e7519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55afff2d75c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55afff38a162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7fe87abe31e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55afff2df77c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55afff291d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55afff2de7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55afff2dc929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55afff2e77c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55afff2d75c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55afff2e77c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55afff2d75c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55afff2e77c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55afff2d75c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55afff2e77c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55afff2d75c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55afff2d6094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55afff2e7519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55afff2d8128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55afff2d6094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55afff2f4ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55afff2f544c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55afff3b810e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55afff2df77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55afff2da6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55afff2e77c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55afff2f4dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55afff2da6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55afff2e77c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55afff2d75c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55afff2d6094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55afff2e7519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55afff2d75c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55afff2e77c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55afff2d7312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55afff2d6094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55afff2e7519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55afff2d8128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55afff2d6094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55afff2d5d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55afff2d5d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55afff38307b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55afff3affca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55afff3ac353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55afff3a416a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55afff3a405c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55afff3a3297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55afff376f07]
=================================
[dgx13:72856:0:72856] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
[dgx13:72832:0:72832] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  72856) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f9fd8e8406d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f9fd8e84264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f9fd8e8442a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fa079fe8420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f9fd8f026a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f9fd8f2b829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f9fd8e3e46f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f9fd8e418c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f9fd8e8d499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f9fd8e4066d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f9fd8eff8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f9fd8fb806a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x560fcf7b76fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560fcf7b3094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560fcf7c4519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560fcf7b45c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560fcf7c47c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x560fcf7d1e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x560fcf8dcb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x560fcf76ed05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x560fcf7bb7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x560fcf7b9929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560fcf7c47c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560fcf7b45c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560fcf7c47c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560fcf7b45c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560fcf7c47c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560fcf7b45c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560fcf7c47c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560fcf7b45c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560fcf7b3094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560fcf7c4519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x560fcf7b5128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560fcf7b3094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x560fcf7d1ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x560fcf7d244c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x560fcf89510e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x560fcf7bc77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x560fcf7b76fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560fcf7c47c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x560fcf7d1dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x560fcf7b76fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560fcf7c47c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560fcf7b45c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560fcf7b3094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560fcf7c4519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560fcf7b45c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560fcf7c47c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x560fcf7b4312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560fcf7b3094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560fcf7c4519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x560fcf7b5128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560fcf7b3094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x560fcf7b2d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x560fcf7b2d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x560fcf86007b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x560fcf88cfca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x560fcf889353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x560fcf88116a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x560fcf88105c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x560fcf880297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x560fcf853f07]
=================================
==== backtrace (tid:  72832) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f6f99c1106d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f6f99c11264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f6f99c1142a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f703eda2420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f6f99c8f6a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f6f99cb8829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f6f99bcb46f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f6f99bce8c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f6f99c1a499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f6f99bcd66d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f6f99c8c8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f6f99d4506a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x561b93d5f6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561b93d5b094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561b93d6c519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561b93d5c5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x561b93e0f162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f6fbef261e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x561b93d6477c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x561b93d16d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x561b93d637f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x561b93d61929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561b93d6c7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561b93d5c5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561b93d6c7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561b93d5c5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561b93d6c7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561b93d5c5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561b93d6c7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561b93d5c5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561b93d5b094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561b93d6c519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x561b93d5d128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561b93d5b094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x561b93d79ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x561b93d7a44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x561b93e3d10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x561b93d6477c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x561b93d5f6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561b93d6c7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x561b93d79dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x561b93d5f6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561b93d6c7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561b93d5c5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561b93d5b094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561b93d6c519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561b93d5c5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561b93d6c7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x561b93d5c312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561b93d5b094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561b93d6c519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x561b93d5d128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561b93d5b094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x561b93d5ad68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x561b93d5ad19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x561b93e0807b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x561b93e34fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x561b93e31353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x561b93e2916a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x561b93e2905c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x561b93e28297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x561b93dfbf07]
=================================
[dgx13:72847:0:72847] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  72847) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd07307b06d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7fd07307b264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7fd07307b42a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd1141f7420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fd0730f96a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fd073122829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7fd07303546f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7fd0730388c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd073084499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd07303766d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd0730f68ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fd0731af06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55680b00f6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55680b00b094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55680b01c519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55680b00c5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55680b0bf162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7fd09437b1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55680b01477c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55680afc6d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55680b0137f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55680b011929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55680b01c7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55680b00c5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55680b01c7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55680b00c5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55680b01c7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55680b00c5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55680b01c7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55680b00c5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55680b00b094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55680b01c519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55680b00d128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55680b00b094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55680b029ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55680b02a44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55680b0ed10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55680b01477c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55680b00f6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55680b01c7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55680b029dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55680b00f6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55680b01c7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55680b00c5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55680b00b094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55680b01c519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55680b00c5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55680b01c7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55680b00c312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55680b00b094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55680b01c519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55680b00d128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55680b00b094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55680b00ad68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55680b00ad19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55680b0b807b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55680b0e4fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55680b0e1353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55680b0d916a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55680b0d905c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55680b0d8297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55680b0abf07]
=================================
[dgx13:72836:0:72836] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  72836) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f2f15cb106d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f2f15cb1264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f2f15cb142a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f2fd0e48420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f2f15d2f6a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f2f15d58829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f2f15c6b46f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f2f15c6e8c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f2f15cba499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f2f15c6d66d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f2f15d2c8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f2f15de506a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56461a66e6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56461a66a094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56461a67b519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56461a66b5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x56461a71e162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f2fc41271e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56461a67377c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x56461a625d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x56461a6727f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x56461a670929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56461a67b7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56461a66b5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56461a67b7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56461a66b5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56461a67b7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56461a66b5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56461a67b7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56461a66b5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56461a66a094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56461a67b519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56461a66c128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56461a66a094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x56461a688ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56461a68944c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x56461a74c10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56461a67377c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56461a66e6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56461a67b7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x56461a688dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56461a66e6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56461a67b7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56461a66b5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56461a66a094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56461a67b519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56461a66b5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56461a67b7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x56461a66b312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56461a66a094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56461a67b519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56461a66c128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56461a66a094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x56461a669d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56461a669d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56461a71707b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x56461a743fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x56461a740353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x56461a73816a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x56461a73805c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x56461a737297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x56461a70af07]
=================================
2023-11-01 05:54:58,207 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:44157
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7fb42106a140, tag: 0x3430beed914c0139, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7fb42106a140, tag: 0x3430beed914c0139, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-11-01 05:54:58,291 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:40001 -> ucx://127.0.0.1:58715
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fb42106a2c0, tag: 0x77e86a4fbe4ab708, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-01 05:54:58,315 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58715
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fb42106a1c0, tag: 0x596df96ba3b08b65, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fb42106a1c0, tag: 0x596df96ba3b08b65, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-01 05:54:58,340 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50747
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fb42106a240, tag: 0xb76d94a883317a6f, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fb42106a240, tag: 0xb76d94a883317a6f, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-11-01 05:54:58,727 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:40001 -> ucx://127.0.0.1:44215
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fb42106a380, tag: 0x6969bf41bceeb2d3, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-01 05:54:58,728 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:44215
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fb42106a180, tag: 0xa0f16f98e8ece994, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fb42106a180, tag: 0xa0f16f98e8ece994, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-11-01 05:54:59,793 - distributed.nanny - WARNING - Restarting worker
2023-11-01 05:55:00,330 - distributed.core - ERROR - std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 377, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 378, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded
2023-11-01 05:55:00,331 - distributed.worker - ERROR - std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 377, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 378, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded
2023-11-01 05:55:00,354 - distributed.worker - WARNING - Compute Failed
Key:       ('sort_index-86563d3c54ed11bf71e0c240596313fc', 0)
Function:  subgraph_callable-4aa242f7-1a8a-4241-8af6-58a3efc4
args:      ('set_index_post_scalar-ceb9308523ab39bbcf59f6dccd678d89',                 key  shuffle   payload  _partitions
0             82500        0  14247704            0
1             82508        0  96804936            0
2             11872        0  88326504            0
3             82516        0  97079635            0
4             11881        0  64020292            0
...             ...      ...       ...          ...
99999995  799999739        0  74841576            0
99999996  799999743        0   2992010            0
99999997  799997152        0  89847665            0
99999998  799997155        0  47232790            0
99999999  799997162        0  53102159            0

[100000000 rows x 4 columns], 'simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e')
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-01 05:55:00,494 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 1)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0            82499        1  65904915            1
1            82509        1  37791787            1
2            11888        1  71742138            1
3            82511        1  93754322            1
4            82519        1  33262006            1
...            ...      ...       ...          ...
12499995  99986409        1   7783561            1
12499996  99986411        1  87264148            1
12499997  99986425        1  21014714            1
12499998  99986426        1  25950741            1
12499999  99986429        1  70644819            1

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100013025        1  98827148            1
1         100156323        1  66237363            1
2         100013028        1  92790763            1
3         100156335        1  11372570            1
4         100013030        1  54569938            1
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-01 05:55:00,632 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 3)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0            82503        3  58926972            3
1            82505        3  13560773            3
2            11877        3  75884734            3
3            82506        3  66487888            3
4            11880        3  35662621            3
...            ...      ...       ...          ...
12499995  99986291        3  33651437            3
12499996  99986296        3   5681891            3
12499997  99986407        3  95436002            3
12499998  99986419        3  45119717            3
12499999  99986420        3  79699138            3

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100013031        3  70431278            3
1         100156328        3  29658943            3
2         100013038        3  74697784            3
3         100156330        3   7082149            3
4         100013039        3  99769438            3
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-01 05:55:00,770 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 5)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0            11876        5  54185478            5
1            11885        5  34272163            5
2            11886        5  87730695            5
3           140961        5  97541885            5
4            11887        5  10863034            5
...            ...      ...       ...          ...
12499995  99986408        5  63173660            5
12499996  99986413        5  52434531            5
12499997  99986417        5  45667459            5
12499998  99986422        5  85197050            5
12499999  99986430        5  89965812            5

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100013048        5   4006809            5
1         100156346        5  13789151            5
2         100013053        5  15425711            5
3         100156348        5  46835355            5
4         100061155        5  10368134            5
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-01 05:55:00,905 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 6)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0            82497        6  31772176            6
1            82513        6  75884582            6
2            11878        6  81119156            6
3            82520        6  72484492            6
4            11894        6  95408000            6
...            ...      ...       ...          ...
12499995  99986285        6  93251604            6
12499996  99986292        6  15740625            6
12499997  99986400        6   4345599            6
12499998  99986412        6  96798218            6
12499999  99986421        6  63569783            6

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100013029        6   4325332            6
1         100156320        6  57044384            6
2         100013036        6  90826231            6
3         100013050        6  56797461            6
4         100061158        6  48176490            6
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-01 05:55:16,441 - distributed.nanny - WARNING - Worker process still alive after 3.199997253417969 seconds, killing
2023-11-01 05:55:16,465 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
2023-11-01 05:55:16,546 - distributed.nanny - WARNING - Worker process still alive after 3.1999990844726565 seconds, killing
2023-11-01 05:55:16,626 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
2023-11-01 05:55:16,954 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 18 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
