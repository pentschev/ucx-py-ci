[dgx13:79743:0:79743] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  79743) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f550882c15d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b354) [0x7f550882c354]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b51a) [0x7f550882c51a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f55a8f93420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f55088ac2f7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f55088d4b2d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2077f) [0x7f55087e577f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23958) [0x7f55087e8958]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f55088358a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f55087e7a6d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f55088a91fa]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f550896f5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5610232986fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561023294094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5610232a5519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5610232955c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5610232a57c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x5610232b2e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x5610233bdb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x56102324fd05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x56102329c7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x56102329a929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5610232a57c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5610232955c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5610232a57c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5610232955c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5610232a57c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5610232955c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5610232a57c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5610232955c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561023294094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5610232a5519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x561023296128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561023294094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5610232b2ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5610232b344c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x56102337610e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56102329d77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5610232986fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5610232a57c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5610232b2dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5610232986fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5610232a57c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5610232955c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561023294094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5610232a5519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5610232955c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5610232a57c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x561023295312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561023294094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5610232a5519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x561023296128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561023294094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x561023293d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x561023293d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56102334107b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x56102336dfca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x56102336a353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x56102336216a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x56102336205c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x561023361297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x561023334f07]
=================================
[dgx13:79734:0:79734] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  79734) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f40c4c4a15d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b354) [0x7f40c4c4a354]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b51a) [0x7f40c4c4a51a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f41573c0420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f40c4cca2f7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f40c4cf2b2d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2077f) [0x7f40c4c0377f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23958) [0x7f40c4c06958]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f40c4c538a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f40c4c05a6d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f40c4cc71fa]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f40c4d8d5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x555f0e8bd6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x555f0e8b9094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x555f0e8ca519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555f0e8ba5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x555f0e8ca7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x555f0e8d7e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x555f0e9e2b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x555f0e874d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x555f0e8c17f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x555f0e8bf929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x555f0e8ca7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555f0e8ba5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x555f0e8ca7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555f0e8ba5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x555f0e8ca7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555f0e8ba5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x555f0e8ca7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555f0e8ba5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x555f0e8b9094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x555f0e8ca519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x555f0e8bb128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x555f0e8b9094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x555f0e8d7ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x555f0e8d844c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x555f0e99b10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x555f0e8c277c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x555f0e8bd6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x555f0e8ca7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x555f0e8d7dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x555f0e8bd6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x555f0e8ca7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555f0e8ba5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x555f0e8b9094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x555f0e8ca519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x555f0e8ba5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x555f0e8ca7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x555f0e8ba312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x555f0e8b9094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x555f0e8ca519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x555f0e8bb128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x555f0e8b9094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x555f0e8b8d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x555f0e8b8d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x555f0e96607b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x555f0e992fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x555f0e98f353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x555f0e98716a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x555f0e98705c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x555f0e986297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x555f0e959f07]
=================================
2023-09-16 07:41:51,457 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48347 -> ucx://127.0.0.1:32873
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f43e1c7a100, tag: 0x1993e8f9ac9bd1f2, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:51,513 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:41:51,605 - distributed.nanny - WARNING - Restarting worker
[dgx13:79740:0:79740] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  79740) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f43e1ef715d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b354) [0x7f43e1ef7354]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b51a) [0x7f43e1ef751a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f4486664420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f43e1f772f7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f43e1f9fb2d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2077f) [0x7f43e1eb077f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23958) [0x7f43e1eb3958]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f43e1f008a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f43e1eb2a6d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f43e1f741fa]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f43f404f5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55eb315506fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55eb3154c094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55eb3155d519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eb3154d5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55eb31600162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f44071101e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55eb3155577c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55eb31507d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55eb315547f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55eb31552929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eb3155d7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eb3154d5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eb3155d7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eb3154d5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eb3155d7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eb3154d5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eb3155d7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eb3154d5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55eb3154c094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55eb3155d519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55eb3154e128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55eb3154c094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55eb3156accb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55eb3156b44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55eb3162e10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55eb3155577c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55eb315506fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eb3155d7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55eb3156adac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55eb315506fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eb3155d7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eb3154d5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55eb3154c094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55eb3155d519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eb3154d5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eb3155d7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55eb3154d312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55eb3154c094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55eb3155d519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55eb3154e128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55eb3154c094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55eb3154bd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55eb3154bd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55eb315f907b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55eb31625fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55eb31622353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55eb3161a16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55eb3161a05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55eb31619297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55eb315ecf07]
=================================
[dgx13:79731:0:79731] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  79731) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f0b12fdf15d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b354) [0x7f0b12fdf354]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b51a) [0x7f0b12fdf51a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f0bb773e420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f0b1305f2f7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f0b13087b2d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2077f) [0x7f0b12f9877f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23958) [0x7f0b12f9b958]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f0b12fe88a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f0b12f9aa6d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f0b1305c1fa]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f0b131225fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5569cae6a6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5569cae66094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5569cae77519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5569cae675c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5569cae777c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x5569cae84e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x5569caf8fb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5569cae21d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5569cae6e7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5569cae6c929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5569cae777c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5569cae675c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5569cae777c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5569cae675c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5569cae777c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5569cae675c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5569cae777c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5569cae675c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5569cae66094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5569cae77519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5569cae68128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5569cae66094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5569cae84ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5569cae8544c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5569caf4810e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5569cae6f77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5569cae6a6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5569cae777c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5569cae84dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5569cae6a6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5569cae777c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5569cae675c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5569cae66094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5569cae77519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5569cae675c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5569cae777c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5569cae67312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5569cae66094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5569cae77519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5569cae68128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5569cae66094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5569cae65d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5569cae65d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5569caf1307b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5569caf3ffca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5569caf3c353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5569caf3416a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5569caf3405c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5569caf33297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5569caf06f07]
=================================
[dgx13:79727:0:79727] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  79727) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f442c03915d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b354) [0x7f442c039354]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b51a) [0x7f442c03951a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f44be2e4420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f4419b5e2f7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f4419b86b2d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2077f) [0x7f4419af777f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23958) [0x7f4419afa958]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f442c0428a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f4419af9a6d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f4419b5b1fa]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f4419c215fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x558edc3ba6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558edc3b6094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558edc3c7519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558edc3b75c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x558edc46a162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f443ed8c1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x558edc3bf77c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x558edc371d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x558edc3be7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x558edc3bc929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558edc3c77c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558edc3b75c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558edc3c77c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558edc3b75c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558edc3c77c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558edc3b75c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558edc3c77c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558edc3b75c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558edc3b6094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558edc3c7519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x558edc3b8128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558edc3b6094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x558edc3d4ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x558edc3d544c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x558edc49810e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x558edc3bf77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x558edc3ba6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558edc3c77c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x558edc3d4dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x558edc3ba6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558edc3c77c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558edc3b75c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558edc3b6094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558edc3c7519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558edc3b75c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558edc3c77c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x558edc3b7312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558edc3b6094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558edc3c7519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x558edc3b8128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558edc3b6094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x558edc3b5d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x558edc3b5d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x558edc46307b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x558edc48ffca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x558edc48c353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x558edc48416a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x558edc48405c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x558edc483297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x558edc456f07]
=================================
2023-09-16 07:41:52,082 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48625 -> ucx://127.0.0.1:48347
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f2eb8f1a2c0, tag: 0x12827c6bfd8e3046, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:52,084 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48347
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f2eb8f1a200, tag: 0x53bc6fe015e7e2d3, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f2eb8f1a200, tag: 0x53bc6fe015e7e2d3, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:41:52,087 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48347
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-09-16 07:41:52,093 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53687
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7fbf1429a100, tag: 0xe2ba8ba03066d137, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7fbf1429a100, tag: 0xe2ba8ba03066d137, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:41:52,099 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44391 -> ucx://127.0.0.1:49923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fbf1429a300, tag: 0xf5cd9c0858816e55, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:52,102 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fbf1429a140, tag: 0x9bf8647c331691c2, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fbf1429a140, tag: 0x9bf8647c331691c2, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:41:52,193 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:41:52,203 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48625 -> ucx://127.0.0.1:49923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f2eb8f1a300, tag: 0x3da7c924e0f47574, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:52,204 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48625 -> ucx://127.0.0.1:53687
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f2eb8f1a240, tag: 0x44fc319a60c20f2a, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:52,205 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f2eb8f1a1c0, tag: 0x1e55077739946aed, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f2eb8f1a1c0, tag: 0x1e55077739946aed, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:41:52,206 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53687
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f2eb8f1a140, tag: 0x4263ca634c91e7cd, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f2eb8f1a140, tag: 0x4263ca634c91e7cd, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:41:52,256 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:41:52,088 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48347
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-09-16 07:41:52,274 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:60383 -> ucx://127.0.0.1:53687
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0460185100, tag: 0xb2d02c7ae106e5cc, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:52,275 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f0460185200, tag: 0x4cff4aae08aebde6, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f0460185200, tag: 0x4cff4aae08aebde6, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:41:52,276 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:60383 -> ucx://127.0.0.1:49923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0460185340, tag: 0xfcbc7975c8208a45, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:52,278 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53687
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f04601851c0, tag: 0x9ed8b54da727eab5, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f04601851c0, tag: 0x9ed8b54da727eab5, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:41:52,318 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:41:53,876 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-84a0276e6a854cf0d6c4324869a61d39', 7)
Function:  shuffle_group
args:      (                 key   payload
0         1518863339  99051695
1         1552208751  78953234
2          689778035  81293845
3         1553618300  74974697
4         1502090160  62919800
...              ...       ...
99999995    87713713  72068972
99999996  1549206659  33160153
99999997  1559655348  40095643
99999998  1552540937  33956372
99999999  1512812172  90324512

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

[dgx13:79895:0:79895] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  79895) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd3a1b7715d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b354) [0x7fd3a1b77354]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b51a) [0x7fd3a1b7751a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd44816d420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fd3a1bf72f7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fd3a1c1fb2d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2077f) [0x7fd3a1b3077f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23958) [0x7fd3a1b33958]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd3a1b808a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd3a1b32a6d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd3a1bf41fa]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fd3a1cba5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x560ebb6576fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560ebb653094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560ebb664519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560ebb6545c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560ebb6647c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x560ebb671e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x560ebb77cb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x560ebb60ed05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x560ebb65b7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x560ebb659929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560ebb6647c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560ebb6545c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560ebb6647c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560ebb6545c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560ebb6647c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560ebb6545c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560ebb6647c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560ebb6545c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560ebb653094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560ebb664519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x560ebb655128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560ebb653094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x560ebb671ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x560ebb67244c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x560ebb73510e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x560ebb65c77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x560ebb6576fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560ebb6647c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x560ebb671dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x560ebb6576fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560ebb6647c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560ebb6545c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560ebb653094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560ebb664519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560ebb6545c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560ebb6647c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x560ebb654312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560ebb653094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560ebb664519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x560ebb655128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560ebb653094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x560ebb652d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x560ebb652d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x560ebb70007b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x560ebb72cfca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x560ebb729353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x560ebb72116a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x560ebb72105c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x560ebb720297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x560ebb6f3f07]
=================================
[dgx13:79906:0:79906] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  79906) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fc6b48de15d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b354) [0x7fc6b48de354]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b51a) [0x7fc6b48de51a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fc746ec0420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fc6b495e2f7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fc6b4986b2d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2077f) [0x7fc6b489777f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23958) [0x7fc6b489a958]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fc6b48e78a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fc6b4899a6d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fc6b495b1fa]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fc6b4a215fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55f6246d76fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f6246d3094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f6246e4519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6246d45c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f6246e47c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55f6246f1e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55f6247fcb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55f62468ed05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55f6246db7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55f6246d9929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f6246e47c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6246d45c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f6246e47c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6246d45c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f6246e47c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6246d45c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f6246e47c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6246d45c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f6246d3094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f6246e4519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55f6246d5128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f6246d3094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55f6246f1ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55f6246f244c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55f6247b510e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55f6246dc77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55f6246d76fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f6246e47c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55f6246f1dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55f6246d76fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f6246e47c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6246d45c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f6246d3094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f6246e4519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f6246d45c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f6246e47c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55f6246d4312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f6246d3094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f6246e4519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55f6246d5128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f6246d3094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55f6246d2d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55f6246d2d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55f62478007b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55f6247acfca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55f6247a9353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55f6247a116a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55f6247a105c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55f6247a0297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55f624773f07]
=================================
2023-09-16 07:41:57,757 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:60383 -> ucx://127.0.0.1:54203
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0460185200, tag: 0x1f84ed0045e51aec, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:57,757 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54203
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fbf1429a300, tag: 0xcc6d33cd7a6a8085, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fbf1429a300, tag: 0xcc6d33cd7a6a8085, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:41:57,758 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54203
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f2eb8f1a140, tag: 0x2284ef9f7b287b7c, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f2eb8f1a140, tag: 0x2284ef9f7b287b7c, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:41:57,758 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54203
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f0460185340, tag: 0x128e9787b941e415, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f0460185340, tag: 0x128e9787b941e415, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:41:57,758 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44391 -> ucx://127.0.0.1:54203
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fbf1429a240, tag: 0x6c6391102cb5d6e6, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:57,762 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54203
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXNotConnected: <stream_recv>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-09-16 07:41:57,822 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:41:57,849 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:60383 -> ucx://127.0.0.1:51627
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #008] ep: 0x7f04601852c0, tag: 0x418cb245d6516afb, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:57,849 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48625 -> ucx://127.0.0.1:51627
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f2eb8f1a240, tag: 0x14555eb38d6193b0, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:57,849 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44391 -> ucx://127.0.0.1:51627
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fbf1429a280, tag: 0x538def9ee5a811cf, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:57,849 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48625 -> ucx://127.0.0.1:54203
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #008] ep: 0x7f2eb8f1a1c0, tag: 0x2b89f07ee7da07b5, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:41:57,890 - distributed.nanny - WARNING - Restarting worker
[dgx13:79912:0:79912] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  79912) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f45345a015d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b354) [0x7f45345a0354]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b51a) [0x7f45345a051a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f45c6b8f420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f45346202f7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f4534648b2d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2077f) [0x7f453455977f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23958) [0x7f453455c958]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f45345a98a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f453455ba6d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f453461d1fa]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f45346e35fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55c9c7d5a6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c9c7d56094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c9c7d67519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c9c7d575c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55c9c7e0a162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f454763e1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55c9c7d5f77c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55c9c7d11d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55c9c7d5e7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55c9c7d5c929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c9c7d677c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c9c7d575c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c9c7d677c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c9c7d575c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c9c7d677c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c9c7d575c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c9c7d677c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c9c7d575c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c9c7d56094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c9c7d67519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55c9c7d58128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c9c7d56094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55c9c7d74ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55c9c7d7544c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55c9c7e3810e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55c9c7d5f77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55c9c7d5a6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c9c7d677c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55c9c7d74dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55c9c7d5a6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c9c7d677c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c9c7d575c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c9c7d56094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c9c7d67519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c9c7d575c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c9c7d677c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55c9c7d57312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c9c7d56094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c9c7d67519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55c9c7d58128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c9c7d56094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55c9c7d55d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55c9c7d55d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55c9c7e0307b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55c9c7e2ffca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55c9c7e2c353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55c9c7e2416a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55c9c7e2405c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55c9c7e23297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55c9c7df6f07]
=================================
2023-09-16 07:42:01,204 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:60383 -> ucx://127.0.0.1:53681
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0460185200, tag: 0xece40a6859fca5ae, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:42:01,205 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53681
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f0460185340, tag: 0x55adb4146b8123ee, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f0460185340, tag: 0x55adb4146b8123ee, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:42:01,208 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53681
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXNotConnected: <stream_recv>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-09-16 07:42:01,213 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44391 -> ucx://127.0.0.1:53681
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fbf1429a240, tag: 0x8abd89bb86e3d587, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:42:01,214 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53681
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7fbf1429a280, tag: 0xf4405d0c3ff26691, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7fbf1429a280, tag: 0xf4405d0c3ff26691, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-09-16 07:42:01,254 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48625 -> ucx://127.0.0.1:53681
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f2eb8f1a240, tag: 0x49efc09f4f7567fc, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:42:01,255 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53681
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f2eb8f1a1c0, tag: 0x28f7aa96b8c4f4ff, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f2eb8f1a1c0, tag: 0x28f7aa96b8c4f4ff, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:42:01,269 - distributed.nanny - WARNING - Restarting worker
[dgx13:79898:0:79898] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  79898) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fa299fcb15d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b354) [0x7fa299fcb354]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b51a) [0x7fa299fcb51a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fa33e5a0420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fa2ac04b2f7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fa2ac073b2d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2077f) [0x7fa299f8477f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23958) [0x7fa299f87958]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fa299fd48a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fa299f86a6d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fa2ac0481fa]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fa2ac10e5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55a87c2406fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55a87c23c094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a87c24d519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87c23d5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55a87c2f0162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7fa2bf0521e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55a87c24577c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55a87c1f7d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55a87c2447f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55a87c242929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a87c24d7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87c23d5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a87c24d7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87c23d5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a87c24d7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87c23d5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a87c24d7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87c23d5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55a87c23c094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a87c24d519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55a87c23e128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55a87c23c094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55a87c25accb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55a87c25b44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55a87c31e10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55a87c24577c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55a87c2406fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a87c24d7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55a87c25adac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55a87c2406fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a87c24d7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87c23d5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55a87c23c094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a87c24d519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87c23d5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55a87c24d7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55a87c23d312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55a87c23c094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a87c24d519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55a87c23e128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55a87c23c094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55a87c23bd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55a87c23bd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55a87c2e907b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55a87c315fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55a87c312353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55a87c30a16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55a87c30a05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55a87c309297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55a87c2dcf07]
=================================
[dgx13:79998:0:79998] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  79998) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd28c67c15d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b354) [0x7fd28c67c354]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b51a) [0x7fd28c67c51a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd32cc60420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fd28c6fc2f7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fd28c724b2d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2077f) [0x7fd28c63577f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23958) [0x7fd28c638958]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd28c6858a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd28c637a6d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd28c6f91fa]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fd28c7bf5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55fa6e7636fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55fa6e75f094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55fa6e770519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fa6e7605c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55fa6e813162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7fd3200681e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55fa6e76877c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55fa6e71ad05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55fa6e7677f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55fa6e765929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fa6e7707c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fa6e7605c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fa6e7707c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fa6e7605c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fa6e7707c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fa6e7605c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fa6e7707c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fa6e7605c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55fa6e75f094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55fa6e770519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55fa6e761128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55fa6e75f094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55fa6e77dccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55fa6e77e44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55fa6e84110e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55fa6e76877c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55fa6e7636fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fa6e7707c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55fa6e77ddac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55fa6e7636fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fa6e7707c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fa6e7605c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55fa6e75f094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55fa6e770519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fa6e7605c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fa6e7707c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55fa6e760312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55fa6e75f094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55fa6e770519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55fa6e761128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55fa6e75f094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55fa6e75ed68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55fa6e75ed19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55fa6e80c07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55fa6e838fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55fa6e835353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55fa6e82d16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55fa6e82d05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55fa6e82c297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55fa6e7fff07]
=================================
2023-09-16 07:42:04,372 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48625 -> ucx://127.0.0.1:47103
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f2eb8f1a240, tag: 0xfbc76f5b10868f92, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:42:04,372 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:47103
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f0460185340, tag: 0xefd7432e1d23ce0e, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f0460185340, tag: 0xefd7432e1d23ce0e, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:42:04,372 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44391 -> ucx://127.0.0.1:47103
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fbf1429a240, tag: 0xb882aed0de56044e, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:42:04,373 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:47103
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f2eb8f1a1c0, tag: 0xf24a542d71ffe568, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f2eb8f1a1c0, tag: 0xf24a542d71ffe568, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-09-16 07:42:04,373 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:47103
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fbf1429a280, tag: 0x939d93875587c5e2, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fbf1429a280, tag: 0x939d93875587c5e2, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:42:04,374 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44391 -> ucx://127.0.0.1:41247
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #057] ep: 0x7fbf1429a100, tag: 0x87f364bea7a5f4b1, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:42:04,374 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:60383 -> ucx://127.0.0.1:41247
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #056] ep: 0x7f0460185100, tag: 0xd3f5af18bd006b75, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:42:04,448 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:42:04,515 - distributed.nanny - WARNING - Restarting worker
[dgx13:79719:0:79719] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  79719) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f2eb918815d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b354) [0x7f2eb9188354]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2b51a) [0x7f2eb918851a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f2f5d904420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f2eb92082f7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f2eb9230b2d]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2077f) [0x7f2eb914177f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23958) [0x7f2eb9144958]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f2eb91918a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f2eb9143a6d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f2eb92051fa]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f2eb92cb5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55d92f90f6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55d92f90b094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d92f91c519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92f90c5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55d92f9bf162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f2ede3b71e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55d92f91477c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55d92f8c6d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55d92f9137f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55d92f911929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d92f91c7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92f90c5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d92f91c7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92f90c5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d92f91c7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92f90c5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d92f91c7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92f90c5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55d92f90b094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d92f91c519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55d92f90d128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55d92f90b094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55d92f929ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55d92f92a44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55d92f9ed10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55d92f91477c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55d92f90f6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d92f91c7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55d92f929dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55d92f90f6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d92f91c7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92f90c5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55d92f90b094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d92f91c519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d92f90c5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d92f91c7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55d92f90c312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55d92f90b094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d92f91c519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55d92f90d128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55d92f90b094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55d92f90ad68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55d92f90ad19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55d92f9b807b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55d92f9e4fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55d92f9e1353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55d92f9d916a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55d92f9d905c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55d92f9d8297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55d92f9abf07]
=================================
2023-09-16 07:42:05,251 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38653 -> ucx://127.0.0.1:48625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f9c18c3e100, tag: 0xadc6ffe95e48d696, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:42:05,273 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:40407 -> ucx://127.0.0.1:48625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fada48a7280, tag: 0x59846495cc99609c, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:42:05,276 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fada48a7180, tag: 0x5e881be905a20456, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fada48a7180, tag: 0x5e881be905a20456, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:42:05,346 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:42:05,568 - distributed.worker - WARNING - Compute Failed
Key:       ('sort_index-86563d3c54ed11bf71e0c240596313fc', 3)
Function:  subgraph_callable-6efab05f-224b-42de-93ef-1a59a4fe
args:      ('set_index_post_scalar-ceb9308523ab39bbcf59f6dccd678d89',                 key  shuffle   payload  _partitions
0             19013        3  90886709            3
1             19021        3  78418612            3
2             19037        3  17251187            3
3             19168        3  13866438            3
4             19175        3  86924029            3
...             ...      ...       ...          ...
99999995  799981674        3  42818475            3
99999996  799981677        3   8722248            3
99999997  799981635        3  69843397            3
99999998  799981644        3  30850753            3
99999999  799981662        3  82585856            3

[100000000 rows x 4 columns], 'simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e')
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-09-16 07:42:05,696 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 5)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0            19017        5  41527465            5
1            19024        5  49756287            5
2            19032        5  20173484            5
3            19036        5  10066580            5
4            19174        5   6887559            5
...            ...      ...       ...          ...
12499995  99994095        5  84574658            5
12499996  99994097        5  67491245            5
12499997  99994100        5  98504231            5
12499998  99994102        5   2417987            5
12499999  99994111        5  95035870            5

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100103011        5   2623343            5
1         100103012        5  91393743            5
2         100103015        5  49380949            5
3         100093888        5  68621060            5
4         100093892        5  54901723            5
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-09-16 07:42:05,722 - distributed.worker - WARNING - Compute Failed
Key:       ('generate-data-5366301a596b755bb8c33997d3ce7726', 6)
Function:  generate_chunk
args:      (6, 100000000, 8, 'build', 0.3, True)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-09-16 07:42:05,761 - distributed.core - ERROR - std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 377, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 378, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
2023-09-16 07:42:05,761 - distributed.worker - ERROR - std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 377, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 378, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
2023-09-16 07:42:05,794 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:38653
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #008] ep: 0x7f0460185280, tag: 0x575eb53ae6732fc4, nbytes: 175, type: <class 'numpy.ndarray'>>: Message truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #008] ep: 0x7f0460185280, tag: 0x575eb53ae6732fc4, nbytes: 175, type: <class 'numpy.ndarray'>>: Message truncated")
2023-09-16 07:42:05,794 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38653 -> ucx://127.0.0.1:60383
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #009] ep: 0x7f9c18c3e100, tag: 0x575eb53ae6732fc4, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
[1694850126.034691] [dgx13:79723:0]    cuda_copy_md.c:261  UCX  ERROR   cuMemAlloc_v2((CUdeviceptr*)address_p, *length_p) failed: out of memory
[1694850126.034712] [dgx13:79723:0]         uct_mem.c:155  UCX  ERROR   failed to allocate 536870912 bytes using md cuda_cpy for ucp_rndv_frags: Input/output error
[1694850126.034717] [dgx13:79723:0]           mpool.c:269  UCX  ERROR Failed to allocate memory pool (name=ucp_rndv_frags) chunk: Out of memory
[dgx13:79723:0:79723]        rndv.c:1360 Fatal: failed to allocate fragment memory buffer
==== backtrace (tid:  79723) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f046044115d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0x51) [0x7f046043ed11]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x28eac) [0x7f046043eeac]
 3  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_receive+0x134d) [0x7f04604edced]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nbx+0xafb) [0x7f046050239b]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nb+0x57) [0x7f0460502717]
 6  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x66839) [0x7f04605b0839]
 7  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x564810ee144c]
 8  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564810ec66fb]
 9  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564810ec2094]
10  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564810ed3519]
11  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x564810ec4128]
12  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564810ec2094]
13  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564810ed3519]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x564810ec4128]
15  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x564810f76162]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x564810ec8e64]
17  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x564810f76162]
18  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x564810ec8e64]
19  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x564810f76162]
20  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x564810ec8e64]
21  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x564810f76162]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x564810ec8e64]
23  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x564810f76162]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x564810ec8e64]
25  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x564810f76162]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x564810ec8e64]
27  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x564810f76162]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x564810ec8e64]
29  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x564810f76162]
30  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f04734e61e9]
31  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x8aa6) [0x7f04734e6aa6]
32  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x564810ecb77c]
33  /opt/conda/envs/gdf/bin/python(+0xead05) [0x564810e7dd05]
34  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x564810eca7f3]
35  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x564810ec8929]
36  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564810ed37c2]
37  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564810ec35c6]
38  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564810ed37c2]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564810ec35c6]
40  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564810ed37c2]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564810ec35c6]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564810ed37c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564810ec35c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564810ec2094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564810ed3519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x564810ec4128]
47  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564810ec2094]
48  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x564810ee0ccb]
49  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x564810ee144c]
50  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x564810fa410e]
51  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x564810ecb77c]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564810ec66fb]
53  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564810ed37c2]
54  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x564810ee0dac]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x564810ec66fb]
56  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564810ed37c2]
57  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564810ec35c6]
58  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x564810ec2094]
59  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x564810ed3519]
60  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x564810ec35c6]
61  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x564810ed37c2]
=================================
2023-09-16 07:42:06,285 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38653 -> ucx://127.0.0.1:60383
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f9c18c3e100, tag: 0x92c28fa06c67a2eb, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:42:06,540 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:42:30,795 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53681
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 490, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 492, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 368, in connect
    raise OSError(
OSError: Timed out trying to connect to ucx://127.0.0.1:53681 after 30 s
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 36 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
