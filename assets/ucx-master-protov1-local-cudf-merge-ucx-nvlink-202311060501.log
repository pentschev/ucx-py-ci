[dgx13:65171:0:65171] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  65171) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fcaa360806d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7fcaa3608264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7fcaa360842a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fcb4477b420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fcaa36866a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fcaa36af829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7fcaa35c246f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7fcaa35c58c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fcaa3611499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fcaa35c466d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fcaa36838ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fcaa373c06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55d89a4bc6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55d89a4b8094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d89a4c9519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d89a4b95c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55d89a56c162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7fcac48f91e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55d89a4c177c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55d89a473d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55d89a4c07f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55d89a4be929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d89a4c97c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d89a4b95c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d89a4c97c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d89a4b95c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d89a4c97c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d89a4b95c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d89a4c97c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d89a4b95c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55d89a4b8094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d89a4c9519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55d89a4ba128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55d89a4b8094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55d89a4d6ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55d89a4d744c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55d89a59a10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55d89a4c177c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55d89a4bc6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d89a4c97c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55d89a4d6dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55d89a4bc6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d89a4c97c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d89a4b95c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55d89a4b8094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d89a4c9519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d89a4b95c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55d89a4c97c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55d89a4b9312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55d89a4b8094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d89a4c9519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55d89a4ba128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55d89a4b8094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55d89a4b7d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55d89a4b7d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55d89a56507b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55d89a591fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55d89a58e353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55d89a58616a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55d89a58605c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55d89a585297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55d89a558f07]
=================================
Task exception was never retrieved
future: <Task finished name='Task-734' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-11-06 06:02:35,242 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:41087 -> ucx://127.0.0.1:39467
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3ac0115100, tag: 0x2f7d280456ee02cf, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
Task exception was never retrieved
future: <Task finished name='Task-728' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
[dgx13:65174:0:65174] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  65174) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f1d8976f06d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f1d8976f264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f1d8976f42a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f1e2e8d1420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f1d897ed6a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f1d89816829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f1d8972946f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f1d8972c8c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f1d89778499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f1d8972b66d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f1d897ea8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f1d898a306a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56040c7fa6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56040c7f6094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56040c807519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56040c7f75c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56040c8077c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x56040c814e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x56040c91fb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x56040c7b1d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x56040c7fe7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x56040c7fc929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56040c8077c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56040c7f75c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56040c8077c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56040c7f75c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56040c8077c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56040c7f75c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56040c8077c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56040c7f75c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56040c7f6094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56040c807519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56040c7f8128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56040c7f6094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x56040c814ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56040c81544c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x56040c8d810e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56040c7ff77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56040c7fa6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56040c8077c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x56040c814dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56040c7fa6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56040c8077c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56040c7f75c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56040c7f6094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56040c807519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56040c7f75c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56040c8077c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x56040c7f7312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56040c7f6094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56040c807519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56040c7f8128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56040c7f6094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x56040c7f5d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56040c7f5d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56040c8a307b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x56040c8cffca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x56040c8cc353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x56040c8c416a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x56040c8c405c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x56040c8c3297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x56040c896f07]
=================================
[dgx13:65162:0:65162] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
[dgx13:65177:0:65177] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  65162) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fab2373306d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7fab23733264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7fab2373342a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fabc487f420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fab237b16a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fab237da829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7fab236ed46f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7fab236f08c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fab2373c499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fab236ef66d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fab237ae8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fab2386706a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55c8afbe06fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c8afbdc094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c8afbed519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c8afbdd5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55c8afc90162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7fabb80121e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55c8afbe577c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55c8afb97d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55c8afbe47f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55c8afbe2929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c8afbed7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c8afbdd5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c8afbed7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c8afbdd5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c8afbed7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c8afbdd5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c8afbed7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c8afbdd5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c8afbdc094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c8afbed519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55c8afbde128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c8afbdc094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55c8afbfaccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55c8afbfb44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55c8afcbe10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55c8afbe577c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55c8afbe06fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c8afbed7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55c8afbfadac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55c8afbe06fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c8afbed7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c8afbdd5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c8afbdc094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c8afbed519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c8afbdd5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c8afbed7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55c8afbdd312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c8afbdc094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c8afbed519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55c8afbde128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c8afbdc094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55c8afbdbd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55c8afbdbd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55c8afc8907b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55c8afcb5fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55c8afcb2353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55c8afcaa16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55c8afcaa05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55c8afca9297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55c8afc7cf07]
=================================
==== backtrace (tid:  65177) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f8754b8906d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f8754b89264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f8754b8942a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f87e7ce2420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f8754c076a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f8754c30829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f8754b4346f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f8754b468c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f8754b92499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f8754b4566d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f8754c048ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f8754cbd06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55acf32e36fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55acf32df094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55acf32f0519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55acf32e05c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55acf3393162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f8767e621e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55acf32e877c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55acf329ad05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55acf32e77f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55acf32e5929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55acf32f07c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55acf32e05c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55acf32f07c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55acf32e05c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55acf32f07c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55acf32e05c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55acf32f07c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55acf32e05c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55acf32df094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55acf32f0519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55acf32e1128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55acf32df094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55acf32fdccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55acf32fe44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55acf33c110e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55acf32e877c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55acf32e36fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55acf32f07c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55acf32fddac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55acf32e36fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55acf32f07c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55acf32e05c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55acf32df094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55acf32f0519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55acf32e05c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55acf32f07c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55acf32e0312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55acf32df094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55acf32f0519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55acf32e1128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55acf32df094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55acf32ded68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55acf32ded19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55acf338c07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55acf33b8fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55acf33b5353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55acf33ad16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55acf33ad05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55acf33ac297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55acf337ff07]
=================================
[dgx13:65158:0:65158] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  65158) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f62d026d06d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f62d026d264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f62d026d42a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f63633bf420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f62d02eb6a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f62d0314829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f62d022746f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f62d022a8c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f62d0276499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f62d022966d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f62d02e88ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f62d03a106a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55f159c726fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f159c6e094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f159c7f519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f159c6f5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f159c7f7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55f159c8ce83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55f159d97b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55f159c29d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55f159c767f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55f159c74929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f159c7f7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f159c6f5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f159c7f7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f159c6f5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f159c7f7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f159c6f5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f159c7f7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f159c6f5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f159c6e094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f159c7f519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55f159c70128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f159c6e094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55f159c8cccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55f159c8d44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55f159d5010e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55f159c7777c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55f159c726fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f159c7f7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55f159c8cdac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55f159c726fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f159c7f7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f159c6f5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f159c6e094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f159c7f519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55f159c6f5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55f159c7f7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55f159c6f312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f159c6e094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55f159c7f519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55f159c70128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55f159c6e094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55f159c6dd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55f159c6dd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55f159d1b07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55f159d47fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55f159d44353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55f159d3c16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55f159d3c05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55f159d3b297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55f159d0ef07]
=================================
[dgx13:65165:0:65165] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  65165) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f3ac040a06d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f3ac040a264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f3ac040a42a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f3b61400420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f3ac04886a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f3ac04b1829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f3ac03c446f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f3ac03c78c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f3ac0413499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f3ac03c666d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f3ac04858ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f3ac053e06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x563cd1c0a6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x563cd1c06094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563cd1c17519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563cd1c075c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563cd1c177c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x563cd1c24e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x563cd1d2fb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x563cd1bc1d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x563cd1c0e7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x563cd1c0c929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563cd1c177c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563cd1c075c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563cd1c177c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563cd1c075c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563cd1c177c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563cd1c075c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563cd1c177c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563cd1c075c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x563cd1c06094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563cd1c17519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x563cd1c08128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x563cd1c06094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x563cd1c24ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x563cd1c2544c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x563cd1ce810e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x563cd1c0f77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x563cd1c0a6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563cd1c177c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x563cd1c24dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x563cd1c0a6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563cd1c177c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563cd1c075c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x563cd1c06094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563cd1c17519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563cd1c075c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x563cd1c177c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x563cd1c07312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x563cd1c06094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563cd1c17519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x563cd1c08128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x563cd1c06094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x563cd1c05d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x563cd1c05d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x563cd1cb307b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x563cd1cdffca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x563cd1cdc353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x563cd1cd416a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x563cd1cd405c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x563cd1cd3297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x563cd1ca6f07]
=================================
2023-11-06 06:02:39,270 - distributed.nanny - WARNING - Restarting worker
2023-11-06 06:02:58,939 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59707 -> ucx://127.0.0.1:41087
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1036b7f380, tag: 0x61c19ce09886d8bf, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-06 06:02:58,941 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41087
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f1036b7f1c0, tag: 0xd1d3c7824b7c6b4, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f1036b7f1c0, tag: 0xd1d3c7824b7c6b4, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-06 06:02:58,939 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41087
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7efd18412180, tag: 0x6db184ece4059c3a, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7efd18412180, tag: 0x6db184ece4059c3a, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-11-06 06:02:58,945 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41087
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-11-06 06:02:59,005 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:32963 -> ucx://127.0.0.1:36243
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7efd184123c0, tag: 0xf16a2f89177dd88c, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-06 06:02:59,005 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36243
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f1036b7f100, tag: 0x2b564a1362f437f5, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f1036b7f100, tag: 0x2b564a1362f437f5, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-06 06:02:59,006 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36243
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7efd184121c0, tag: 0x50a32278cb5852bf, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7efd184121c0, tag: 0x50a32278cb5852bf, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-11-06 06:02:59,009 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36243
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-11-06 06:02:59,010 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35167
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f1036b7f140, tag: 0x3cf25ff6338298db, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f1036b7f140, tag: 0x3cf25ff6338298db, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-11-06 06:02:59,011 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59707 -> ucx://127.0.0.1:35167
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1036b7f280, tag: 0xd53edf6e4fea4ccd, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
Task exception was never retrieved
future: <Task finished name='Task-1242' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-11-06 06:02:59,015 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35167
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-11-06 06:02:59,063 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:56495
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-11-06 06:02:59,070 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:56495
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: CancelledError()
2023-11-06 06:02:59,092 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59707 -> ucx://127.0.0.1:56495
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1036b7f2c0, tag: 0xcc1610be10c8a243, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-06 06:02:59,093 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:56495
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f1036b7f200, tag: 0xce64feb2dad9c7c1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f1036b7f200, tag: 0xce64feb2dad9c7c1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-11-06 06:02:59,935 - distributed.nanny - WARNING - Restarting worker
2023-11-06 06:03:00,153 - distributed.nanny - WARNING - Restarting worker
2023-11-06 06:03:00,270 - distributed.nanny - WARNING - Restarting worker
2023-11-06 06:03:00,466 - distributed.nanny - WARNING - Restarting worker
2023-11-06 06:03:01,031 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49367
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7efd18412200, tag: 0x3fe00643afdf42b7, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7efd18412200, tag: 0x3fe00643afdf42b7, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-06 06:03:01,031 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49367
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f1036b7f180, tag: 0x19d5c341efbfeb71, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f1036b7f180, tag: 0x19d5c341efbfeb71, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-11-06 06:03:01,036 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49367
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
[dgx13:65326:0:65326] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  65326) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7faf6002b06d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7faf6002b264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7faf6002b42a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7faff2f45420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7faf4df7c6a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7faf4dfa5829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7faf4df1646f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7faf4df198c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7faf60034499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7faf4df1866d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7faf4df798ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7faf6009106a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559e7ded16fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559e7decd094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559e7dede519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559e7dece5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x559e7df81162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7faf730c81e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559e7ded677c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x559e7de88d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x559e7ded57f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x559e7ded3929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559e7dede7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559e7dece5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559e7dede7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559e7dece5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559e7dede7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559e7dece5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559e7dede7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559e7dece5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559e7decd094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559e7dede519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x559e7decf128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559e7decd094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x559e7deebccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x559e7deec44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x559e7dfaf10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559e7ded677c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559e7ded16fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559e7dede7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x559e7deebdac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559e7ded16fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559e7dede7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559e7dece5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559e7decd094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559e7dede519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559e7dece5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559e7dede7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x559e7dece312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559e7decd094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559e7dede519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x559e7decf128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559e7decd094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x559e7deccd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559e7deccd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x559e7df7a07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x559e7dfa6fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x559e7dfa3353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x559e7df9b16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x559e7df9b05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x559e7df9a297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x559e7df6df07]
=================================
2023-11-06 06:03:02,954 - distributed.nanny - WARNING - Restarting worker
[dgx13:65354:0:65354] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  65354) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fe8933bb06d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7fe8933bb264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7fe8933bb42a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fe93439c420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fe8934396a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fe893462829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7fe89337546f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7fe8933788c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fe8933c4499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fe89337766d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fe8934368ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fe8934ef06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x558ff23c36fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558ff23bf094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558ff23d0519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558ff23c05c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558ff23d07c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x558ff23dde83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x558ff24e8b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x558ff237ad05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x558ff23c77f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x558ff23c5929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558ff23d07c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558ff23c05c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558ff23d07c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558ff23c05c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558ff23d07c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558ff23c05c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558ff23d07c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558ff23c05c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558ff23bf094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558ff23d0519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x558ff23c1128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558ff23bf094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x558ff23ddccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x558ff23de44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x558ff24a110e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x558ff23c877c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x558ff23c36fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558ff23d07c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x558ff23dddac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x558ff23c36fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558ff23d07c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558ff23c05c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558ff23bf094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558ff23d0519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558ff23c05c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558ff23d07c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x558ff23c0312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558ff23bf094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558ff23d0519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x558ff23c1128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558ff23bf094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x558ff23bed68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x558ff23bed19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x558ff246c07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x558ff2498fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x558ff2495353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x558ff248d16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x558ff248d05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x558ff248c297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x558ff245ff07]
=================================
2023-11-06 06:03:05,265 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59707 -> ucx://127.0.0.1:56299
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1036b7f180, tag: 0xd1d170e3b3c48314, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-06 06:03:05,417 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35167
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 490, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 492, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 368, in connect
    raise OSError(
OSError: Timed out trying to connect to ucx://127.0.0.1:35167 after 30 s
2023-11-06 06:03:06,464 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:33295
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7efd18412200, tag: 0xfe62a70e89799c05, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7efd18412200, tag: 0xfe62a70e89799c05, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-11-06 06:03:06,466 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:32963 -> ucx://127.0.0.1:33295
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7efd184122c0, tag: 0x7cfa341ed04bf385, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-06 06:03:06,470 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:33295
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #017] ep: 0x7f1036b7f200, tag: 0x3fafd856e3dbd72c, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #017] ep: 0x7f1036b7f200, tag: 0x3fafd856e3dbd72c, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-11-06 06:03:06,473 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:33295
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
[dgx13:65393:0:65393] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  65393) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f2a68aaf06d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f2a68aaf264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f2a68aaf42a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f2b09acb420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f2a68b2d6a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f2a68b56829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f2a68a6946f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f2a68a6c8c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f2a68ab8499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f2a68a6b66d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f2a68b2a8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f2a68be306a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55bb36ce06fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55bb36cdc094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55bb36ced519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bb36cdd5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bb36ced7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55bb36cfae83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55bb36e05b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55bb36c97d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55bb36ce47f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55bb36ce2929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bb36ced7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bb36cdd5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bb36ced7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bb36cdd5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bb36ced7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bb36cdd5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bb36ced7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bb36cdd5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55bb36cdc094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55bb36ced519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55bb36cde128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55bb36cdc094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55bb36cfaccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55bb36cfb44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55bb36dbe10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55bb36ce577c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55bb36ce06fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bb36ced7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55bb36cfadac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55bb36ce06fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bb36ced7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bb36cdd5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55bb36cdc094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55bb36ced519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55bb36cdd5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55bb36ced7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55bb36cdd312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55bb36cdc094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55bb36ced519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55bb36cde128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55bb36cdc094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55bb36cdbd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55bb36cdbd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55bb36d8907b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55bb36db5fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55bb36db2353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55bb36daa16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55bb36daa05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55bb36da9297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55bb36d7cf07]
=================================
[dgx13:65347:0:65347] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  65347) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f26a77a306d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f26a77a3264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f26a77a342a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f27607a4420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f26a78216a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f26a784a829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f26a775d46f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f26a77608c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f26a77ac499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f26a775f66d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f26a781e8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f26a78d706a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55965b3b56fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55965b3b1094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55965b3c2519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55965b3b25c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55965b3c27c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55965b3cfe83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55965b4dab2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55965b36cd05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55965b3b97f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55965b3b7929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55965b3c27c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55965b3b25c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55965b3c27c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55965b3b25c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55965b3c27c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55965b3b25c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55965b3c27c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55965b3b25c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55965b3b1094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55965b3c2519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55965b3b3128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55965b3b1094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55965b3cfccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55965b3d044c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55965b49310e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55965b3ba77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55965b3b56fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55965b3c27c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55965b3cfdac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55965b3b56fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55965b3c27c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55965b3b25c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55965b3b1094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55965b3c2519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55965b3b25c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55965b3c27c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55965b3b2312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55965b3b1094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55965b3c2519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55965b3b3128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55965b3b1094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55965b3b0d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55965b3b0d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55965b45e07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55965b48afca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55965b487353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55965b47f16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55965b47f05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55965b47e297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55965b451f07]
=================================
2023-11-06 06:03:09,563 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:32963 -> ucx://127.0.0.1:34609
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7efd18412140, tag: 0x3fb63218fce5da4b, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-06 06:03:09,564 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:34609
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7efd18412200, tag: 0x1bd604b27a86bcc1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7efd18412200, tag: 0x1bd604b27a86bcc1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-11-06 06:03:09,565 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:34609
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f1036b7f200, tag: 0x4636d1337f9b38f8, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f1036b7f200, tag: 0x4636d1337f9b38f8, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-11-06 06:03:09,567 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:34609
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-11-06 06:03:09,637 - distributed.nanny - WARNING - Restarting worker
2023-11-06 06:03:09,642 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59707 -> ucx://127.0.0.1:44419
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1036b7f2c0, tag: 0x1e8163f71cc0a74a, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-06 06:03:09,710 - distributed.nanny - WARNING - Restarting worker
[dgx13:65351:0:65351] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  65351) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f3dfd04906d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f3dfd049264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f3dfd04942a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f3e90031420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f3dfd0c76a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f3dfd0f0829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f3dfd00346f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f3dfd0068c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f3dfd052499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f3dfd00566d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f3dfd0c48ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f3dfd17d06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559f81eed6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559f81ee9094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559f81efa519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f81eea5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x559f81f9d162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f3e101b31e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559f81ef277c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x559f81ea4d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x559f81ef17f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x559f81eef929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559f81efa7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f81eea5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559f81efa7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f81eea5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559f81efa7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f81eea5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559f81efa7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f81eea5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559f81ee9094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559f81efa519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x559f81eeb128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559f81ee9094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x559f81f07ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x559f81f0844c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x559f81fcb10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559f81ef277c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559f81eed6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559f81efa7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x559f81f07dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559f81eed6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559f81efa7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f81eea5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559f81ee9094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559f81efa519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f81eea5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559f81efa7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x559f81eea312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559f81ee9094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559f81efa519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x559f81eeb128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559f81ee9094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x559f81ee8d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559f81ee8d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x559f81f9607b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x559f81fc2fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x559f81fbf353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x559f81fb716a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x559f81fb705c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x559f81fb6297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x559f81f89f07]
=================================
[dgx13:65358:0:65358] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  65358) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f70c5bf206d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a264) [0x7f70c5bf2264]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a42a) [0x7f70c5bf242a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f716cbdf420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f70c5c706a4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f70c5c99829]
 6  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x2146f) [0x7f70c5bac46f]
 7  /opt/conda/envs/gdf/lib/./libuct.so.0(+0x248c8) [0x7f70c5baf8c8]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f70c5bfb499]
 9  /opt/conda/envs/gdf/lib/./libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f70c5bae66d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f70c5c6d8ca]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f70c5d2606a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x556ca6ac86fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556ca6ac4094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556ca6ad5519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556ca6ac55c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556ca6ad57c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x556ca6ae2e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x556ca6bedb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x556ca6a7fd05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x556ca6acc7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x556ca6aca929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556ca6ad57c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556ca6ac55c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556ca6ad57c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556ca6ac55c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556ca6ad57c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556ca6ac55c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556ca6ad57c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556ca6ac55c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556ca6ac4094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556ca6ad5519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x556ca6ac6128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556ca6ac4094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x556ca6ae2ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x556ca6ae344c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x556ca6ba610e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x556ca6acd77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x556ca6ac86fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556ca6ad57c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x556ca6ae2dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x556ca6ac86fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556ca6ad57c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556ca6ac55c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556ca6ac4094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556ca6ad5519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556ca6ac55c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556ca6ad57c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x556ca6ac5312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556ca6ac4094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556ca6ad5519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x556ca6ac6128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556ca6ac4094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x556ca6ac3d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x556ca6ac3d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x556ca6b7107b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x556ca6b9dfca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x556ca6b9a353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x556ca6b9216a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x556ca6b9205c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x556ca6b91297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x556ca6b64f07]
=================================
2023-11-06 06:03:10,013 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48761
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #009] ep: 0x7efd184122c0, tag: 0xe56d384cf6b1f6d4, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #009] ep: 0x7efd184122c0, tag: 0xe56d384cf6b1f6d4, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-11-06 06:03:10,014 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59707 -> ucx://127.0.0.1:48761
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1036b7f200, tag: 0x5d4f6dfc76e54b81, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-06 06:03:10,015 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48761
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f1036b7f2c0, tag: 0xb71a7dbdd9a5ec2f, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f1036b7f2c0, tag: 0xb71a7dbdd9a5ec2f, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-06 06:03:10,084 - distributed.nanny - WARNING - Restarting worker
2023-11-06 06:03:10,097 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:32963 -> ucx://127.0.0.1:56637
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7efd18412280, tag: 0x6801ed66acb26714, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-06 06:03:10,152 - distributed.nanny - WARNING - Restarting worker
Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 740, in cupy.cuda.memory.alloc
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/rmm/allocators/cupy.py", line 37, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded
Exception ignored in: 'cupy.cuda.thrust.cupy_malloc'
Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 740, in cupy.cuda.memory.alloc
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/rmm/allocators/cupy.py", line 37, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded
2023-11-06 06:03:10,220 - distributed.worker - WARNING - Compute Failed
Key:       ('generate-data-5366301a596b755bb8c33997d3ce7726', 5)
Function:  generate_chunk
args:      (5, 100000000, 8, 'build', 0.3, True)
kwargs:    {}
Exception: "RuntimeError('radix_sort: failed on 2nd step: cudaErrorInvalidValue: invalid argument')"

Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 740, in cupy.cuda.memory.alloc
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/rmm/allocators/cupy.py", line 37, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded
Exception ignored in: 'cupy.cuda.thrust.cupy_malloc'
Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 740, in cupy.cuda.memory.alloc
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/rmm/allocators/cupy.py", line 37, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded
2023-11-06 06:03:10,240 - distributed.worker - WARNING - Compute Failed
Key:       ('generate-data-3393696d3757f92da87d0dddd0c6ae01', 3)
Function:  generate_chunk
args:      (3, 100000000, 8, 'other', 0.3, True)
kwargs:    {}
Exception: "RuntimeError('radix_sort: failed on 2nd step: cudaErrorInvalidValue: invalid argument')"

2023-11-06 06:03:10,710 - distributed.worker - WARNING - Compute Failed
Key:       ('sort_index-86563d3c54ed11bf71e0c240596313fc', 1)
Function:  subgraph_callable-56f123c7-c61e-4ab3-9710-42353341
args:      ('set_index_post_scalar-ceb9308523ab39bbcf59f6dccd678d89',                 key  shuffle   payload  _partitions
0             69830        1  37245342            1
1             69836        1  67185136            1
2             21121        1   5244390            1
3             69839        1  39150760            1
4             21122        1  53970363            1
...             ...      ...       ...          ...
99999995  799941299        1  45102567            1
99999996  799989851        1  58331816            1
99999997  799996671        1  22440876            1
99999998  799941301        1  45895931            1
99999999  799955507        1   5312365            1

[100000000 rows x 4 columns], 'simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e')
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-06 06:03:10,772 - distributed.worker - WARNING - Compute Failed
Key:       ('sort_index-86563d3c54ed11bf71e0c240596313fc', 0)
Function:  subgraph_callable-56f123c7-c61e-4ab3-9710-42353341
args:      ('set_index_post_scalar-ceb9308523ab39bbcf59f6dccd678d89',                 key  shuffle   payload  _partitions
0             69852        0  97895090            0
1             21120        0  59420103            0
2             21129        0   6388809            0
3             79984        0  23507853            0
4             21133        0   7071988            0
...             ...      ...       ...          ...
99999995  799955528        0  97456203            0
99999996  799955536        0  88371939            0
99999997  799955540        0  63406941            0
99999998  799955544        0  47033208            0
99999999  799955551        0  91503050            0

[100000000 rows x 4 columns], 'simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e')
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-06 06:03:10,844 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 2)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0            69825        2  70680737            2
1            69826        2  97608856            2
2            21131        2  41231417            2
3            69833        2  86270008            2
4            21136        2  14800768            2
...            ...      ...       ...          ...
12499995  99996547        2  47821976            2
12499996  99996549        2  99815716            2
12499997  99996550        2  64629986            2
12499998  99996558        2  73701690            2
12499999  99996565        2  78954977            2

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100018627        2  88096360            2
1         100018634        2  39207622            2
2         100018635        2  10353646            2
3         100018637        2  98586646            2
4         100018638        2  14882094            2
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-06 06:03:10,887 - distributed.worker - WARNING - Compute Failed
Key:       ('sort_index-86563d3c54ed11bf71e0c240596313fc', 4)
Function:  subgraph_callable-56f123c7-c61e-4ab3-9710-42353341
args:      ('set_index_post_scalar-ceb9308523ab39bbcf59f6dccd678d89',                 key  shuffle   payload  _partitions
0             69848        4  61573299            4
1             21135        4  45950601            4
2             21146        4  88460098            4
3             79970        4  29738896            4
4             21149        4  69164154            4
...             ...      ...       ...          ...
99999995  799955537        4  90379790            4
99999996  799955546        4   9726168            4
99999997  799955547        4  91776041            4
99999998  799955549        4  95786391            4
99999999  799955550        4  68985583            4

[100000000 rows x 4 columns], 'simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e')
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-06 06:03:10,919 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 3)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0            69827        3  58671535            3
1            69831        3  79060595            3
2            21132        3  10718512            3
3            69837        3  26432442            3
4            21143        3  53490074            3
...            ...      ...       ...          ...
12499995  99996592        3  96420998            3
12499996  99996602        3  27853156            3
12499997  99996422        3  87366633            3
12499998  99996445        3  39069539            3
12499999  99996567        3   1462523            3

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100018625        3  45914657            3
1         100018649        3  38654940            3
2         100018650        3  11840990            3
3         100018563        3  71482464            3
4         100018567        3  55006804            3
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-06 06:03:10,982 - distributed.worker - WARNING - Compute Failed
Key:       ('sort_index-86563d3c54ed11bf71e0c240596313fc', 5)
Function:  subgraph_callable-56f123c7-c61e-4ab3-9710-42353341
args:      ('set_index_post_scalar-ceb9308523ab39bbcf59f6dccd678d89',                 key  shuffle   payload  _partitions
0             69824        5  79925640            5
1             69842        5   8115096            5
2             21123        5  63887942            5
3             69843        5  22021067            5
4             21137        5  67477661            5
...             ...      ...       ...          ...
99999995  799941294        5  43599441            5
99999996  799941296        5  38093549            5
99999997  799941304        5  65707590            5
99999998  799955524        5  41299614            5
99999999  799955530        5  15463909            5

[100000000 rows x 4 columns], 'simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e')
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-06 06:03:11,068 - distributed.worker - ERROR - 
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
asyncio.exceptions.CancelledError
2023-11-06 06:03:11,068 - distributed.worker - ERROR - 
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
asyncio.exceptions.CancelledError
2023-11-06 06:03:11,069 - distributed.worker - ERROR - 
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
asyncio.exceptions.CancelledError
2023-11-06 06:03:11,069 - distributed.worker - ERROR - 
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
asyncio.exceptions.CancelledError
2023-11-06 06:03:11,070 - distributed.worker - ERROR - 
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
asyncio.exceptions.CancelledError
2023-11-06 06:03:11,071 - distributed.worker - ERROR - 
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
asyncio.exceptions.CancelledError
[1699250591.092599] [dgx13:65153:0]           mpool.c:54   UCX  WARN  object 0x564476ef4000 {{cb|snd_tag|rk_use} send length 100000000 ucp_proto_progress_tag_rndv_rts() comp:???()cuda memory} was not returned to mpool ucp_requests
[1699250591.092613] [dgx13:65153:0]           mpool.c:54   UCX  WARN  object 0x564476ef7fc0 {{cb|snd_tag|rk_use} send length 100000000 ucp_proto_progress_tag_rndv_rts() comp:???()cuda memory} was not returned to mpool ucp_requests
[1699250591.094963] [dgx13:65169:0]           mpool.c:54   UCX  WARN  object 0x55b013c85940 {{cb|snd_tag|rk_use} send length 100000000 ucp_proto_progress_tag_rndv_rts() comp:???()cuda memory} was not returned to mpool ucp_requests
[1699250591.094977] [dgx13:65169:0]           mpool.c:54   UCX  WARN  object 0x55b013c89b80 {{cb|snd_tag|rk_use} send length 100000000 ucp_proto_progress_tag_rndv_rts() comp:???()cuda memory} was not returned to mpool ucp_requests
[1699250591.094982] [dgx13:65169:0]           mpool.c:54   UCX  WARN  object 0x55b013c8e180 {{cb|snd_tag|rk_use} send length 50000000 ucp_proto_progress_tag_rndv_rts() comp:???()cuda memory} was not returned to mpool ucp_requests
[1699250591.094985] [dgx13:65169:0]           mpool.c:54   UCX  WARN  object 0x55b013c8ecc0 {{cb|snd_tag|rk_use} send length 100000000 ucp_proto_progress_tag_rndv_rts() comp:???()cuda memory} was not returned to mpool ucp_requests
2023-11-06 06:03:11,478 - distributed.nanny - ERROR - Failed to initialize worker
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 940, in run
    worker = worker_factory()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 718, in __init__
    ServerNode.__init__(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 363, in __init__
    self._workdir = self._workspace.new_work_dir(prefix=f"{name}-")
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 274, in new_work_dir
    return WorkDir(self, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 49, in __init__
    self.dir_path = tempfile.mkdtemp(prefix=prefix, dir=workspace.base_dir)
  File "/opt/conda/envs/gdf/lib/python3.9/tempfile.py", line 363, in mkdtemp
    _os.mkdir(file, 0o700)
OSError: [Errno 28] No space left on device: '/tmp/dask-scratch-space/worker-vbpfaei5'
2023-11-06 06:03:11,507 - distributed.nanny - ERROR - Failed to start process
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 448, in instantiate
    result = await self.process.start()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 748, in start
    msg = await self._wait_until_connected(uid)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 889, in _wait_until_connected
    raise msg["exception"]
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 940, in run
    worker = worker_factory()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 718, in __init__
    ServerNode.__init__(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 363, in __init__
    self._workdir = self._workspace.new_work_dir(prefix=f"{name}-")
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 274, in new_work_dir
    return WorkDir(self, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 49, in __init__
    self.dir_path = tempfile.mkdtemp(prefix=prefix, dir=workspace.base_dir)
  File "/opt/conda/envs/gdf/lib/python3.9/tempfile.py", line 363, in mkdtemp
    _os.mkdir(file, 0o700)
OSError: [Errno 28] No space left on device: '/tmp/dask-scratch-space/worker-vbpfaei5'
2023-11-06 06:03:11,773 - distributed.nanny - ERROR - Failed to initialize worker
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 940, in run
    worker = worker_factory()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 718, in __init__
    ServerNode.__init__(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 363, in __init__
    self._workdir = self._workspace.new_work_dir(prefix=f"{name}-")
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 274, in new_work_dir
    return WorkDir(self, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 49, in __init__
    self.dir_path = tempfile.mkdtemp(prefix=prefix, dir=workspace.base_dir)
  File "/opt/conda/envs/gdf/lib/python3.9/tempfile.py", line 363, in mkdtemp
    _os.mkdir(file, 0o700)
OSError: [Errno 28] No space left on device: '/tmp/dask-scratch-space/worker-2ixgx5wg'
2023-11-06 06:03:11,812 - distributed.nanny - ERROR - Failed to start process
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 448, in instantiate
    result = await self.process.start()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 748, in start
    msg = await self._wait_until_connected(uid)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 889, in _wait_until_connected
    raise msg["exception"]
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 940, in run
    worker = worker_factory()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 718, in __init__
    ServerNode.__init__(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 363, in __init__
    self._workdir = self._workspace.new_work_dir(prefix=f"{name}-")
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 274, in new_work_dir
    return WorkDir(self, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 49, in __init__
    self.dir_path = tempfile.mkdtemp(prefix=prefix, dir=workspace.base_dir)
  File "/opt/conda/envs/gdf/lib/python3.9/tempfile.py", line 363, in mkdtemp
    _os.mkdir(file, 0o700)
OSError: [Errno 28] No space left on device: '/tmp/dask-scratch-space/worker-2ixgx5wg'
2023-11-06 06:03:11,883 - distributed.nanny - ERROR - Failed to initialize worker
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 940, in run
    worker = worker_factory()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 718, in __init__
    ServerNode.__init__(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 363, in __init__
    self._workdir = self._workspace.new_work_dir(prefix=f"{name}-")
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 274, in new_work_dir
    return WorkDir(self, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 49, in __init__
    self.dir_path = tempfile.mkdtemp(prefix=prefix, dir=workspace.base_dir)
  File "/opt/conda/envs/gdf/lib/python3.9/tempfile.py", line 363, in mkdtemp
    _os.mkdir(file, 0o700)
OSError: [Errno 28] No space left on device: '/tmp/dask-scratch-space/worker-_akxibni'
2023-11-06 06:03:11,915 - distributed.nanny - ERROR - Failed to start process
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 448, in instantiate
    result = await self.process.start()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 748, in start
    msg = await self._wait_until_connected(uid)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 889, in _wait_until_connected
    raise msg["exception"]
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 940, in run
    worker = worker_factory()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 718, in __init__
    ServerNode.__init__(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 363, in __init__
    self._workdir = self._workspace.new_work_dir(prefix=f"{name}-")
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 274, in new_work_dir
    return WorkDir(self, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 49, in __init__
    self.dir_path = tempfile.mkdtemp(prefix=prefix, dir=workspace.base_dir)
  File "/opt/conda/envs/gdf/lib/python3.9/tempfile.py", line 363, in mkdtemp
    _os.mkdir(file, 0o700)
OSError: [Errno 28] No space left on device: '/tmp/dask-scratch-space/worker-_akxibni'
2023-11-06 06:03:11,931 - distributed.nanny - ERROR - Failed to initialize worker
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 940, in run
    worker = worker_factory()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 718, in __init__
    ServerNode.__init__(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 363, in __init__
    self._workdir = self._workspace.new_work_dir(prefix=f"{name}-")
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 274, in new_work_dir
    return WorkDir(self, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 49, in __init__
    self.dir_path = tempfile.mkdtemp(prefix=prefix, dir=workspace.base_dir)
  File "/opt/conda/envs/gdf/lib/python3.9/tempfile.py", line 363, in mkdtemp
    _os.mkdir(file, 0o700)
OSError: [Errno 28] No space left on device: '/tmp/dask-scratch-space/worker-plels7wv'
2023-11-06 06:03:11,973 - distributed.nanny - ERROR - Failed to start process
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 448, in instantiate
    result = await self.process.start()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 748, in start
    msg = await self._wait_until_connected(uid)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 889, in _wait_until_connected
    raise msg["exception"]
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/nanny.py", line 940, in run
    worker = worker_factory()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 718, in __init__
    ServerNode.__init__(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 363, in __init__
    self._workdir = self._workspace.new_work_dir(prefix=f"{name}-")
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 274, in new_work_dir
    return WorkDir(self, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/diskutils.py", line 49, in __init__
    self.dir_path = tempfile.mkdtemp(prefix=prefix, dir=workspace.base_dir)
  File "/opt/conda/envs/gdf/lib/python3.9/tempfile.py", line 363, in mkdtemp
    _os.mkdir(file, 0o700)
OSError: [Errno 28] No space left on device: '/tmp/dask-scratch-space/worker-plels7wv'
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 12 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
