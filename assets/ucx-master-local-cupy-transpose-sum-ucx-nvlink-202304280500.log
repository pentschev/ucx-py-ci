2023-04-28 06:13:07,269 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-28 06:13:07,269 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-28 06:13:07,277 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-28 06:13:07,277 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-28 06:13:07,281 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-28 06:13:07,281 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-28 06:13:07,282 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-28 06:13:07,282 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-28 06:13:07,290 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-28 06:13:07,290 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-28 06:13:07,296 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-28 06:13:07,296 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-28 06:13:07,296 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-28 06:13:07,296 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-28 06:13:07,330 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-28 06:13:07,330 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:1621 :0:1621] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:   1621) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7fc478430dec]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31fcf) [0x7fc478430fcf]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x32304) [0x7fc478431304]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fc50984d420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7fc4784c0838]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fc4784f50d8]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23457) [0x7fc4783e0457]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a38) [0x7fc4783e0a38]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x260fc) [0x7fc4783e30fc]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7fc47843c4d9]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fc4783e31ab]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fc4784bccaa]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7fc47857f6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55947978eb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55947977f112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55947977827a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559479789c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55947977981b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559479789ef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x559479797a16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x5594798a79b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x559479735817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x559479780f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55947977ed36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559479789ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55947977981b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559479789ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55947977981b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559479789ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55947977981b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559479789ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55947977981b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55947977827a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559479789c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55947977dfa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55947977827a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x559479797935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x559479798104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55947985efc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5594797822bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55947977d1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559479789ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x559479797c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55947977d1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559479789ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55947977981b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55947977827a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559479789c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55947977981b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559479789ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x559479779568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55947977827a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559479789c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55947977a3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55947977827a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x559479777f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559479777eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5594798288bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x559479856adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x559479852c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55947984a7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55947984a6bd]
=================================
Task exception was never retrieved
future: <Task finished name='Task-300' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-04-28 06:13:10,208 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:49887 -> ucx://127.0.0.1:44581
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f7bd1cf3200, tag: 0x5bd616e119cc6018, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-04-28 06:13:10,208 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:44581
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7fc64de53140, tag: 0x47df2d08acfe39fd, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 329, in connect
    handshake = await wait_for(comm.read(), time_left())
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7fc64de53140, tag: 0x47df2d08acfe39fd, nbytes: 16, type: <class 'numpy.ndarray'>>: ")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 334, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:44581 after 30 s
Task exception was never retrieved
future: <Task finished name='Task-275' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-04-28 06:13:10,213 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:44581
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 468, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 316, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-04-28 06:13:10,213 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:44581
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 468, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 316, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
[dgx13:1623 :0:1623] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:   1623) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7fee4c0cbdec]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31fcf) [0x7fee4c0cbfcf]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x32304) [0x7fee4c0cc304]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7feedd38c420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7fee4c15b838]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fee4c1900d8]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23457) [0x7fee4c07b457]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a38) [0x7fee4c07ba38]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x260fc) [0x7fee4c07e0fc]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7fee4c0d74d9]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fee4c07e1ab]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fee4c157caa]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7fee4c21a6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x558037cfeb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x558037cef112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558037ce827a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558037cf9c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558037ce981b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558037cf9ef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x558037d07a16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x558037e179b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x558037ca5817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x558037cf0f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x558037ceed36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558037cf9ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558037ce981b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558037cf9ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558037ce981b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558037cf9ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558037ce981b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558037cf9ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558037ce981b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558037ce827a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558037cf9c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x558037cedfa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558037ce827a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x558037d07935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x558037d08104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x558037dcefc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x558037cf22bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x558037ced1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558037cf9ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x558037d07c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x558037ced1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558037cf9ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558037ce981b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558037ce827a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558037cf9c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558037ce981b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558037cf9ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x558037ce9568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558037ce827a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558037cf9c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x558037cea3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558037ce827a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x558037ce7f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x558037ce7eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x558037d988bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x558037dc6adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x558037dc2c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x558037dba7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x558037dba6bd]
=================================
2023-04-28 06:13:10,264 - distributed.nanny - WARNING - Restarting worker
2023-04-28 06:13:10,366 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40055
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f1d70f45200, tag: 0x6fa2e7fda719d761, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f1d70f45200, tag: 0x6fa2e7fda719d761, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-04-28 06:13:10,366 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40055
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fc64de53100, tag: 0x9764f8ad7d654155, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fc64de53100, tag: 0x9764f8ad7d654155, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-04-28 06:13:10,367 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40055
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f6b1d73c100, tag: 0xd037871836e1c9be, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f6b1d73c100, tag: 0xd037871836e1c9be, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-04-28 06:13:10,368 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38923 -> ucx://127.0.0.1:40055
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fc64de53240, tag: 0x665daa175e4c26e1, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
Task exception was never retrieved
future: <Task finished name='Task-302' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Endpoint timeout')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Endpoint timeout
2023-04-28 06:13:10,372 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40055
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 468, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 316, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-04-28 06:13:10,410 - distributed.nanny - WARNING - Restarting worker
Task exception was never retrieved
future: <Task finished name='Task-291' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
[dgx13:1634 :0:1634] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:   1634) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7fc660180dec]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31fcf) [0x7fc660180fcf]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x32304) [0x7fc660181304]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fc6f1421420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7fc660210838]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fc6602450d8]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23457) [0x7fc660130457]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a38) [0x7fc660130a38]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x260fc) [0x7fc6601330fc]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7fc66018c4d9]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fc6601331ab]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fc66020ccaa]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7fc6602cf6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x556817474b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x556817465112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55681745e27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55681746fc05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55681745f81b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55681748470e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7fc670ccf2fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5568174682bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55681741b817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x556817466f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x556817464d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55681746fef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55681745f81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55681746fef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55681745f81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55681746fef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55681745f81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55681746fef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55681745f81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55681745e27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55681746fc05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x556817463fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55681745e27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55681747d935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55681747e104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x556817544fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5568174682bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5568174631bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55681746fef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55681747dc72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5568174631bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55681746fef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55681745f81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55681745e27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55681746fc05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55681745f81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55681746fef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55681745f568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55681745e27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55681746fc05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5568174603cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55681745e27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55681745df07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55681745deb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55681750e8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55681753cadc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x556817538c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5568175307ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5568175306bd]
=================================
2023-04-28 06:13:10,623 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:40401 -> ucx://127.0.0.1:38923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #012] ep: 0x7f4d542041c0, tag: 0x92de5d517dd90970, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-04-28 06:13:10,623 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:38923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #023] ep: 0x7f7bd1cf3140, tag: 0x230f4a44d12ad50d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #023] ep: 0x7f7bd1cf3140, tag: 0x230f4a44d12ad50d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-04-28 06:13:10,665 - distributed.nanny - WARNING - Restarting worker
[dgx13:1629 :0:1629] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:   1629) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f1d7125edec]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31fcf) [0x7f1d7125efcf]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x32304) [0x7f1d7125f304]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f1e14505420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f1d712ee838]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f1d713230d8]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23457) [0x7f1d7120e457]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a38) [0x7f1d7120ea38]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x260fc) [0x7f1d712110fc]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f1d7126a4d9]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f1d712111ab]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f1d712eacaa]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f1d713ad6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x560cca9d0b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x560cca9c1112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x560cca9ba27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x560cca9cbc05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560cca9bb81b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560cca9cbef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x560cca9d9a16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x560ccaae99b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x560cca977817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x560cca9c2f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x560cca9c0d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560cca9cbef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560cca9bb81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560cca9cbef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560cca9bb81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560cca9cbef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560cca9bb81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560cca9cbef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560cca9bb81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x560cca9ba27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x560cca9cbc05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x560cca9bffa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x560cca9ba27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x560cca9d9935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x560cca9da104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x560ccaaa0fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x560cca9c42bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x560cca9bf1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560cca9cbef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x560cca9d9c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x560cca9bf1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560cca9cbef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560cca9bb81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x560cca9ba27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x560cca9cbc05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560cca9bb81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560cca9cbef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x560cca9bb568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x560cca9ba27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x560cca9cbc05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x560cca9bc3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x560cca9ba27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x560cca9b9f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x560cca9b9eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x560ccaa6a8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x560ccaa98adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x560ccaa94c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x560ccaa8c7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x560ccaa8c6bd]
=================================
2023-04-28 06:13:11,062 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:34531
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f6b1d73c240, tag: 0xa74818aa6e10080f, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f6b1d73c240, tag: 0xa74818aa6e10080f, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-04-28 06:13:11,063 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:49887 -> ucx://127.0.0.1:34531
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #012] ep: 0x7f7bd1cf3340, tag: 0xecf8ccf8a8f32f4d, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-04-28 06:13:11,064 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:34531
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #022] ep: 0x7f7bd1cf32c0, tag: 0x15461c201223bf57, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #022] ep: 0x7f7bd1cf32c0, tag: 0x15461c201223bf57, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-04-28 06:13:11,064 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42989 -> ucx://127.0.0.1:34531
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7f6b1d73c2c0, tag: 0xddebb5f51d025c0d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1793, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7f6b1d73c2c0, tag: 0xddebb5f51d025c0d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-04-28 06:13:11,104 - distributed.nanny - WARNING - Restarting worker
2023-04-28 06:13:11,739 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-28 06:13:11,739 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-28 06:13:11,855 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-28 06:13:11,855 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-28 06:13:12,079 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-28 06:13:12,080 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-28 06:13:12,564 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-28 06:13:12,565 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
