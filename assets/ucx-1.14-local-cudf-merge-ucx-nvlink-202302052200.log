2023-02-05 23:54:26,312 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:26,312 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:26,312 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:54:26,312 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:54:26,312 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:26,312 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:54:26,490 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:26,490 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:54:26,512 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:26,512 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:54:26,519 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:26,519 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:54:26,533 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:26,534 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:54:26,536 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:26,536 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:47131:0:47131] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  47131) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7ff480c8c614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7ff480c8c7ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7ff480c8cb14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7ff50448b980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7ff480f113b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7ff480f41a08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7ff480a40b5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7ff480a41134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7ff480a43578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7ff480c96c99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7ff480a4361b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7ff480f0dcaa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7ff4811c7c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x55a859b52b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55a859b43112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55a859b3c27a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55a859b4dc05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a859b3d81b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x55a859b6270e]
19  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7ff49e9e12fe]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55a859b462bc]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x55a859af9817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x55a859b44f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55a859b42d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a859b4def3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a859b3d81b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a859b4def3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a859b3d81b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a859b4def3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a859b3d81b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a859b4def3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a859b3d81b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55a859b3c27a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55a859b4dc05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55a859b41fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55a859b3c27a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x55a859b5b935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55a859b5c104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x55a859c22fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55a859b462bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55a859b411bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a859b4def3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x55a859b5bc72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55a859b411bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a859b4def3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a859b3d81b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55a859b3c27a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55a859b4dc05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a859b3d81b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a859b4def3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55a859b3d568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55a859b3c27a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55a859b4dc05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55a859b3e3cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55a859b3c27a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55a859b3bf07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55a859b3beb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55a859bec8bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x55a859c1aadc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x55a859c16c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55a859c0e7ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55a859c0e6bd]
=================================
2023-02-05 23:54:35,118 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:46825 -> ucx://127.0.0.1:35721
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f09b001e100, tag: 0xfac0c57740e819ef, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:54:35,205 - distributed.nanny - WARNING - Restarting worker
[dgx13:47127:0:47127] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  47127) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f39a4b34614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7f39a4b347ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7f39a4b34b14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f3a2834c980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f39a4db93b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f39a4de9a08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7f39a48e8b5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7f39a48e9134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7f39a48eb578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f39a4b3ec99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f39a48eb61b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f39a4db5caa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f39a506fc79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x55f9ccd17b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55f9ccd08112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55f9ccd0127a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55f9ccd12c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55f9ccd0281b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55f9ccd12ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x55f9ccd20a16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x55f9cce309b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x55f9cccbe817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x55f9ccd09f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55f9ccd07d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55f9ccd12ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55f9ccd0281b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55f9ccd12ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55f9ccd0281b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55f9ccd12ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55f9ccd0281b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55f9ccd12ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55f9ccd0281b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55f9ccd0127a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55f9ccd12c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55f9ccd06fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55f9ccd0127a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x55f9ccd20935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55f9ccd21104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x55f9ccde7fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55f9ccd0b2bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55f9ccd061bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55f9ccd12ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x55f9ccd20c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55f9ccd061bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55f9ccd12ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55f9ccd0281b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55f9ccd0127a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55f9ccd12c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55f9ccd0281b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55f9ccd12ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55f9ccd02568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55f9ccd0127a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55f9ccd12c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55f9ccd033cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55f9ccd0127a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55f9ccd00f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55f9ccd00eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55f9ccdb18bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x55f9ccddfadc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x55f9ccddbc24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55f9ccdd37ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55f9ccdd36bd]
=================================
2023-02-05 23:54:35,459 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42273 -> ucx://127.0.0.1:36217
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f9a082fe140, tag: 0xcf40fb387dd9214b, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
Task exception was never retrieved
future: <Task finished name='Task-1059' coro=<_listener_handler_coroutine() done, defined at /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-02-05 23:54:35,758 - distributed.nanny - WARNING - Restarting worker
[dgx13:47124:0:47124] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  47124) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7fdf14147614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7fdf141477ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7fdf14147b14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7fdf9794a980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fdf143cc3b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fdf143fca08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7fdf11de2b5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7fdf11de3134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7fdf11de5578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fdf14151c99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fdf11de561b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fdf143c8caa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7fdf14682c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x559198f88b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x559198f79112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559198f7227a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559198f83c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559198f7381b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x559198f9870e]
19  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7fdf31ea02fe]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x559198f7c2bc]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x559198f2f817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x559198f7af83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x559198f78d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559198f83ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559198f7381b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559198f83ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559198f7381b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559198f83ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559198f7381b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559198f83ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559198f7381b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559198f7227a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559198f83c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x559198f77fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559198f7227a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x559198f91935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x559198f92104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x559199058fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x559198f7c2bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x559198f771bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559198f83ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x559198f91c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x559198f771bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559198f83ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559198f7381b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559198f7227a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559198f83c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559198f7381b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559198f83ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x559198f73568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559198f7227a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559198f83c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x559198f743cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559198f7227a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x559198f71f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559198f71eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5591990228bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x559199050adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x55919904cc24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5591990447ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5591990446bd]
=================================
[dgx13:47106:0:47106] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
[dgx13:47110:0:47110] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  47106) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f4375e0a614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7f4375e0a7ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7f4375e0ab14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f43eb548980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f437608f3b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f43760bfa08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7f4375bbeb5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7f4375bbf134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7f4375bc1578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f4375e14c99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f4375bc161b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f437608bcaa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f4376345c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x559cfadcdb08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x559cfadbe112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559cfadb727a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559cfadc8c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559cfadb881b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559cfadc8ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x559cfadd6a16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x559cfaee69b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x559cfad74817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x559cfadbff83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x559cfadbdd36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559cfadc8ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559cfadb881b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559cfadc8ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559cfadb881b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559cfadc8ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559cfadb881b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559cfadc8ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559cfadb881b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559cfadb727a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559cfadc8c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x559cfadbcfa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559cfadb727a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x559cfadd6935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x559cfadd7104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x559cfae9dfc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x559cfadc12bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x559cfadbc1bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559cfadc8ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x559cfadd6c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x559cfadbc1bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559cfadc8ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559cfadb881b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559cfadb727a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559cfadc8c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559cfadb881b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x559cfadc8ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x559cfadb8568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559cfadb727a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559cfadc8c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x559cfadb93cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x559cfadb727a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x559cfadb6f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559cfadb6eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x559cfae678bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x559cfae95adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x559cfae91c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x559cfae897ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x559cfae896bd]
=================================
==== backtrace (tid:  47110) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f367c07d614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7f367c07d7ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7f367c07db14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f36ed671980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f367c3023b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f367c332a08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7f3669de2b5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7f3669de3134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7f3669de5578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f367c087c99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f3669de561b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f367c2fecaa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f367c5b8c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x555bc05e5b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x555bc05d6112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x555bc05cf27a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x555bc05e0c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555bc05d081b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x555bc05f570e]
19  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f3687bc82fe]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x555bc05d92bc]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x555bc058c817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x555bc05d7f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x555bc05d5d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x555bc05e0ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555bc05d081b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x555bc05e0ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555bc05d081b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x555bc05e0ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555bc05d081b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x555bc05e0ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555bc05d081b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x555bc05cf27a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x555bc05e0c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x555bc05d4fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x555bc05cf27a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x555bc05ee935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x555bc05ef104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x555bc06b5fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x555bc05d92bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x555bc05d41bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x555bc05e0ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x555bc05eec72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x555bc05d41bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x555bc05e0ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555bc05d081b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x555bc05cf27a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x555bc05e0c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555bc05d081b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x555bc05e0ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x555bc05d0568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x555bc05cf27a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x555bc05e0c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x555bc05d13cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x555bc05cf27a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x555bc05cef07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x555bc05ceeb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x555bc067f8bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x555bc06adadc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x555bc06a9c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x555bc06a17ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x555bc06a16bd]
=================================
Task exception was never retrieved
future: <Task finished name='Task-1066' coro=<_listener_handler_coroutine() done, defined at /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-02-05 23:54:36,020 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59633
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f9a082fe140, tag: 0x9590a23358f80aa, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f9a082fe140, tag: 0x9590a23358f80aa, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-02-05 23:54:36,021 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42273 -> ucx://127.0.0.1:59633
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f9a082fe2c0, tag: 0x7eac744fde45f735, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:54:36,022 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35903
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f9a082fe200, tag: 0x544d6b2cb3a0d286, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f9a082fe200, tag: 0x544d6b2cb3a0d286, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
Task exception was never retrieved
future: <Task finished name='Task-1172' coro=<_listener_handler_coroutine() done, defined at /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-02-05 23:54:36,024 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35903
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f09b001e1c0, tag: 0x65f43e989723ddb1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f09b001e1c0, tag: 0x65f43e989723ddb1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-02-05 23:54:36,024 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35903
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f8d580c01c0, tag: 0xae1e11933302ac03, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f8d580c01c0, tag: 0xae1e11933302ac03, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-02-05 23:54:36,068 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58011
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f8d580c0240, tag: 0x6e7b3917d42f2d24, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f8d580c0240, tag: 0x6e7b3917d42f2d24, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
Task exception was never retrieved
future: <Task finished name='Task-1086' coro=<_listener_handler_coroutine() done, defined at /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-02-05 23:54:36,100 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58011
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f09b001e200, tag: 0xceda94dfb99a4f0b, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f09b001e200, tag: 0xceda94dfb99a4f0b, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-02-05 23:54:36,146 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:54:36,196 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:54:36,261 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58011
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7f9a082fe240, tag: 0x33c24f3ad707c368, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 328, in connect
    handshake = await asyncio.wait_for(comm.read(), time_left())
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f9a082fe240, tag: 0x33c24f3ad707c368, nbytes: 16, type: <class 'numpy.ndarray'>>: ")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in _get_data
    comm = await rpc.connect(worker)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1439, in connect
    return await connect_attempt
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1375, in _connect
    comm = await connect(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 333, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:58011 after 30 s
2023-02-05 23:54:36,264 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:54:37,195 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:37,195 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:54:37,593 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:37,593 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:54:37,984 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:37,984 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:54:38,001 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:38,001 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:54:38,088 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:54:38,088 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:55:05,748 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59633
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/asyncio/tasks.py", line 490, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 291, in connect
    comm = await asyncio.wait_for(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/asyncio/tasks.py", line 492, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in _get_data
    comm = await rpc.connect(worker)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1439, in connect
    return await connect_attempt
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1375, in _connect
    comm = await connect(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 317, in connect
    raise OSError(
OSError: Timed out trying to connect to ucx://127.0.0.1:59633 after 30 s
2023-02-05 23:55:05,748 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59633
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/asyncio/tasks.py", line 490, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 291, in connect
    comm = await asyncio.wait_for(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/asyncio/tasks.py", line 492, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in _get_data
    comm = await rpc.connect(worker)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1439, in connect
    return await connect_attempt
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1375, in _connect
    comm = await connect(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 317, in connect
    raise OSError(
OSError: Timed out trying to connect to ucx://127.0.0.1:59633 after 30 s
[dgx13:47715:0:47715] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
[dgx13:47712:0:47712] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  47712) ====
==== backtrace (tid:  47715) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7fe3c12e8614]
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7fd6d0e0c614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7fe3c12e87ef]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7fd6d0e0c7ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7fe3c12e8b14]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7fd6d0e0cb14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7fe4448e3980]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7fd754604980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fe3c156d3b4]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fd6d10913b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fe3c159da08]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fd6d10c1a08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7fe3c109cb5f]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7fd6d0bc0b5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7fe3c109d134]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7fd6d0bc1134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7fe3c109f578]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7fd6d0bc3578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fe3c12f2c99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fe3c109f61b]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd6d0e16c99]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fe3c1569caa]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fd6d0bc361b]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7fe3c1823c79]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fd6d108dcaa]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x557213e17b08]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7fd6d1347c79]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x557213e08112]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x558f83442b08]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x557213e0127a]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x558f83433112]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x557213e12c05]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x558f8342c27a]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557213e0281b]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558f8343dc05]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x557213e12ef3]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558f8342d81b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558f8343def3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x557213e20a16]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x558f8344ba16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x557213f309b1]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x558f8355b9b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x557213dbe817]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x558f833e9817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x557213e09f83]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x558f83434f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x557213e07d36]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x558f83432d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x557213e12ef3]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558f8343def3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557213e0281b]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558f8342d81b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x557213e12ef3]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558f8343def3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557213e0281b]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558f8342d81b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x557213e12ef3]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558f8343def3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557213e0281b]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558f8342d81b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x557213e12ef3]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558f8343def3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557213e0281b]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558f8342d81b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x557213e0127a]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x558f8342c27a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x557213e12c05]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558f8343dc05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x557213e06fa7]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x558f83431fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x557213e0127a]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x558f8342c27a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x557213e20935]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x558f8344b935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x557213e21104]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x558f8344c104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x557213ee7fc8]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x558f83512fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x557213e0b2bc]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x558f834362bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x557213e061bb]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x558f834311bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x557213e12ef3]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558f8343def3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x557213e20c72]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x558f8344bc72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x557213e061bb]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x558f834311bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x557213e12ef3]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558f8343def3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557213e0281b]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558f8342d81b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x557213e0127a]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x558f8342c27a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x557213e12c05]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558f8343dc05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557213e0281b]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558f8342d81b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x557213e12ef3]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558f8343def3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x557213e02568]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x558f8342d568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x557213e0127a]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x558f8342c27a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x557213e12c05]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558f8343dc05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x557213e033cb]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x558f8342e3cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x557213e0127a]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x558f8342c27a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x557213e00f07]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x558f8342bf07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x557213e00eb9]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x558f8342beb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x557213eb18bb]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x558f834dc8bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x557213edfadc]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x558f8350aadc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x557213edbc24]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x558f83506c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x557213ed37ed]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x558f834fe7ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x557213ed36bd]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x558f834fe6bd]
=================================
=================================
2023-02-05 23:55:06,324 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42273 -> ucx://127.0.0.1:49993
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f9a082fe240, tag: 0x4528ff57ba3a22d3, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:06,336 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:46825 -> ucx://127.0.0.1:41865
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f09b001e1c0, tag: 0x2f4a91a89de9dbfd, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:06,370 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:55:06,377 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-df615b9f8683ba0c100c55a47701d137', 0)
Function:  <dask.layers.CallableLazyImport object at 0x7f9530
args:      (               key   payload
shuffle                     
0            23045  77709207
0            23061  31447703
0            23066  31005671
0            23266  95300255
0             2752  80527072
...            ...       ...
0        799996640   6451657
0        799996646  91045306
0        799996650  39366749
0        799996654   6216070
0        799996664  73867035

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/datasets/pentschev/miniconda3/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:193: Maximum pool size exceeded')"

2023-02-05 23:55:06,427 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:55:06,455 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-df615b9f8683ba0c100c55a47701d137', 5)
Function:  <dask.layers.CallableLazyImport object at 0x7f9530
args:      (               key   payload
shuffle                     
5            23046  95544916
5            23053   4448797
5            23265  88211498
5             2771  75863155
5            23277  92291497
...            ...       ...
5        799996525  57150541
5        799996528  58520943
5        799996649  99684933
5        799996657  57360342
5        799996666    641234

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/datasets/pentschev/miniconda3/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:193: Maximum pool size exceeded')"

[dgx13:47701:0:47701] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  47701) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7fbd7d4f7614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7fbd7d4f77ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7fbd7d4f7b14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7fbe00b53980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fbd7d77c3b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fbd7d7aca08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7fbd7d2abb5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7fbd7d2ac134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7fbd7d2ae578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fbd7d501c99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fbd7d2ae61b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fbd7d778caa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7fbd7da32c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x55641edfab08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55641edeb112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55641ede427a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55641edf5c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55641ede581b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55641edf5ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x55641ee03a16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x55641ef139b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x55641eda1817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x55641edecf83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55641edead36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55641edf5ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55641ede581b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55641edf5ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55641ede581b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55641edf5ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55641ede581b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55641edf5ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55641ede581b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55641ede427a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55641edf5c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55641ede9fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55641ede427a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x55641ee03935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55641ee04104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x55641eecafc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55641edee2bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55641ede91bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55641edf5ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x55641ee03c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55641ede91bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55641edf5ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55641ede581b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55641ede427a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55641edf5c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55641ede581b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55641edf5ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55641ede5568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55641ede427a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55641edf5c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55641ede63cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55641ede427a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55641ede3f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55641ede3eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55641ee948bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x55641eec2adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x55641eebec24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55641eeb67ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55641eeb66bd]
=================================
2023-02-05 23:55:06,674 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42273 -> ucx://127.0.0.1:33287
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f9a082fe240, tag: 0xfd7b02ecf33be4b1, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:06,705 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:55:08,251 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:08,251 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:55:08,372 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:08,372 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:55:08,525 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:08,525 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[1675670109.832299] [dgx13:47122:0]    cuda_copy_md.c:208  UCX  ERROR   cuMemAlloc_v2((CUdeviceptr*)address_p, *length_p)() failed: out of memory
[1675670109.832338] [dgx13:47122:0]         uct_mem.c:155  UCX  ERROR   failed to allocate 536870912 bytes using md cuda_cpy for ucp_rndv_frags: Input/output error
[1675670109.832343] [dgx13:47122:0]           mpool.c:269  UCX  ERROR Failed to allocate memory pool (name=ucp_rndv_frags) chunk: Out of memory
[dgx13:47122:0:47122]        rndv.c:1369 Fatal: failed to allocate fragment memory buffer
==== backtrace (tid:  47122) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f09a9373614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0xb8) [0x7f09a93705c8]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2b6a9) [0x7f09a93706a9]
 3  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(+0x7ab84) [0x7f09a9623b84]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_receive+0x45c) [0x7f09a96247bc]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_tag_rndv_process_rts+0x20a) [0x7f09a963a8fa]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7f09a9127b5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7f09a9128134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7f09a912a578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f09a937dc99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f09a912a61b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f09a95f4caa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f09a98aec79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x55c8ce682b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55c8ce673112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55c8ce66c27a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55c8ce67dc05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c8ce66d81b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55c8ce67def3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x55c8ce68ba16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x55c8ce79b9b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x55c8ce629817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x55c8ce674f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55c8ce672d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55c8ce67def3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c8ce66d81b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55c8ce67def3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c8ce66d81b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55c8ce67def3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c8ce66d81b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55c8ce67def3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c8ce66d81b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55c8ce66c27a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55c8ce67dc05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55c8ce671fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55c8ce66c27a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x55c8ce68b935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55c8ce68c104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x55c8ce752fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55c8ce6762bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55c8ce6711bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55c8ce67def3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x55c8ce68bc72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55c8ce6711bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55c8ce67def3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c8ce66d81b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55c8ce66c27a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55c8ce67dc05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c8ce66d81b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55c8ce67def3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55c8ce66d568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55c8ce66c27a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55c8ce67dc05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55c8ce66e3cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55c8ce66c27a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55c8ce66bf07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55c8ce66beb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55c8ce71c8bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x55c8ce74aadc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x55c8ce746c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55c8ce73e7ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55c8ce73e6bd]
=================================
2023-02-05 23:55:10,006 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46825
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #099] ep: 0x7f9a082fe180, tag: 0x43d5e0175ecdf392, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #099] ep: 0x7f9a082fe180, tag: 0x43d5e0175ecdf392, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-02-05 23:55:10,006 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46825
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #066] ep: 0x7f8d580c0200, tag: 0x6405379bef852ca7, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #066] ep: 0x7f8d580c0200, tag: 0x6405379bef852ca7, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
Task exception was never retrieved
future: <Task finished name='Task-5216' coro=<_listener_handler_coroutine() done, defined at /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-02-05 23:55:10,091 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:55:10,103 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46825
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f273c018140, tag: 0x69583ef4e14bf289, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f273c018140, tag: 0x69583ef4e14bf289, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
[dgx13:47693:0:47693] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  47693) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f2729aeb614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7f2729aeb7ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7f2729aebb14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f27ad1c4980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f2729d703b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f2729da0a08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7f272989fb5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7f27298a0134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7f27298a2578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f2729af5c99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f27298a261b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f2729d6ccaa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f273c10bc79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x560b04ed1b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x560b04ec2112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x560b04ebb27a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x560b04eccc05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560b04ebc81b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x560b04ee170e]
19  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f274771f2fe]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x560b04ec52bc]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x560b04e78817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x560b04ec3f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x560b04ec1d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x560b04eccef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560b04ebc81b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x560b04eccef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560b04ebc81b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x560b04eccef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560b04ebc81b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x560b04eccef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560b04ebc81b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x560b04ebb27a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x560b04eccc05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x560b04ec0fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x560b04ebb27a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x560b04eda935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x560b04edb104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x560b04fa1fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x560b04ec52bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x560b04ec01bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x560b04eccef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x560b04edac72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x560b04ec01bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x560b04eccef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560b04ebc81b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x560b04ebb27a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x560b04eccc05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560b04ebc81b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x560b04eccef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x560b04ebc568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x560b04ebb27a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x560b04eccc05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x560b04ebd3cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x560b04ebb27a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x560b04ebaf07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x560b04ebaeb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x560b04f6b8bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x560b04f99adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x560b04f95c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x560b04f8d7ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x560b04f8d6bd]
=================================
2023-02-05 23:55:10,706 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42273 -> ucx://127.0.0.1:37043
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7f9a082fe200, tag: 0x200037e7b80d4ca1, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1767, in get_data
    response = await comm.read(deserializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7f9a082fe200, tag: 0x200037e7b80d4ca1, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-02-05 23:55:10,706 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:51673 -> ucx://127.0.0.1:37043
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f8d580c0300, tag: 0xd66dc6b5ec6099ce, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:10,707 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37043
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f8d580c0340, tag: 0x261c115b6f7a6b4d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f8d580c0340, tag: 0x261c115b6f7a6b4d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-02-05 23:55:10,706 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37043
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f3f9c0211c0, tag: 0xb80448cb6ced3fec, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f3f9c0211c0, tag: 0xb80448cb6ced3fec, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-02-05 23:55:10,711 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:60049 -> ucx://127.0.0.1:37043
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3f9c0212c0, tag: 0x16d977c40da7cb97, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:10,790 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:55:11,981 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:11,981 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:55:12,694 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:12,694 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:47114:0:47114] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  47114) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f8d50657614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7f8d506577ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7f8d50657b14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f8dc5dd8980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f8d508dc3b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f8d5090ca08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7f8d5040bb5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7f8d5040c134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7f8d5040e578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f8d50661c99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f8d5040e61b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f8d508d8caa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f8d50b92c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x55a6d71ffb08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55a6d71f0112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55a6d71e927a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55a6d71fac05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6d71ea81b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x55a6d720f70e]
19  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f8db80592fe]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55a6d71f32bc]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x55a6d71a6817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x55a6d71f1f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55a6d71efd36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a6d71faef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6d71ea81b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a6d71faef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6d71ea81b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a6d71faef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6d71ea81b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a6d71faef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6d71ea81b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55a6d71e927a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55a6d71fac05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55a6d71eefa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55a6d71e927a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x55a6d7208935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55a6d7209104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x55a6d72cffc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55a6d71f32bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55a6d71ee1bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a6d71faef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x55a6d7208c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55a6d71ee1bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a6d71faef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6d71ea81b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55a6d71e927a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55a6d71fac05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6d71ea81b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55a6d71faef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55a6d71ea568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55a6d71e927a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55a6d71fac05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55a6d71eb3cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55a6d71e927a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55a6d71e8f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55a6d71e8eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55a6d72998bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x55a6d72c7adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x55a6d72c3c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55a6d72bb7ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55a6d72bb6bd]
=================================
2023-02-05 23:55:13,464 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:51673
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #032] ep: 0x7f3f9c021180, tag: 0xfdd1ddbae68f28e3, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #032] ep: 0x7f3f9c021180, tag: 0xfdd1ddbae68f28e3, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-02-05 23:55:13,465 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:51673
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #106] ep: 0x7f9a082fe1c0, tag: 0x83c56aa6e1a29175, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #106] ep: 0x7f9a082fe1c0, tag: 0x83c56aa6e1a29175, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-02-05 23:55:13,465 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42273 -> ucx://127.0.0.1:51673
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #084] ep: 0x7f9a082fe300, tag: 0xe505fe2409bd72c9, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1767, in get_data
    response = await comm.read(deserializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #084] ep: 0x7f9a082fe300, tag: 0xe505fe2409bd72c9, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-02-05 23:55:13,509 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58199 -> ucx://127.0.0.1:51673
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0d841c0200, tag: 0xcec5962a7fe261cc, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:13,567 - distributed.nanny - WARNING - Restarting worker
Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 742, in cupy.cuda.memory.alloc
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/rmm/rmm.py", line 230, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/datasets/pentschev/miniconda3/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:193: Maximum pool size exceeded
Exception ignored in: 'cupy.cuda.thrust.cupy_malloc'
Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 742, in cupy.cuda.memory.alloc
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/rmm/rmm.py", line 230, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/datasets/pentschev/miniconda3/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:193: Maximum pool size exceeded
[1675670113.660588] [dgx13:47119:0]    cuda_copy_ep.c:246  UCX  ERROR cudaMemcpyAsync(buffer, (void*)remote_addr, length, cudaMemcpyDefault, *stream)() failed: an illegal memory access was encountered
[1675670113.660602] [dgx13:47119:0]    cuda_copy_ep.c:248  UCX  ERROR cudaStreamSynchronize(*stream)() failed: an illegal memory access was encountered
[dgx13:47119:0:47119]          dt.c:97   Fatal: mem type pack failed to uct_ep_get_short() Input/output error
==== backtrace (tid:  47119) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f9a1c0d9614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0xb8) [0x7f9a1c0d65c8]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2b6a9) [0x7f9a1c0d66a9]
 3  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_pack+0x180) [0x7f9a1c35e6d0]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_dt_pack+0x61) [0x7f9a1c35e761]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(+0x7c2bd) [0x7f9a1c38b2bd]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_ep_am_bcopy+0x7a) [0x7f9a09de404a]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_progress_am_bcopy+0x1bb) [0x7f9a1c38b4db]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_ep_pending_queue_dispatch+0x77) [0x7f9a09de2207]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20895) [0x7f9a09de2895]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23599) [0x7f9a09de5599]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f9a1c0e3c99]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f9a09de561b]
13  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f9a1c35acaa]
14  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f9a1c614c79]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x558bbff58b08]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x558bbff49112]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x558bbff4227a]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558bbff53c05]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558bbff4381b]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x558bbff6870e]
21  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f9a27c232fe]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x558bbff4c2bc]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x558bbfeff817]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x558bbff4af83]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x558bbff48d36]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558bbff53ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558bbff4381b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558bbff53ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558bbff4381b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558bbff53ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558bbff4381b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558bbff53ef3]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558bbff4381b]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x558bbff4227a]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558bbff53c05]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x558bbff47fa7]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x558bbff4227a]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x558bbff61935]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x558bbff62104]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x558bc0028fc8]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x558bbff4c2bc]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x558bbff471bb]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558bbff53ef3]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x558bbff61c72]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x558bbff471bb]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558bbff53ef3]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558bbff4381b]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x558bbff4227a]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558bbff53c05]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558bbff4381b]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x558bbff53ef3]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x558bbff43568]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x558bbff4227a]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558bbff53c05]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x558bbff443cb]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x558bbff4227a]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x558bbff41f07]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x558bbff41eb9]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x558bbfff28bb]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x558bc0020adc]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x558bc001cc24]
=================================
2023-02-05 23:55:13,846 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58199 -> ucx://127.0.0.1:42273
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0d841c0180, tag: 0x54b4f01968352d03, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:13,847 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:42273
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f0d841c0140, tag: 0x7e0ec237c29daa8c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f0d841c0140, tag: 0x7e0ec237c29daa8c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-02-05 23:55:13,990 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:55:15,525 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:15,526 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:55:15,907 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:15,907 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:48069:0:48069] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  48069) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f646103e614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7f646103e7ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7f646103eb14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f64e467d980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f64612c33b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f64612f3a08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7f6460df2b5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7f6460df3134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7f6460df5578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f6461048c99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f6460df561b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f64612bfcaa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f6461579c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x55b562d48b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55b562d39112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55b562d3227a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55b562d43c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b562d3381b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55b562d43ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x55b562d51a16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x55b562e619b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x55b562cef817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x55b562d3af83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55b562d38d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55b562d43ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b562d3381b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55b562d43ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b562d3381b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55b562d43ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b562d3381b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55b562d43ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b562d3381b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55b562d3227a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55b562d43c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55b562d37fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55b562d3227a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x55b562d51935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55b562d52104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x55b562e18fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55b562d3c2bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55b562d371bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55b562d43ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x55b562d51c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55b562d371bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55b562d43ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b562d3381b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55b562d3227a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55b562d43c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b562d3381b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x55b562d43ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55b562d33568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55b562d3227a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55b562d43c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55b562d343cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x55b562d3227a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55b562d31f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55b562d31eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55b562de28bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x55b562e10adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x55b562e0cc24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55b562e047ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55b562e046bd]
=================================
[dgx13:48298:0:48298] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  48298) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7fda94474614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7fda944747ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7fda94474b14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7fdb17a69980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fda946f93b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fda94729a08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7fda94228b5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7fda94229134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7fda9422b578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fda9447ec99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fda9422b61b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fda946f5caa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7fda949afc79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x56143bd3ab08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x56143bd2b112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x56143bd2427a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56143bd35c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56143bd2581b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56143bd35ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x56143bd43a16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x56143be539b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x56143bce1817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x56143bd2cf83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x56143bd2ad36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56143bd35ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56143bd2581b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56143bd35ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56143bd2581b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56143bd35ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56143bd2581b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56143bd35ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56143bd2581b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x56143bd2427a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56143bd35c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x56143bd29fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x56143bd2427a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x56143bd43935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x56143bd44104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x56143be0afc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x56143bd2e2bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x56143bd291bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56143bd35ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x56143bd43c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x56143bd291bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56143bd35ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56143bd2581b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x56143bd2427a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56143bd35c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56143bd2581b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56143bd35ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x56143bd25568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x56143bd2427a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56143bd35c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x56143bd263cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x56143bd2427a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x56143bd23f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56143bd23eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56143bdd48bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x56143be02adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x56143bdfec24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x56143bdf67ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x56143bdf66bd]
=================================
[dgx13:47979:0:47979] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  47979) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f5458d19614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7f5458d197ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7f5458d19b14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f54ce326980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f5458f9e3b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f5458fcea08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7f5458acdb5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7f5458ace134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7f5458ad0578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f5458d23c99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f5458ad061b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f5458f9acaa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f5459254c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x5622ef236b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x5622ef227112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5622ef22027a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5622ef231c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5622ef22181b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x14e70e) [0x5622ef24670e]
19  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f546887e2fe]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5622ef22a2bc]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x5622ef1dd817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x5622ef228f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5622ef226d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5622ef231ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5622ef22181b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5622ef231ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5622ef22181b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5622ef231ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5622ef22181b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5622ef231ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5622ef22181b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5622ef22027a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5622ef231c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5622ef225fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5622ef22027a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x5622ef23f935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5622ef240104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x5622ef306fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5622ef22a2bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5622ef2251bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5622ef231ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x5622ef23fc72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5622ef2251bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5622ef231ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5622ef22181b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5622ef22027a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5622ef231c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5622ef22181b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5622ef231ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5622ef221568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5622ef22027a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5622ef231c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5622ef2223cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5622ef22027a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5622ef21ff07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5622ef21feb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5622ef2d08bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x5622ef2feadc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x5622ef2fac24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5622ef2f27ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5622ef2f26bd]
=================================
Task exception was never retrieved
future: <Task finished name='Task-11182' coro=<_listener_handler_coroutine() done, defined at /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-02-05 23:55:17,150 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50785
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f3f9c021300, tag: 0x4d1f436e796f698c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f3f9c021300, tag: 0x4d1f436e796f698c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-02-05 23:55:17,150 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50785
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f0d841c0200, tag: 0x771cb304f5a1079f, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f0d841c0200, tag: 0x771cb304f5a1079f, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-02-05 23:55:17,151 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:60049 -> ucx://127.0.0.1:50785
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3f9c021400, tag: 0xccc5755b4ae78bd9, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:17,178 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:60049 -> ucx://127.0.0.1:48621
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3f9c021340, tag: 0x2dd987f0fc6a0e45, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:17,178 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48621
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #010] ep: 0x7f0d841c0140, tag: 0x8dc91f179b00091a, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #010] ep: 0x7f0d841c0140, tag: 0x8dc91f179b00091a, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-02-05 23:55:17,218 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:36495 -> ucx://127.0.0.1:45989
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fc0900c71c0, tag: 0x16131dfca5e9d0f3, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:17,325 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:36495 -> ucx://127.0.0.1:48621
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 289, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message
2023-02-05 23:55:17,326 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:36495 -> ucx://127.0.0.1:50785
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 289, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message
2023-02-05 23:55:17,328 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50785
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 329, in connect
    await asyncio.wait_for(comm.write(local_info), time_left())
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 289, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in _get_data
    comm = await rpc.connect(worker)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1439, in connect
    return await connect_attempt
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1375, in _connect
    comm = await connect(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 333, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:50785 after 30 s
2023-02-05 23:55:17,535 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:55:17,581 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:55:17,656 - distributed.nanny - WARNING - Restarting worker
terminate called after throwing an instance of 'rmm::out_of_memory'
  what():  std::bad_alloc: out_of_memory: CUDA error at: /datasets/pentschev/miniconda3/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
2023-02-05 23:55:19,327 - distributed.diskutils - INFO - Found stale lock file and directory '/tmp/dask-worker-space/worker-nzhnyzo0', purging
2023-02-05 23:55:19,328 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:19,328 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:55:19,365 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:19,365 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:55:19,390 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:55:19,459 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:19,459 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:48560:0:48560] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  48560) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f3a58e58614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7f3a58e587ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7f3a58e58b14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f3ace47b980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f3a590dd3b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f3a5910da08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7f3a58c0cb5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7f3a58c0d134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7f3a58c0f578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f3a58e62c99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f3a58c0f61b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f3a590d9caa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f3a59393c79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x56204b21cb08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x56204b20d112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x56204b20627a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56204b217c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56204b20781b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56204b217ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x56204b225a16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x56204b3359b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x56204b1c3817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x56204b20ef83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x56204b20cd36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56204b217ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56204b20781b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56204b217ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56204b20781b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56204b217ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56204b20781b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56204b217ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56204b20781b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x56204b20627a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56204b217c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x56204b20bfa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x56204b20627a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x56204b225935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x56204b226104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x56204b2ecfc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x56204b2102bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x56204b20b1bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56204b217ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x56204b225c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x56204b20b1bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56204b217ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56204b20781b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x56204b20627a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56204b217c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56204b20781b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x56204b217ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x56204b207568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x56204b20627a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56204b217c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x56204b2083cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x56204b20627a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x56204b205f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56204b205eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56204b2b68bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x56204b2e4adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x56204b2e0c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x56204b2d87ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x56204b2d86bd]
=================================
2023-02-05 23:55:21,210 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:36495 -> ucx://127.0.0.1:57803
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fc0900c7100, tag: 0x259b1c11f1e80601, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:21,262 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:55:21,317 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:21,317 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:48341:0:48341] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  48341) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7fc185a44614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7fc185a447ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7fc185a44b14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7fc1fb04c980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fc185cc93b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fc185cf9a08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7fc1857f8b5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7fc1857f9134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7fc1857fb578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fc185a4ec99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fc1857fb61b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fc185cc5caa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7fc185f7fc79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x5559f170eb08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x5559f16ff112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5559f16f827a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5559f1709c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559f16f981b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5559f1709ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x5559f1717a16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x5559f18279b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x5559f16b5817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x5559f1700f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5559f16fed36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5559f1709ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559f16f981b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5559f1709ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559f16f981b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5559f1709ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559f16f981b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5559f1709ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559f16f981b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5559f16f827a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5559f1709c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5559f16fdfa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5559f16f827a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x5559f1717935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5559f1718104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x5559f17defc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5559f17022bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5559f16fd1bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5559f1709ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x5559f1717c72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5559f16fd1bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5559f1709ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559f16f981b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5559f16f827a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5559f1709c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559f16f981b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x5559f1709ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5559f16f9568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5559f16f827a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5559f1709c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5559f16fa3cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x5559f16f827a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5559f16f7f07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5559f16f7eb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5559f17a88bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x5559f17d6adc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x5559f17d2c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5559f17ca7ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5559f17ca6bd]
=================================
2023-02-05 23:55:21,534 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58199 -> ucx://127.0.0.1:36341
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0d841c01c0, tag: 0x9d016f705f605f5, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:21,534 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36341
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 708, in recv
    self._ep.raise_on_error()
  File "ucp/_libs/ucx_endpoint.pyx", line 353, in ucp._libs.ucx_api.UCXEndpoint.raise_on_error
ucp._libs.exceptions.UCXConnectionReset: Endpoint 0x7fc0900c7100 error: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXConnectionReset('Endpoint 0x7fc0900c7100 error: Connection reset by remote peer')
2023-02-05 23:55:21,624 - distributed.nanny - WARNING - Restarting worker
[dgx13:48429:0:48429] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  48429) ====
 0  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2d4) [0x7f3f552d2614]
 1  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2e7ef) [0x7f3f552d27ef]
 2  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(+0x2eb14) [0x7f3f552d2b14]
 3  /lib/x86_64-linux-gnu/libpthread.so.0(+0x12980) [0x7f3fca8c6980]
 4  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f3f555573b4]
 5  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f3f55587a08]
 6  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x20b5f) [0x7f3f55086b5f]
 7  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x21134) [0x7f3f55087134]
 8  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(+0x23578) [0x7f3f55089578]
 9  /datasets/pentschev/miniconda3/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f3f552dcc99]
10  /datasets/pentschev/miniconda3/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f3f5508961b]
11  /datasets/pentschev/miniconda3/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f3f55553caa]
12  /datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x26c79) [0x7f3f5580dc79]
13  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x13eb08) [0x556eedee5b08]
14  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x556eeded6112]
15  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x556eedecf27a]
16  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x556eedee0c05]
17  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x556eeded081b]
18  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556eedee0ef3]
19  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147a16) [0x556eedeeea16]
20  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x2579b1) [0x556eedffe9b1]
21  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0xe5817) [0x556eede8c817]
22  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x130f83) [0x556eeded7f83]
23  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x556eeded5d36]
24  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556eedee0ef3]
25  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x556eeded081b]
26  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556eedee0ef3]
27  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x556eeded081b]
28  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556eedee0ef3]
29  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x556eeded081b]
30  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556eedee0ef3]
31  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x556eeded081b]
32  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x556eedecf27a]
33  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x556eedee0c05]
34  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x556eeded4fa7]
35  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x556eedecf27a]
36  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147935) [0x556eedeee935]
37  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyObject_Call+0xb4) [0x556eedeef104]
38  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x20efc8) [0x556eedfb5fc8]
39  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x556eeded92bc]
40  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x556eeded41bb]
41  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556eedee0ef3]
42  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x147c72) [0x556eedeeec72]
43  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x556eeded41bb]
44  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556eedee0ef3]
45  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x556eeded081b]
46  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x556eedecf27a]
47  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x556eedee0c05]
48  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x556eeded081b]
49  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x139ef3) [0x556eedee0ef3]
50  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x556eeded0568]
51  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x556eedecf27a]
52  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x556eedee0c05]
53  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x556eeded13cb]
54  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x12827a) [0x556eedecf27a]
55  /datasets/pentschev/miniconda3/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x556eedecef07]
56  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x556eedeceeb9]
57  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x556eedf7f8bb]
58  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x206adc) [0x556eedfadadc]
59  /datasets/pentschev/miniconda3/envs/gdf/bin/python(+0x202c24) [0x556eedfa9c24]
60  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x556eedfa17ed]
61  /datasets/pentschev/miniconda3/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x556eedfa16bd]
=================================
2023-02-05 23:55:22,107 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58199 -> ucx://127.0.0.1:58129
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0d841c01c0, tag: 0x1fddd86b7e9a5748, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1766, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-02-05 23:55:22,107 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58129
Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 708, in recv
    self._ep.raise_on_error()
  File "ucp/_libs/ucx_endpoint.pyx", line 353, in ucp._libs.ucx_api.UCXEndpoint.raise_on_error
ucp._libs.exceptions.UCXConnectionReset: Endpoint 0x7fc0900c7280 error: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2058, in gather_dep
    response = await get_data_from_worker(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2872, in get_data_from_worker
    return await retry_operation(_get_data, operation="get_data_from_worker")
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 419, in retry_operation
    return await retry(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils_comm.py", line 404, in retry
    return await coro()
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in _get_data
    response = await send_recv(
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 986, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 741, in wrapper
    return await func(*args, **kwargs)
  File "/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXConnectionReset('Endpoint 0x7fc0900c7280 error: Connection reset by remote peer')
2023-02-05 23:55:22,191 - distributed.nanny - WARNING - Restarting worker
2023-02-05 23:55:23,480 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:23,480 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:55:23,553 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:23,553 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-02-05 23:55:24,036 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-02-05 23:55:24,036 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
/datasets/pentschev/miniconda3/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
