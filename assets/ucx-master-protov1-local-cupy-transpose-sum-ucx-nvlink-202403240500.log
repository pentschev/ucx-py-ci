[dgx13:57551:0:57551] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  57551) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f4cecf05d0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2df04) [0x7f4cecf05f04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2e0ca) [0x7f4cecf060ca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f4d267e2420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f4cecf889c7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f4cecfb2dcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x21b3f) [0x7f4cecebbb3f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24d18) [0x7f4cecebed18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f4cecf0f609]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f4cecebde2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f4cecf8589a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f4ced04606a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55fc08cd5516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55fc08cd0184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55fc08ce1559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fc08cd1606]
16  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55fc08ce1802]
17  /opt/conda/envs/gdf/bin/python(+0x14cbb3) [0x55fc08ceebb3]
18  /opt/conda/envs/gdf/bin/python(+0x25842c) [0x55fc08dfa42c]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x55fc08c9466c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x55fc08cd8833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x55fc08cd6824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55fc08ce1802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fc08cd1606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55fc08ce1802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fc08cd1606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55fc08ce1802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fc08cd1606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55fc08ce1802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fc08cd1606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55fc08cd0184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55fc08ce1559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55fc08cd2162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55fc08cd0184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x55fc08cee9fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55fc08cef17c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x55fc08db29ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55fc08cd97ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55fc08cd5516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55fc08ce1802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x55fc08ceeadc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55fc08cd5516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55fc08ce1802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fc08cd1606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55fc08cd0184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55fc08ce1559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fc08cd1606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55fc08ce1802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55fc08cd1352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55fc08cd0184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55fc08ce1559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55fc08cd2162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55fc08cd0184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55fc08ccfe58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55fc08ccfe09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55fc08d7d4ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x55fc08daa87a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x55fc08da6c03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55fc08d9ea1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55fc08d9e90c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55fc08d9db47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55fc08d712e7]
=================================
[dgx13:57532:0:57532] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  57532) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f09886a2d0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2df04) [0x7f09886a2f04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2e0ca) [0x7f09886a30ca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f09c1fa1420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f09887259c7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f098874fdcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x21b3f) [0x7f0988658b3f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24d18) [0x7f098865bd18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f09886ac609]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f098865ae2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f098872289a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f09887e306a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d50a9b9516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d50a9b4184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d50a9c5559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d50a9b5606]
16  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d50a9c5802]
17  /opt/conda/envs/gdf/bin/python(+0x14cbb3) [0x55d50a9d2bb3]
18  /opt/conda/envs/gdf/bin/python(+0x25842c) [0x55d50aade42c]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x55d50a97866c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x55d50a9bc833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x55d50a9ba824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d50a9c5802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d50a9b5606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d50a9c5802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d50a9b5606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d50a9c5802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d50a9b5606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d50a9c5802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d50a9b5606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d50a9b4184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d50a9c5559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55d50a9b6162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d50a9b4184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x55d50a9d29fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55d50a9d317c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x55d50aa969ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55d50a9bd7ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d50a9b9516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d50a9c5802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x55d50a9d2adc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d50a9b9516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d50a9c5802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d50a9b5606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d50a9b4184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d50a9c5559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d50a9b5606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d50a9c5802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55d50a9b5352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d50a9b4184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d50a9c5559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55d50a9b6162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d50a9b4184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55d50a9b3e58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55d50a9b3e09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55d50aa614ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x55d50aa8e87a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x55d50aa8ac03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55d50aa82a1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55d50aa8290c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55d50aa81b47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55d50aa552e7]
=================================
[dgx13:57535:0:57535] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  57535) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f0ae721ad0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2df04) [0x7f0ae721af04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2e0ca) [0x7f0ae721b0ca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f0b24b39420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f0ae729d9c7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f0ae72c7dcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x21b3f) [0x7f0ae71d0b3f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24d18) [0x7f0ae71d3d18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f0ae7224609]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f0ae71d2e2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f0ae729a89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f0ae735b06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d19f9d6516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d19f9d1184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d19f9e2559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d19f9d2606]
16  /opt/conda/envs/gdf/bin/python(+0x1e28a2) [0x55d19fa858a2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f0b1801e1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55d19f9da7ac]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x55d19f99566c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x55d19f9d9833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x55d19f9d7824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d19f9e2802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d19f9d2606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d19f9e2802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d19f9d2606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d19f9e2802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d19f9d2606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d19f9e2802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d19f9d2606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d19f9d1184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d19f9e2559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55d19f9d3162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d19f9d1184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x55d19f9ef9fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55d19f9f017c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x55d19fab39ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55d19f9da7ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d19f9d6516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d19f9e2802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x55d19f9efadc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d19f9d6516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d19f9e2802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d19f9d2606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d19f9d1184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d19f9e2559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d19f9d2606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d19f9e2802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55d19f9d2352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d19f9d1184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d19f9e2559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55d19f9d3162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d19f9d1184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55d19f9d0e58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55d19f9d0e09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55d19fa7e4ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x55d19faab87a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x55d19faa7c03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55d19fa9fa1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55d19fa9f90c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55d19fa9eb47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55d19fa722e7]
=================================
2024-03-24 06:38:21,927 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:41625' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('random_sample-922b98014ffe0e19fd139bfcedfd2029', 3, 3), ('sum-e94d60bab88a2bc36ceded9145967686', 3, 3), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 8, 7), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 0, 6), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 6, 3), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 3, 5), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 1, 2), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 5, 8), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 4, 8), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 5), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 2, 4)} (stimulus_id='handle-worker-cleanup-1711262301.9273965')
2024-03-24 06:38:21,927 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7f3c93b95240, tag: 0x9a8db8eb1f0e00c0, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f3c93b95240, tag: 0x9a8db8eb1f0e00c0, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-24 06:38:21,926 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fbaf57e7200, tag: 0x6159f3ffa8dd99bd, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fbaf57e7200, tag: 0x6159f3ffa8dd99bd, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-24 06:38:21,927 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7fc8c979f140, tag: 0xc5d7fb4a824d06d9, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7fc8c979f140, tag: 0xc5d7fb4a824d06d9, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-24 06:38:21,932 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 467, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1016, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 328, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 60, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 469, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-03-24 06:38:21,946 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:45913
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7fbaf57e71c0, tag: 0xc768be60f7759431, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7fbaf57e71c0, tag: 0xc768be60f7759431, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-24 06:38:21,946 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55955 -> ucx://127.0.0.1:45913
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3c93b95180, tag: 0x7c6e15f385b5c063, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-24 06:38:21,947 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:45913' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('sum-e94d60bab88a2bc36ceded9145967686', 6, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 4, 4), ('sum-e94d60bab88a2bc36ceded9145967686', 9, 6), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 6, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 5, 2), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 6), ('sum-e94d60bab88a2bc36ceded9145967686', 4, 4), ('sum-e94d60bab88a2bc36ceded9145967686', 8, 8), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 8, 8), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 1, 8), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 6, 4), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 0, 7)} (stimulus_id='handle-worker-cleanup-1711262301.9472835')
2024-03-24 06:38:21,970 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f723f28a1c0, tag: 0x126c2c70a029924c, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f723f28a1c0, tag: 0x126c2c70a029924c, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-24 06:38:21,997 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:49035 -> ucx://127.0.0.1:41315
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f723f28a2c0, tag: 0x39a832523670eb45, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-24 06:38:21,997 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:54361 -> ucx://127.0.0.1:41315
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fc8c979f200, tag: 0xb2e39ac0b7e976fe, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-24 06:38:21,997 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55955 -> ucx://127.0.0.1:41315
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7f3c93b95100, tag: 0x3adc939c1260334d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1783, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7f3c93b95100, tag: 0x3adc939c1260334d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-24 06:38:21,998 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:53055 -> ucx://127.0.0.1:45913
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f86101c4300, tag: 0x1d051975cdf7b22a, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-24 06:38:21,998 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:41315' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('random_sample-922b98014ffe0e19fd139bfcedfd2029', 5, 3), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 1, 6), ('sum-e94d60bab88a2bc36ceded9145967686', 9, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 7, 3), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 5, 5), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 1), ('sum-e94d60bab88a2bc36ceded9145967686', 5, 5), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 1, 7), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 0, 8), ('sum-e94d60bab88a2bc36ceded9145967686', 7, 1), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 7, 1), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 2, 1), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 4, 5), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 6, 7), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 4, 1)} (stimulus_id='handle-worker-cleanup-1711262301.99832')
2024-03-24 06:38:21,998 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41315
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f723f28a200, tag: 0x795dcdb096d80461, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f723f28a200, tag: 0x795dcdb096d80461, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-24 06:38:21,998 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41315
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f3c93b951c0, tag: 0xad265b00622c1949, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f3c93b951c0, tag: 0xad265b00622c1949, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-24 06:38:21,998 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41315
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fc8c979f100, tag: 0x77f6fabd808b653d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fc8c979f100, tag: 0x77f6fabd808b653d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-24 06:38:21,998 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:53055 -> ucx://127.0.0.1:41315
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f86101c4240, tag: 0x74d6f5bb66a224c3, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-24 06:38:21,998 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:54509 -> ucx://127.0.0.1:41625
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fbaf57e7280, tag: 0xbb78505d7d4c0df0, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-24 06:38:21,999 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41315
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f86101c4180, tag: 0xffd0a8964dcd7a7b, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f86101c4180, tag: 0xffd0a8964dcd7a7b, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-24 06:38:21,999 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:54509 -> ucx://127.0.0.1:45913
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fbaf57e7340, tag: 0x28c89436faac79f3, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-24 06:38:22,000 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:54509 -> ucx://127.0.0.1:41315
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fbaf57e72c0, tag: 0x67a7f26aec0263b7, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-24 06:38:23,662 - distributed.nanny - WARNING - Restarting worker
2024-03-24 06:38:23,664 - distributed.nanny - WARNING - Restarting worker
2024-03-24 06:38:23,683 - distributed.nanny - WARNING - Restarting worker
[dgx13:57698:0:57698] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  57698) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f9d81097d0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2df04) [0x7f9d81097f04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2e0ca) [0x7f9d810980ca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f9dba805420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f9d8111a9c7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f9d81144dcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x21b3f) [0x7f9d8104db3f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24d18) [0x7f9d81050d18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f9d810a1609]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f9d8104fe2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f9d8111789a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f9d811d806a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x563590c8e516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x563590c89184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563590c9a559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563590c8a606]
16  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x563590c9a802]
17  /opt/conda/envs/gdf/bin/python(+0x14cbb3) [0x563590ca7bb3]
18  /opt/conda/envs/gdf/bin/python(+0x25842c) [0x563590db342c]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x563590c4d66c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x563590c91833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x563590c8f824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x563590c9a802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563590c8a606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x563590c9a802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563590c8a606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x563590c9a802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563590c8a606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x563590c9a802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563590c8a606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x563590c89184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563590c9a559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x563590c8b162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x563590c89184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x563590ca79fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x563590ca817c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x563590d6b9ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x563590c927ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x563590c8e516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x563590c9a802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x563590ca7adc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x563590c8e516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x563590c9a802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563590c8a606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x563590c89184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563590c9a559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x563590c8a606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x563590c9a802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x563590c8a352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x563590c89184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x563590c9a559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x563590c8b162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x563590c89184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x563590c88e58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x563590c88e09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x563590d364ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x563590d6387a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x563590d5fc03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x563590d57a1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x563590d5790c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x563590d56b47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x563590d2a2e7]
=================================
[dgx13:57690:0:57690] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
[dgx13:57521:0:57521] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  57690) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f93b8aa2d0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2df04) [0x7f93b8aa2f04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2e0ca) [0x7f93b8aa30ca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f93f21f0420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f93b8b259c7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f93b8b4fdcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x21b3f) [0x7f93b8a58b3f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24d18) [0x7f93b8a5bd18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f93b8aac609]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f93b8a5ae2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f93b8b2289a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f93b8be306a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5616708f5516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5616708f0184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561670901559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5616708f1606]
16  /opt/conda/envs/gdf/bin/python(+0x1e28a2) [0x5616709a48a2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f93dc30d1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5616708f97ac]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x5616708b466c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x5616708f8833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x5616708f6824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x561670901802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5616708f1606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x561670901802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5616708f1606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x561670901802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5616708f1606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x561670901802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5616708f1606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5616708f0184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561670901559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5616708f2162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5616708f0184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x56167090e9fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56167090f17c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x5616709d29ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5616708f97ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5616708f5516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x561670901802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x56167090eadc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5616708f5516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x561670901802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5616708f1606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5616708f0184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561670901559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5616708f1606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x561670901802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5616708f1352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5616708f0184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561670901559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5616708f2162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5616708f0184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5616708efe58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5616708efe09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56167099d4ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x5616709ca87a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x5616709c6c03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5616709bea1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5616709be90c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5616709bdb47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5616709912e7]
=================================
==== backtrace (tid:  57521) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f723f587d0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2df04) [0x7f723f587f04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2e0ca) [0x7f723f5880ca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f7288e9b420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f723f60a9c7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f723f634dcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x21b3f) [0x7f723f53db3f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24d18) [0x7f723f540d18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f723f591609]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f723f53fe2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f723f60789a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f723f6c806a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5556d4911516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5556d490c184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5556d491d559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5556d490d606]
16  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5556d491d802]
17  /opt/conda/envs/gdf/bin/python(+0x14cbb3) [0x5556d492abb3]
18  /opt/conda/envs/gdf/bin/python(+0x25842c) [0x5556d4a3642c]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x5556d48d066c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x5556d4914833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x5556d4912824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5556d491d802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5556d490d606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5556d491d802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5556d490d606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5556d491d802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5556d490d606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5556d491d802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5556d490d606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5556d490c184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5556d491d559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5556d490e162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5556d490c184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x5556d492a9fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5556d492b17c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x5556d49ee9ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5556d49157ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5556d4911516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5556d491d802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x5556d492aadc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5556d4911516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5556d491d802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5556d490d606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5556d490c184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5556d491d559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5556d490d606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5556d491d802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5556d490d352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5556d490c184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5556d491d559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5556d490e162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5556d490c184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5556d490be58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5556d490be09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5556d49b94ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x5556d49e687a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x5556d49e2c03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5556d49daa1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5556d49da90c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5556d49d9b47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5556d49ad2e7]
=================================
2024-03-24 06:38:26,989 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:54509 -> ucx://127.0.0.1:57105
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fbaf57e7180, tag: 0x755fa792af19324a, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-24 06:38:26,989 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:57105' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('sum-e94d60bab88a2bc36ceded9145967686', 7, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 7), ('sum-e94d60bab88a2bc36ceded9145967686', 6, 2), ('sum-e94d60bab88a2bc36ceded9145967686', 9, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 2, 6), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 7, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 6), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 6, 2), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 5)} (stimulus_id='handle-worker-cleanup-1711262306.989477')
2024-03-24 06:38:27,239 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49035
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fc8c979f180, tag: 0x93647afa83421af5, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fc8c979f180, tag: 0x93647afa83421af5, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-03-24 06:38:27,239 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:49035' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('random_sample-922b98014ffe0e19fd139bfcedfd2029', 3, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 2, 7), ('sum-e94d60bab88a2bc36ceded9145967686', 9, 3), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 1, 0), ('sum-e94d60bab88a2bc36ceded9145967686', 3, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 3), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 1, 9), ('sum-e94d60bab88a2bc36ceded9145967686', 7, 2), ('sum-e94d60bab88a2bc36ceded9145967686', 2, 7), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 3, 4), ('sum-e94d60bab88a2bc36ceded9145967686', 4, 3), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 6, 8), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 8, 5), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 5, 1), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 0, 1)} (stimulus_id='handle-worker-cleanup-1711262307.2395766')
2024-03-24 06:38:27,240 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:54361 -> ucx://127.0.0.1:49035
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7fc8c979f240, tag: 0x42f2ce473f00237, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1783, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7fc8c979f240, tag: 0x42f2ce473f00237, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-24 06:38:27,296 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:60069' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('sum-e94d60bab88a2bc36ceded9145967686', 8, 8), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 8, 8), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 1)} (stimulus_id='handle-worker-cleanup-1711262307.2959414')
2024-03-24 06:38:28,102 - distributed.nanny - WARNING - Restarting worker
2024-03-24 06:38:28,582 - distributed.nanny - WARNING - Restarting worker
2024-03-24 06:38:28,606 - distributed.nanny - WARNING - Restarting worker
[dgx13:57751:0:57751] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  57751) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7faf50dafd0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2df04) [0x7faf50daff04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2e0ca) [0x7faf50db00ca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7faf8a50c420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7faf50e329c7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7faf50e5cdcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x21b3f) [0x7faf50d65b3f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24d18) [0x7faf50d68d18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7faf50db9609]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7faf50d67e2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7faf50e2f89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7faf50ef006a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x557409a7d516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x557409a78184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x557409a89559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557409a79606]
16  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x557409a89802]
17  /opt/conda/envs/gdf/bin/python(+0x14cbb3) [0x557409a96bb3]
18  /opt/conda/envs/gdf/bin/python(+0x25842c) [0x557409ba242c]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x557409a3c66c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x557409a80833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x557409a7e824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x557409a89802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557409a79606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x557409a89802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557409a79606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x557409a89802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557409a79606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x557409a89802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557409a79606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x557409a78184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x557409a89559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x557409a7a162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x557409a78184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x557409a969fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x557409a9717c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x557409b5a9ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x557409a817ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x557409a7d516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x557409a89802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x557409a96adc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x557409a7d516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x557409a89802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557409a79606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x557409a78184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x557409a89559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x557409a79606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x557409a89802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x557409a79352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x557409a78184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x557409a89559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x557409a7a162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x557409a78184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x557409a77e58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x557409a77e09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x557409b254ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x557409b5287a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x557409b4ec03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x557409b46a1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x557409b4690c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x557409b45b47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x557409b192e7]
=================================
2024-03-24 06:38:31,564 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:54509 -> ucx://127.0.0.1:35445
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fbaf57e7140, tag: 0x312f62582bc4fefd, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-24 06:38:31,565 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:35445' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 7), ('sum-e94d60bab88a2bc36ceded9145967686', 9, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 3), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 6), ('sum-e94d60bab88a2bc36ceded9145967686', 9, 8), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 5)} (stimulus_id='handle-worker-cleanup-1711262311.564938')
2024-03-24 06:38:31,569 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35445
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 467, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1016, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 328, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 60, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 469, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-03-24 06:38:31,581 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35445
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1558, in _connect
    async def _connect(self, addr: str, timeout: float | None = None) -> Comm:
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-03-24 06:38:32,111 - distributed.nanny - WARNING - Restarting worker
[dgx13:57760:0:57760] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  57760) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f15293b0d0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2df04) [0x7f15293b0f04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2e0ca) [0x7f15293b10ca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f1566b20420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f15294339c7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f152945ddcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x21b3f) [0x7f1529366b3f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24d18) [0x7f1529369d18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f15293ba609]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f1529368e2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f152943089a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f15294f106a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d823f21516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d823f1c184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d823f2d559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d823f1d606]
16  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d823f2d802]
17  /opt/conda/envs/gdf/bin/python(+0x14cbb3) [0x55d823f3abb3]
18  /opt/conda/envs/gdf/bin/python(+0x25842c) [0x55d82404642c]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x55d823ee066c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x55d823f24833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x55d823f22824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d823f2d802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d823f1d606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d823f2d802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d823f1d606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d823f2d802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d823f1d606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d823f2d802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d823f1d606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d823f1c184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d823f2d559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55d823f1e162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d823f1c184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x55d823f3a9fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55d823f3b17c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x55d823ffe9ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55d823f257ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d823f21516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d823f2d802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x55d823f3aadc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55d823f21516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d823f2d802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d823f1d606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d823f1c184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d823f2d559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55d823f1d606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55d823f2d802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55d823f1d352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d823f1c184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55d823f2d559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55d823f1e162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55d823f1c184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55d823f1be58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55d823f1be09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55d823fc94ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x55d823ff687a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x55d823ff2c03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55d823feaa1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55d823fea90c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55d823fe9b47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55d823fbd2e7]
=================================
2024-03-24 06:38:33,038 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:45397
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f86101c4200, tag: 0xc8bfbbcdb39f48a, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f86101c4200, tag: 0xc8bfbbcdb39f48a, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-03-24 06:38:33,039 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:53055 -> ucx://127.0.0.1:45397
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f86101c4380, tag: 0x565ecff28ce32f1f, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-24 06:38:33,042 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:45397' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('random_sample-922b98014ffe0e19fd139bfcedfd2029', 4, 8), ('sum-e94d60bab88a2bc36ceded9145967686', 9, 6), ('sum-e94d60bab88a2bc36ceded9145967686', 1, 5), ('sum-e94d60bab88a2bc36ceded9145967686', 4, 4), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 6, 2), ('sum-e94d60bab88a2bc36ceded9145967686', 5, 5), ('sum-e94d60bab88a2bc36ceded9145967686', 6, 4), ('sum-e94d60bab88a2bc36ceded9145967686', 5, 2), ('sum-e94d60bab88a2bc36ceded9145967686', 5, 8), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 6, 8), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 8, 5), ('sum-e94d60bab88a2bc36ceded9145967686', 8, 4), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 4, 4), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 5, 3), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 9, 6), ('sum-e94d60bab88a2bc36ceded9145967686', 4, 6), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 6, 4), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 8, 4), ('sum-e94d60bab88a2bc36ceded9145967686', 6, 9), ('sum-e94d60bab88a2bc36ceded9145967686', 2, 5), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 5, 2), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 4, 6), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 5, 5), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 5, 8), ('sum-e94d60bab88a2bc36ceded9145967686', 4, 8), ('sum-partial-df42d17fb136976e755a23e0250da744', 1, 1), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 6, 9), ('sum-e94d60bab88a2bc36ceded9145967686', 8, 5), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 8, 9), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 2, 5), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 7, 1), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 5, 1), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 4, 5)} (stimulus_id='handle-worker-cleanup-1711262313.0424192')
2024-03-24 06:38:33,050 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:45397
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 467, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1016, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 328, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 60, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 469, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
[dgx13:57543:0:57543] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  57543) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fc8c9aa4d0d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2df04) [0x7fc8c9aa4f04]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2e0ca) [0x7fc8c9aa50ca]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fc9073b0420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fc8c9b279c7]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fc8c9b51dcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x21b3f) [0x7fc8c9a5ab3f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x24d18) [0x7fc8c9a5dd18]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fc8c9aae609]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fc8c9a5ce2d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fc8c9b2489a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fc8c9be506a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5609ead77516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5609ead72184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5609ead83559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5609ead73606]
16  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5609ead83802]
17  /opt/conda/envs/gdf/bin/python(+0x14cbb3) [0x5609ead90bb3]
18  /opt/conda/envs/gdf/bin/python(+0x25842c) [0x5609eae9c42c]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x5609ead3666c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x5609ead7a833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x5609ead78824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5609ead83802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5609ead73606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5609ead83802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5609ead73606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5609ead83802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5609ead73606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5609ead83802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5609ead73606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5609ead72184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5609ead83559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5609ead74162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5609ead72184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x5609ead909fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5609ead9117c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x5609eae549ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5609ead7b7ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5609ead77516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5609ead83802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x5609ead90adc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5609ead77516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5609ead83802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5609ead73606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5609ead72184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5609ead83559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5609ead73606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x5609ead83802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5609ead73352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5609ead72184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5609ead83559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5609ead74162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x5609ead72184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5609ead71e58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5609ead71e09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5609eae1f4ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x5609eae4c87a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x5609eae48c03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5609eae40a1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5609eae4090c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5609eae3fb47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5609eae132e7]
=================================
2024-03-24 06:38:33,581 - distributed.nanny - WARNING - Restarting worker
2024-03-24 06:38:33,963 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54361
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #012] ep: 0x7fa6e74da1c0, tag: 0xb745aea1c34e41eb, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #012] ep: 0x7fa6e74da1c0, tag: 0xb745aea1c34e41eb, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-03-24 06:38:33,963 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54361
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f3c93b95280, tag: 0x8c080f3a14b4cb59, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f3c93b95280, tag: 0x8c080f3a14b4cb59, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-03-24 06:38:33,963 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55195 -> ucx://127.0.0.1:54361
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fa6e74da280, tag: 0x3775fecf6330af4f, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-24 06:38:33,964 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:54361' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('random_sample-922b98014ffe0e19fd139bfcedfd2029', 5, 0), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 0, 0), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 6, 0), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 6, 6), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 3, 8), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 1, 5), ('sum-e94d60bab88a2bc36ceded9145967686', 5, 1), ('random_sample-922b98014ffe0e19fd139bfcedfd2029', 1, 4)} (stimulus_id='handle-worker-cleanup-1711262313.96372')
2024-03-24 06:38:33,964 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55955 -> ucx://127.0.0.1:54361
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7f3c93b952c0, tag: 0x70278ae43c0d7c12, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1783, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7f3c93b952c0, tag: 0x70278ae43c0d7c12, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-24 06:38:34,531 - distributed.nanny - WARNING - Restarting worker
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
