2023-06-05 06:53:06,812 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-06-05 06:53:06,812 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-06-05 06:53:06,824 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-06-05 06:53:06,824 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-06-05 06:53:06,891 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-06-05 06:53:06,891 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-06-05 06:53:06,895 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-06-05 06:53:06,895 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-06-05 06:53:06,895 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-06-05 06:53:06,895 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-06-05 06:53:06,912 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-06-05 06:53:06,912 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-06-05 06:53:06,927 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-06-05 06:53:06,928 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-06-05 06:53:06,931 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-06-05 06:53:06,931 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:74455:0:74455] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74455) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fdd18aa9f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7fdd18aaa114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7fdd18aaa2da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fddb92ad420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fdd18b235d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fdd18b48859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2041f) [0x7fdd18a6541f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23788) [0x7fdd18a68788]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fdd18ab2989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fdd18a6761d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fdd18b20c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7fdd18bcb17a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x560c61be2b08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x560c61bd3112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x560c61bcc27a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x560c61bddc05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560c61bcd81b]
17  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x560c61bf270e]
18  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7fdd38e412fe]
19  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x560c61bd62bc]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x560c61b89817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x560c61bd4f83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x560c61bd2d36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560c61bddef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560c61bcd81b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560c61bddef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560c61bcd81b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560c61bddef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560c61bcd81b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560c61bddef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560c61bcd81b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x560c61bcc27a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x560c61bddc05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x560c61bd1fa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x560c61bcc27a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x560c61beb935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x560c61bec104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x560c61cb2fc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x560c61bd62bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x560c61bd11bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560c61bddef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x560c61bebc72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x560c61bd11bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560c61bddef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560c61bcd81b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x560c61bcc27a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x560c61bddc05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x560c61bcd81b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x560c61bddef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x560c61bcd568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x560c61bcc27a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x560c61bddc05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x560c61bce3cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x560c61bcc27a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x560c61bcbf07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x560c61bcbeb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x560c61c7c8bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x560c61caaadc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x560c61ca6c24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x560c61c9e7ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x560c61c9e6bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x560c61c9d8a2]
=================================
[dgx13:74441:0:74441] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74441) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fda107d4f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7fda107d5114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7fda107d52da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fdab0fe2420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fda1084e5d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fda10873859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2041f) [0x7fda1079041f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23788) [0x7fda10793788]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fda107dd989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fda1079261d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fda1084bc4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7fda108f617a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55e42f6fdb08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55e42f6ee112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e42f6e727a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e42f6f8c05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e42f6e881b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e42f6f8ef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x55e42f706a16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x55e42f8169b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55e42f6a4817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55e42f6eff83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55e42f6edd36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e42f6f8ef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e42f6e881b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e42f6f8ef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e42f6e881b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e42f6f8ef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e42f6e881b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e42f6f8ef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e42f6e881b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e42f6e727a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e42f6f8c05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55e42f6ecfa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e42f6e727a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55e42f706935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55e42f707104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55e42f7cdfc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55e42f6f12bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55e42f6ec1bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e42f6f8ef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55e42f706c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55e42f6ec1bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e42f6f8ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e42f6e881b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e42f6e727a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e42f6f8c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e42f6e881b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e42f6f8ef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55e42f6e8568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e42f6e727a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e42f6f8c05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55e42f6e93cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e42f6e727a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55e42f6e6f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55e42f6e6eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55e42f7978bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55e42f7c5adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55e42f7c1c24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55e42f7b97ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55e42f7b96bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x55e42f7b88a2]
=================================
2023-06-05 06:53:10,584 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40833
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f5c11c35140, tag: 0x1bfe8a731468eb82, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f5c11c35140, tag: 0x1bfe8a731468eb82, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-06-05 06:53:10,589 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:35791 -> ucx://127.0.0.1:40833
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f7a7044a240, tag: 0x45baab36d4c66af7, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-06-05 06:53:10,594 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40833
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-06-05 06:53:10,640 - distributed.nanny - WARNING - Restarting worker
2023-06-05 06:53:10,660 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43819
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f5c11c35180, tag: 0x5d998a6355ca2933, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f5c11c35180, tag: 0x5d998a6355ca2933, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-06-05 06:53:10,660 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43819
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f7f41f66100, tag: 0x2488010bb1b8215c, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f7f41f66100, tag: 0x2488010bb1b8215c, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-06-05 06:53:10,660 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43819
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f7a7044a100, tag: 0xad6346a8483071f2, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f7a7044a100, tag: 0xad6346a8483071f2, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-06-05 06:53:10,661 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48781 -> ucx://127.0.0.1:43819
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f5c11c35300, tag: 0xfdf712d72ad2fb16, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-06-05 06:53:10,661 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:58875 -> ucx://127.0.0.1:43819
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7f7f41f662c0, tag: 0x619c6503402a9067, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1793, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7f7f41f662c0, tag: 0x619c6503402a9067, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-06-05 06:53:10,660 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38593 -> ucx://127.0.0.1:43819
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f21276842c0, tag: 0x6d3ab4e177a83ad2, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-06-05 06:53:10,723 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43819
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fd6d028e200, tag: 0x30c18b92f372da5c, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fd6d028e200, tag: 0x30c18b92f372da5c, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-06-05 06:53:10,754 - distributed.nanny - WARNING - Restarting worker
[dgx13:74445:0:74445] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74445) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fce19501f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7fce19502114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7fce195022da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fcebdc02420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fce1957b5d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fce195a0859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2041f) [0x7fce2c03a41f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23788) [0x7fce2c03d788]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fce1950a989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fce2c03c61d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fce19578c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7fce1962317a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55b01a0f0b08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55b01a0e1112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55b01a0da27a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55b01a0ebc05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b01a0db81b]
17  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55b01a10070e]
18  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7fce3d7932fe]
19  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55b01a0e42bc]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55b01a097817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55b01a0e2f83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55b01a0e0d36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b01a0ebef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b01a0db81b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b01a0ebef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b01a0db81b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b01a0ebef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b01a0db81b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b01a0ebef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b01a0db81b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55b01a0da27a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55b01a0ebc05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55b01a0dffa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55b01a0da27a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55b01a0f9935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55b01a0fa104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55b01a1c0fc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55b01a0e42bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55b01a0df1bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b01a0ebef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55b01a0f9c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55b01a0df1bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b01a0ebef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b01a0db81b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55b01a0da27a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55b01a0ebc05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b01a0db81b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b01a0ebef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55b01a0db568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55b01a0da27a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55b01a0ebc05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55b01a0dc3cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55b01a0da27a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55b01a0d9f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55b01a0d9eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55b01a18a8bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55b01a1b8adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55b01a1b4c24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55b01a1ac7ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55b01a1ac6bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x55b01a1ab8a2]
=================================
[dgx13:74450:0:74450] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74450) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f7f44251f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f7f44252114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f7f442522da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f7fe4a47420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f7f442cb5d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f7f442f0859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2041f) [0x7f7f4420d41f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23788) [0x7f7f44210788]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f7f4425a989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f7f4420f61d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f7f442c8c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7f7f4437317a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x5648f9e83b08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x5648f9e74112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5648f9e6d27a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5648f9e7ec05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5648f9e6e81b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5648f9e7eef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x5648f9e8ca16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x5648f9f9c9b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5648f9e2a817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x5648f9e75f83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5648f9e73d36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5648f9e7eef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5648f9e6e81b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5648f9e7eef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5648f9e6e81b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5648f9e7eef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5648f9e6e81b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5648f9e7eef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5648f9e6e81b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5648f9e6d27a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5648f9e7ec05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5648f9e72fa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5648f9e6d27a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x5648f9e8c935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5648f9e8d104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x5648f9f53fc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5648f9e772bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5648f9e721bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5648f9e7eef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x5648f9e8cc72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5648f9e721bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5648f9e7eef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5648f9e6e81b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5648f9e6d27a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5648f9e7ec05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5648f9e6e81b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5648f9e7eef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5648f9e6e568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5648f9e6d27a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5648f9e7ec05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5648f9e6f3cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5648f9e6d27a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5648f9e6cf07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5648f9e6ceb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5648f9f1d8bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x5648f9f4badc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x5648f9f47c24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5648f9f3f7ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5648f9f3f6bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x5648f9f3e8a2]
=================================
2023-06-05 06:53:10,973 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46289
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fd6d028e140, tag: 0xa8f284ab4713865e, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fd6d028e140, tag: 0xa8f284ab4713865e, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-06-05 06:53:10,973 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38593 -> ucx://127.0.0.1:46289
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f2127684300, tag: 0xad4293a6ffec7576, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-06-05 06:53:10,974 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48781 -> ucx://127.0.0.1:46289
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f5c11c35340, tag: 0x515619072a548285, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-06-05 06:53:10,974 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:47947 -> ucx://127.0.0.1:46289
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7fd6d028e300, tag: 0xbefc74d76909f33c, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1793, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7fd6d028e300, tag: 0xbefc74d76909f33c, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-06-05 06:53:10,974 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46289
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f7a7044a1c0, tag: 0x7b36f05549ff32da, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f7a7044a1c0, tag: 0x7b36f05549ff32da, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-06-05 06:53:10,974 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46289
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f2127684180, tag: 0xc523d518d2c13fe4, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f2127684180, tag: 0xc523d518d2c13fe4, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-06-05 06:53:10,974 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46289
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f5c11c351c0, tag: 0x975cce9c5cd37d1d, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f5c11c351c0, tag: 0x975cce9c5cd37d1d, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-06-05 06:53:11,024 - distributed.nanny - WARNING - Restarting worker
2023-06-05 06:53:11,052 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:48781 -> ucx://127.0.0.1:58875
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f5c11c35300, tag: 0x7e4ab0344639e273, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-06-05 06:53:11,119 - distributed.nanny - WARNING - Restarting worker
2023-06-05 06:53:12,163 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-06-05 06:53:12,163 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-06-05 06:53:12,209 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-06-05 06:53:12,209 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-06-05 06:53:12,508 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-06-05 06:53:12,508 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-06-05 06:53:12,599 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-06-05 06:53:12,599 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-06-05 06:53:40,270 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40833
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 490, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 492, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 318, in connect
    raise OSError(
OSError: Timed out trying to connect to ucx://127.0.0.1:40833 after 30 s
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
