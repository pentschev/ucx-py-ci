[dgx13:80437:0:80437] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80437) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f7d4f4460cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f7d4f4462c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f7d4f44648a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f7dffbaa420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f7d4f4c5674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f7d4f4ee7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f7d4f4003df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f7d4f403838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f7d4f44f4f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f7d4f4025dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f7d4f4c289a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f7d4f5835fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ec9b2406fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ec9b23c094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ec9b24d519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec9b23d5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec9b24d7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55ec9b25ae83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55ec9b365b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55ec9b1f7d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55ec9b2447f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55ec9b242929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec9b24d7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec9b23d5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec9b24d7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec9b23d5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec9b24d7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec9b23d5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec9b24d7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec9b23d5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ec9b23c094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ec9b24d519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55ec9b23e128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ec9b23c094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55ec9b25accb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55ec9b25b44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55ec9b31e10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55ec9b24577c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ec9b2406fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec9b24d7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55ec9b25adac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ec9b2406fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec9b24d7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec9b23d5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ec9b23c094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ec9b24d519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ec9b23d5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ec9b24d7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55ec9b23d312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ec9b23c094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ec9b24d519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55ec9b23e128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ec9b23c094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55ec9b23bd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55ec9b23bd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55ec9b2e907b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55ec9b315fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55ec9b312353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55ec9b30a16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55ec9b30a05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55ec9b309297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55ec9b2dcf07]
=================================
2023-09-16 07:29:00,331 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:49819 -> ucx://127.0.0.1:45611
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fe1073ff100, tag: 0xb8081f594adc7d09, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:29:00,416 - distributed.nanny - WARNING - Restarting worker
[dgx13:80434:0:80434] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80434) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd7dd40f0cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7fd7dd40f2c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7fd7dd40f48a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd881b90420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fd7dd48e674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fd7dd4b77f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fd7dd3c93df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fd7dd3cc838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd7dd4184f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd7dd3cb5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd7dd48b89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fd7dd54c5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5644d89cc6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5644d89c8094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5644d89d9519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5644d89c95c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5644d89d97c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x5644d89e6e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x5644d8af1b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5644d8983d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5644d89d07f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5644d89ce929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5644d89d97c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5644d89c95c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5644d89d97c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5644d89c95c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5644d89d97c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5644d89c95c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5644d89d97c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5644d89c95c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5644d89c8094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5644d89d9519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5644d89ca128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5644d89c8094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5644d89e6ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5644d89e744c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5644d8aaa10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5644d89d177c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5644d89cc6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5644d89d97c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5644d89e6dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5644d89cc6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5644d89d97c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5644d89c95c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5644d89c8094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5644d89d9519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5644d89c95c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5644d89d97c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5644d89c9312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5644d89c8094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5644d89d9519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5644d89ca128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5644d89c8094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5644d89c7d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5644d89c7d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5644d8a7507b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5644d8aa1fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5644d8a9e353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5644d8a9616a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5644d8a9605c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5644d8a95297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5644d8a68f07]
=================================
2023-09-16 07:29:00,982 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48001
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fe1073ff200, tag: 0xb8198021c24b2ecf, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fe1073ff200, tag: 0xb8198021c24b2ecf, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:29:00,982 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50265 -> ucx://127.0.0.1:48001
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f110ca61380, tag: 0x2204c2f325ad91a4, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:29:00,982 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48001
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fb9057ee180, tag: 0x555a0b3168214993, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fb9057ee180, tag: 0x555a0b3168214993, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:29:00,983 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48001
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f110ca61300, tag: 0x718ef7ef7e64f741, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f110ca61300, tag: 0x718ef7ef7e64f741, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:29:00,982 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48001
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7fa5e4e5f1c0, tag: 0xf61c513214f6ca39, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7fa5e4e5f1c0, tag: 0xf61c513214f6ca39, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
[dgx13:80440:0:80440] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80440) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f7b933530cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f7b933532c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f7b9335348a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f7c37ad4420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f7b933d2674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f7b933fb7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f7b9330d3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f7b93310838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f7b9335c4f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f7b9330f5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f7b933cf89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f7b934905fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ca5528e6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ca5528a094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ca5529b519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ca5528b5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ca5529b7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55ca552a8e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55ca553b3b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55ca55245d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55ca552927f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55ca55290929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ca5529b7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ca5528b5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ca5529b7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ca5528b5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ca5529b7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ca5528b5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ca5529b7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ca5528b5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ca5528a094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ca5529b519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55ca5528c128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ca5528a094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55ca552a8ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55ca552a944c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55ca5536c10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55ca5529377c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ca5528e6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ca5529b7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55ca552a8dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ca5528e6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ca5529b7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ca5528b5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ca5528a094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ca5529b519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ca5528b5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ca5529b7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55ca5528b312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ca5528a094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ca5529b519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55ca5528c128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ca5528a094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55ca55289d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55ca55289d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55ca5533707b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55ca55363fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55ca55360353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55ca5535816a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55ca5535805c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55ca55357297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55ca5532af07]
=================================
[dgx13:80428:0:80428] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80428) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fe1076860cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7fe1076862c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7fe10768648a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fe1abdda420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fe107705674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fe10772e7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fe1076403df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fe107643838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fe10768f4f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fe1076425dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fe10770289a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fe1077c35fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ab55f656fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ab55f61094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ab55f72519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ab55f625c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ab55f727c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55ab55f7fe83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55ab5608ab2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55ab55f1cd05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55ab55f697f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55ab55f67929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ab55f727c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ab55f625c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ab55f727c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ab55f625c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ab55f727c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ab55f625c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ab55f727c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ab55f625c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ab55f61094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ab55f72519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55ab55f63128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ab55f61094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55ab55f7fccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55ab55f8044c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55ab5604310e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55ab55f6a77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ab55f656fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ab55f727c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55ab55f7fdac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ab55f656fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ab55f727c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ab55f625c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ab55f61094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ab55f72519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ab55f625c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ab55f727c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55ab55f62312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ab55f61094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ab55f72519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55ab55f63128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ab55f61094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55ab55f60d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55ab55f60d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55ab5600e07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55ab5603afca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55ab56037353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55ab5602f16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55ab5602f05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55ab5602e297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55ab56001f07]
=================================
[dgx13:80431:0:80431] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80431) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f3934ed10cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f3934ed12c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f3934ed148a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f39d54a9420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f3934f50674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f3934f797f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f3934e8b3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f3934e8e838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f3934eda4f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f3934e8d5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f3934f4d89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f393500e5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5567dd4106fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5567dd40c094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5567dd41d519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5567dd40d5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5567dd4c0162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f39c82d21e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5567dd41577c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5567dd3c7d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5567dd4147f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5567dd412929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5567dd41d7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5567dd40d5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5567dd41d7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5567dd40d5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5567dd41d7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5567dd40d5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5567dd41d7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5567dd40d5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5567dd40c094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5567dd41d519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5567dd40e128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5567dd40c094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5567dd42accb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5567dd42b44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5567dd4ee10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5567dd41577c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5567dd4106fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5567dd41d7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5567dd42adac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5567dd4106fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5567dd41d7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5567dd40d5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5567dd40c094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5567dd41d519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5567dd40d5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5567dd41d7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5567dd40d312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5567dd40c094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5567dd41d519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5567dd40e128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5567dd40c094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5567dd40bd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5567dd40bd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5567dd4b907b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5567dd4e5fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5567dd4e2353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5567dd4da16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5567dd4da05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5567dd4d9297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5567dd4acf07]
=================================
2023-09-16 07:29:01,050 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:29:01,236 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41879
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fb9057ee200, tag: 0xb595dc6a633c6bca, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fb9057ee200, tag: 0xb595dc6a633c6bca, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:29:01,236 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41879
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fa5e4e5f240, tag: 0x95854c07af2d75a6, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fa5e4e5f240, tag: 0x95854c07af2d75a6, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:29:01,236 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41879
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f110ca61240, tag: 0x1fed08b3a5b9535d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f110ca61240, tag: 0x1fed08b3a5b9535d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:29:01,237 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:46145 -> ucx://127.0.0.1:41879
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fb9057ee300, tag: 0xb812f722ee0e9ecd, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:29:01,238 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50265 -> ucx://127.0.0.1:41879
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f110ca61340, tag: 0x9517c6d797bb5665, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:29:01,277 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48749
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f110ca612c0, tag: 0x615750547cc41e50, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f110ca612c0, tag: 0x615750547cc41e50, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-09-16 07:29:01,279 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49819
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #011] ep: 0x7f110ca61280, tag: 0x62da6f109a8f1ce, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #011] ep: 0x7f110ca61280, tag: 0x62da6f109a8f1ce, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:29:01,304 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49819
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #011] ep: 0x7fa5e4e5f200, tag: 0xbd7c4d0db8a6ac1c, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #011] ep: 0x7fa5e4e5f200, tag: 0xbd7c4d0db8a6ac1c, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:29:01,311 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:29:01,306 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48749
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fa5e4e5f280, tag: 0xa7167d1f4a215bcc, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fa5e4e5f280, tag: 0xa7167d1f4a215bcc, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:29:01,321 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:46145 -> ucx://127.0.0.1:48749
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fb9057ee340, tag: 0xfdd7e11982a4869e, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:29:01,333 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48749
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fb9057ee240, tag: 0x957a9ac4a9d0f6c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fb9057ee240, tag: 0x957a9ac4a9d0f6c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:29:01,398 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:29:01,467 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:29:03,121 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-84a0276e6a854cf0d6c4324869a61d39', 2)
Function:  shuffle_group
args:      (                 key   payload
0         1018863339  99051695
1         1052208751  78953234
2          627278035  81293845
3         1053618300  74974697
4         1002090160  62919800
...              ...       ...
99999995    25213713  72068972
99999996  1049206659  33160153
99999997  1059655348  40095643
99999998  1052540937  33956372
99999999  1012812172  90324512

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-09-16 07:29:03,187 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-b0648aa7f9e27a40d5f4d39e31c5b5a2', 0)
Function:  shuffle_group
args:      (               key   payload
shuffle                     
0            11971  92223315
0            39628  13059990
0            11992  53206506
0            11994  89383623
0            11997  22289772
...            ...       ...
0        799998678  25662686
0        799998680  58313935
0        799998687  85189372
0        799983246  27995040
0        799983262  99740813

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

[dgx13:80594:0:80594] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80594) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f17642290cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f17642292c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f176422948a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f18047f4420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f17642a8674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f17642d17f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f17641e33df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f17641e6838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f17642324f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f17641e55dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f17642a589a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f17643665fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5591e25136fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5591e250f094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5591e2520519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5591e25105c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5591e25c3162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f17852a21e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5591e251877c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5591e24cad05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5591e25177f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5591e2515929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5591e25207c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5591e25105c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5591e25207c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5591e25105c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5591e25207c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5591e25105c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5591e25207c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5591e25105c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5591e250f094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5591e2520519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5591e2511128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5591e250f094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5591e252dccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5591e252e44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5591e25f110e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5591e251877c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5591e25136fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5591e25207c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5591e252ddac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5591e25136fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5591e25207c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5591e25105c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5591e250f094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5591e2520519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5591e25105c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5591e25207c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5591e2510312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5591e250f094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5591e2520519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5591e2511128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5591e250f094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5591e250ed68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5591e250ed19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5591e25bc07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5591e25e8fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5591e25e5353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5591e25dd16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5591e25dd05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5591e25dc297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5591e25aff07]
=================================
2023-09-16 07:29:07,078 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:33117 -> ucx://127.0.0.1:56643
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fa5e4e5f200, tag: 0xca91b4c8bc5ffeb3, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:29:07,078 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:56643
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7fb9057ee280, tag: 0xf11f295218bc8769, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7fb9057ee280, tag: 0xf11f295218bc8769, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-09-16 07:29:07,078 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:56643
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f110ca613c0, tag: 0x9f8b2a758433f1a0, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f110ca613c0, tag: 0x9f8b2a758433f1a0, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:29:07,080 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:56643
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fa5e4e5f2c0, tag: 0xf8ef481c97c03599, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fa5e4e5f2c0, tag: 0xf8ef481c97c03599, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:29:07,080 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50265 -> ucx://127.0.0.1:56643
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f110ca61140, tag: 0x81574c3c5576490c, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:29:07,142 - distributed.nanny - WARNING - Restarting worker
[dgx13:80605:0:80605] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80605) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f4c81e1d0cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f4c81e1d2c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f4c81e1d48a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f4d26428420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f4c81e9c674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f4c81ec57f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f4c81dd73df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f4c81dda838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f4c81e264f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f4c81dd95dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f4c81e9989a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f4c81f5a5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x560f599b56fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560f599b1094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560f599c2519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560f599b25c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560f599c27c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x560f599cfe83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x560f59adab2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x560f5996cd05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x560f599b97f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x560f599b7929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560f599c27c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560f599b25c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560f599c27c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560f599b25c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560f599c27c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560f599b25c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560f599c27c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560f599b25c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560f599b1094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560f599c2519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x560f599b3128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560f599b1094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x560f599cfccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x560f599d044c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x560f59a9310e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x560f599ba77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x560f599b56fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560f599c27c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x560f599cfdac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x560f599b56fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560f599c27c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560f599b25c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560f599b1094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560f599c2519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x560f599b25c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x560f599c27c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x560f599b2312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560f599b1094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x560f599c2519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x560f599b3128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x560f599b1094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x560f599b0d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x560f599b0d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x560f59a5e07b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x560f59a8afca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x560f59a87353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x560f59a7f16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x560f59a7f05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x560f59a7e297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x560f59a51f07]
=================================
2023-09-16 07:29:10,144 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:46145 -> ucx://127.0.0.1:35323
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fb9057ee340, tag: 0x66bca0e9fd51c325, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:29:10,144 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35323
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f110ca61140, tag: 0xb775c8991412e7d7, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f110ca61140, tag: 0xb775c8991412e7d7, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:29:10,144 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:33117 -> ucx://127.0.0.1:35323
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fa5e4e5f200, tag: 0x438bfbd876786880, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:29:10,145 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35323
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fb9057ee280, tag: 0x4b71d89fc43db7c3, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fb9057ee280, tag: 0x4b71d89fc43db7c3, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:29:10,145 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35323
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fa5e4e5f2c0, tag: 0x83f021ac8f262bae, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fa5e4e5f2c0, tag: 0x83f021ac8f262bae, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-09-16 07:29:10,213 - distributed.nanny - WARNING - Restarting worker
[dgx13:80424:0:80424] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80424) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fb905a470cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7fb905a472c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7fb905a4748a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fb9ac1cb420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fb905ac6674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fb905aef7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fb905a013df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fb905a04838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fb905a504f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fb905a035dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fb905ac389a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fb905b845fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x556bf0be76fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556bf0be3094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556bf0bf4519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556bf0be45c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556bf0bf47c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x556bf0c01e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x556bf0d0cb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x556bf0b9ed05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x556bf0beb7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x556bf0be9929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556bf0bf47c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556bf0be45c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556bf0bf47c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556bf0be45c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556bf0bf47c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556bf0be45c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556bf0bf47c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556bf0be45c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556bf0be3094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556bf0bf4519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x556bf0be5128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556bf0be3094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x556bf0c01ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x556bf0c0244c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x556bf0cc510e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x556bf0bec77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x556bf0be76fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556bf0bf47c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x556bf0c01dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x556bf0be76fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556bf0bf47c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556bf0be45c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556bf0be3094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556bf0bf4519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556bf0be45c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x556bf0bf47c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x556bf0be4312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556bf0be3094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556bf0bf4519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x556bf0be5128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x556bf0be3094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x556bf0be2d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x556bf0be2d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x556bf0c9007b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x556bf0cbcfca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x556bf0cb9353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x556bf0cb116a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x556bf0cb105c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x556bf0cb0297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x556bf0c83f07]
=================================
[dgx13:80420:0:80420] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80420) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fa5e50e60cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7fa5e50e62c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7fa5e50e648a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fa689837420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fa5e5165674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fa5e518e7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fa5e50a03df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fa5e50a3838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fa5e50ef4f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fa5e50a25dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fa5e516289a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fa5e52235fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5589f26fb6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5589f26f7094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5589f2708519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5589f26f85c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5589f27087c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x5589f2715e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x5589f2820b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5589f26b2d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5589f26ff7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5589f26fd929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5589f27087c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5589f26f85c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5589f27087c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5589f26f85c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5589f27087c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5589f26f85c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5589f27087c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5589f26f85c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5589f26f7094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5589f2708519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5589f26f9128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5589f26f7094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5589f2715ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5589f271644c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5589f27d910e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5589f270077c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5589f26fb6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5589f27087c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5589f2715dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5589f26fb6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5589f27087c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5589f26f85c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5589f26f7094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5589f2708519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5589f26f85c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5589f27087c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5589f26f8312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5589f26f7094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5589f2708519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5589f26f9128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5589f26f7094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5589f26f6d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5589f26f6d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5589f27a407b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5589f27d0fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5589f27cd353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5589f27c516a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5589f27c505c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5589f27c4297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5589f2797f07]
=================================
2023-09-16 07:29:10,760 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46145
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #131] ep: 0x7f110ca611c0, tag: 0xa6f9c0601b835336, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #131] ep: 0x7f110ca611c0, tag: 0xa6f9c0601b835336, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-09-16 07:29:10,760 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:36283 -> ucx://127.0.0.1:46145
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f65f4a51140, tag: 0xeb7b2071085f727a, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:29:10,769 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:36283 -> ucx://127.0.0.1:33117
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f65f4a51180, tag: 0x53a6800cc21cd8a7, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-09-16 07:29:10,769 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:33117
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #129] ep: 0x7f110ca61200, tag: 0xbe83af89ac447468, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #129] ep: 0x7f110ca61200, tag: 0xbe83af89ac447468, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-09-16 07:29:10,840 - distributed.worker - WARNING - Compute Failed
Key:       ('sort_index-86563d3c54ed11bf71e0c240596313fc', 0)
Function:  subgraph_callable-4bef1e9c-b9ee-4311-942b-f4e77e72
args:      ('set_index_post_scalar-ceb9308523ab39bbcf59f6dccd678d89',                 key  shuffle   payload  _partitions
0             92672        0  15018008            0
1             92677        0  66159660            0
2             92679        0  87638884            0
3             92688        0  72402378            0
4             42689        0   3792331            0
...             ...      ...       ...          ...
99999995  799993947        0  92698023            0
99999996  799993950        0  94764992            0
99999997  799993892        0  58451420            0
99999998  799993916        0  51247468            0
99999999  799993917        0    869974            0

[100000000 rows x 4 columns], 'simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e')
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-09-16 07:29:10,893 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:29:10,966 - distributed.worker - WARNING - Compute Failed
Key:       ('generate-data-5366301a596b755bb8c33997d3ce7726', 0)
Function:  generate_chunk
args:      (0, 100000000, 8, 'build', 0.3, True)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-09-16 07:29:10,975 - distributed.nanny - WARNING - Restarting worker
2023-09-16 07:29:11,061 - distributed.worker - WARNING - Compute Failed
Key:       ('generate-data-3393696d3757f92da87d0dddd0c6ae01', 4)
Function:  generate_chunk
args:      (4, 100000000, 8, 'other', 0.3, True)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-09-16 07:29:11,171 - distributed.worker - WARNING - Compute Failed
Key:       ('generate-data-3393696d3757f92da87d0dddd0c6ae01', 1)
Function:  generate_chunk
args:      (1, 100000000, 8, 'other', 0.3, True)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-09-16 07:29:14,579 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 7)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0            92703        7  63508162            7
1            42690        7  43408093            7
2            14032        7  36518455            7
3            23245        7  83512181            7
4           152768        7  42324478            7
...            ...      ...       ...          ...
12499995  99935675        7  86756851            7
12499996  99979770        7  99053197            7
12499997  99989453        7  23885083            7
12499998  99989460        7  83760290            7
12499999  99989471        7  24910826            7

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100020192        7    382129            7
1         100108257        7  11729376            7
2         100023176        7  47122724            7
3         100029830        7  87822314            7
4         100016610        7  96188796            7
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
