2023-05-03 05:46:56,997 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:46:56,997 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:46:57,021 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:46:57,021 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:46:57,043 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:46:57,043 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:46:57,062 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:46:57,062 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:46:57,069 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:46:57,069 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:46:57,070 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:46:57,070 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:46:57,071 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:46:57,072 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:46:57,087 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:46:57,087 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:79720:0:79720] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  79720) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f3959c69c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f3959c69dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f3959c6a134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f39fcf3e420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f3959cf3aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f3959d24b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f3959c1a427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f3959c1aa08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f3959c1cf2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f3959c74539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f3959c1cfdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f3959cf028a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f3959dae6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55d1379efb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55d1379e0112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d1379d927a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d1379eac05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d1379da81b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d1379eaef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x55d1379f8a16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x55d137b089b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55d137996817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55d1379e1f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55d1379dfd36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d1379eaef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d1379da81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d1379eaef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d1379da81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d1379eaef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d1379da81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d1379eaef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d1379da81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d1379d927a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d1379eac05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55d1379defa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d1379d927a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55d1379f8935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55d1379f9104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55d137abffc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55d1379e32bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55d1379de1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d1379eaef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55d1379f8c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55d1379de1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d1379eaef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d1379da81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d1379d927a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d1379eac05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d1379da81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d1379eaef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55d1379da568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d1379d927a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d1379eac05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55d1379db3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d1379d927a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55d1379d8f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55d1379d8eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55d137a898bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55d137ab7adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55d137ab3c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55d137aab7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55d137aab6bd]
=================================
[dgx13:79722:0:79722] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  79722) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f90f3842c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f90f3842dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f90f3843134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f9198ca3420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f90f38ccaa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f90f38fdb48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f90f37f3427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f90f37f3a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f90f37f5f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f90f384d539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f90f37f5fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f90f38c928a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f90f3a1b6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55639d68fb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55639d680112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55639d67927a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55639d68ac05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55639d67a81b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55639d69f70e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f918c0262fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55639d6832bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55639d636817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55639d681f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55639d67fd36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55639d68aef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55639d67a81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55639d68aef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55639d67a81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55639d68aef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55639d67a81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55639d68aef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55639d67a81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55639d67927a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55639d68ac05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55639d67efa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55639d67927a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55639d698935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55639d699104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55639d75ffc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55639d6832bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55639d67e1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55639d68aef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55639d698c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55639d67e1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55639d68aef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55639d67a81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55639d67927a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55639d68ac05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55639d67a81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55639d68aef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55639d67a568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55639d67927a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55639d68ac05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55639d67b3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55639d67927a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55639d678f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55639d678eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55639d7298bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55639d757adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55639d753c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55639d74b7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55639d74b6bd]
=================================
[dgx13:79715:0:79715] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  79715) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7eff9793ec1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7eff9793edff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7eff9793f134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f004ec1b420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7eff979c8aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7eff979f9b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7eff978ef427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7eff978efa08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7eff978f1f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7eff97949539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7eff978f1fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7eff979c528a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7eff97a836e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55e32533db08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55e32532e112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e32532727a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e325338c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e32532881b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55e32534d70e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7effce4e22fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55e3253312bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55e3252e4817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55e32532ff83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55e32532dd36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e325338ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e32532881b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e325338ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e32532881b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e325338ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e32532881b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e325338ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e32532881b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e32532727a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e325338c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55e32532cfa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e32532727a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55e325346935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55e325347104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55e32540dfc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55e3253312bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55e32532c1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e325338ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55e325346c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55e32532c1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e325338ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e32532881b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e32532727a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e325338c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e32532881b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e325338ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55e325328568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e32532727a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e325338c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55e3253293cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e32532727a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55e325326f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55e325326eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55e3253d78bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55e325405adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55e325401c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55e3253f97ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55e3253f96bd]
=================================
Task exception was never retrieved
future: <Task finished name='Task-1223' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-05-03 05:47:07,210 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42297 -> ucx://127.0.0.1:46427
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f36c8588440, tag: 0x2f15bd6b13d63913, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
Task exception was never retrieved
future: <Task finished name='Task-1228' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-05-03 05:47:07,212 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46427
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f36c8588100, tag: 0xc1123d718d254999, nbytes: 800000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f36c8588100, tag: 0xc1123d718d254999, nbytes: 800000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
Task exception was never retrieved
future: <Task finished name='Task-1189' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-05-03 05:47:07,213 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46427
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7f1e4126f180, tag: 0x5d997c80cdc7409, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 329, in connect
    handshake = await wait_for(comm.read(), time_left())
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f1e4126f180, tag: 0x5d997c80cdc7409, nbytes: 16, type: <class 'numpy.ndarray'>>: ")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 334, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:46427 after 30 s
Task exception was never retrieved
future: <Task finished name='Task-1219' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-05-03 05:47:07,282 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:47475
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f1e4126f140, tag: 0x6d3ad40dec21b372, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f1e4126f140, tag: 0x6d3ad40dec21b372, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-03 05:47:07,282 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:36311 -> ucx://127.0.0.1:47475
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1e4126f380, tag: 0xa1dd6397cd9f6ddc, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:07,278 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46427
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-05-03 05:47:07,290 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:36311 -> ucx://127.0.0.1:49581
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1e4126f3c0, tag: 0x84a9dbf66a0cd0fc, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:07,290 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49581
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7f3074130200, tag: 0xdf6c32d4a9821ff5, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 329, in connect
    handshake = await wait_for(comm.read(), time_left())
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f3074130200, tag: 0xdf6c32d4a9821ff5, nbytes: 16, type: <class 'numpy.ndarray'>>: ")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 334, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:49581 after 30 s
2023-05-03 05:47:07,290 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49581
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f1e4126f1c0, tag: 0x82e9c07dcd552b6e, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f1e4126f1c0, tag: 0x82e9c07dcd552b6e, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-03 05:47:07,297 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:07,297 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:47475
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXNotConnected: <stream_recv>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 468, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 316, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
Task exception was never retrieved
future: <Task finished name='Task-1264' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-05-03 05:47:07,315 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:47475
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f7828ca41c0, tag: 0x607de2cfbc66ce21, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f7828ca41c0, tag: 0x607de2cfbc66ce21, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-03 05:47:07,359 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:47475
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f36c8588240, tag: 0x5c9ef9f5769fe836, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f36c8588240, tag: 0x5c9ef9f5769fe836, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-03 05:47:07,321 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49581
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 329, in connect
    handshake = await wait_for(comm.read(), time_left())
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 469, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f7828ca4180, tag: 0x32f5075da93a91b9, nbytes: 16, type: <class 'numpy.ndarray'>>: ")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 334, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:49581 after 30 s
2023-05-03 05:47:07,407 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:47475
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 329, in connect
    handshake = await wait_for(comm.read(), time_left())
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 469, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f1286d35280, tag: 0xf6cb4272b17a25e8, nbytes: 16, type: <class 'numpy.ndarray'>>: ")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 334, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:47475 after 30 s
2023-05-03 05:47:07,407 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:49581
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 329, in connect
    handshake = await wait_for(comm.read(), time_left())
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 469, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f1286d35240, tag: 0xcd90a53a74ab5e2c, nbytes: 16, type: <class 'numpy.ndarray'>>: ")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 334, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:49581 after 30 s
2023-05-03 05:47:07,425 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:07,426 - distributed.nanny - WARNING - Restarting worker
[dgx13:79711:0:79711] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  79711) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f7829808c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f7829808dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f7829809134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f78ccafa420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f7829892aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f78298c3b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f78297b9427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f78297b9a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f78297bbf2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f7829813539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f78297bbfdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f782988f28a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f782994d6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x56431b00fb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x56431b000112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56431aff927a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56431b00ac05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56431affa81b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x56431b01f70e]
19  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x56431b000923]
20  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x56431b01f70e]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x56431b000923]
22  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x56431b01f70e]
23  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f784c3bc2fe]
24  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x56431b0032bc]
25  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x56431afb6817]
26  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x56431b001f83]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x56431afffd36]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56431b00aef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56431affa81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56431b00aef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56431affa81b]
32  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56431b00aef3]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56431affa81b]
34  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56431b00aef3]
35  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56431affa81b]
36  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56431aff927a]
37  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56431b00ac05]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x56431affefa7]
39  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56431aff927a]
40  /opt/conda/envs/gdf/bin/python(+0x147935) [0x56431b018935]
41  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x56431b019104]
42  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x56431b0dffc8]
43  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x56431b0032bc]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x56431affe1bb]
45  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56431b00aef3]
46  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x56431b018c72]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x56431affe1bb]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56431b00aef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56431affa81b]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56431aff927a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56431b00ac05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56431affa81b]
53  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56431b00aef3]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x56431affa568]
55  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56431aff927a]
56  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56431b00ac05]
57  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x56431affb3cb]
58  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56431aff927a]
59  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x56431aff8f07]
60  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56431aff8eb9]
61  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56431b0a98bb]
=================================
2023-05-03 05:47:07,644 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54149
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #009] ep: 0x7f3074130180, tag: 0xce2e38042b365ec2, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #009] ep: 0x7f3074130180, tag: 0xce2e38042b365ec2, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-05-03 05:47:07,644 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:36311 -> ucx://127.0.0.1:54149
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1e4126f340, tag: 0xaefdda3df3528f3b, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:07,645 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54149
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f1e4126f280, tag: 0x3445fd5ee1ae413a, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f1e4126f280, tag: 0x3445fd5ee1ae413a, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-03 05:47:07,648 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34715 -> ucx://127.0.0.1:54149
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1286d35340, tag: 0xec76db01540a970d, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:07,649 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54149
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f1286d351c0, tag: 0x9f31391e603573c2, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f1286d351c0, tag: 0x9f31391e603573c2, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-03 05:47:07,704 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:07,734 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42297 -> ucx://127.0.0.1:54149
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f36c8588300, tag: 0xc27068a473f0f7b7, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:07,735 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54149
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f36c8588280, tag: 0xfd8015d67db6bca4, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f36c8588280, tag: 0xfd8015d67db6bca4, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-03 05:47:08,828 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:08,828 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:09,058 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:09,058 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:09,201 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:09,201 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:09,220 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:09,220 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:09,487 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-84a0276e6a854cf0d6c4324869a61d39', 1)
Function:  <dask.layers.CallableLazyImport object at 0x7f0d2a
args:      ([                key   payload
31946     609301766  90562334
134371    806483104  95111846
31948     841238054  33373967
134392    857404246  80709128
134396    837543128  77556855
...             ...       ...
99986349  811098354  19471505
99986403  843458745  52464814
99986420  849699138  71392919
99986425  502238613  11450653
99986313  402173696  76274430

[12502120 rows x 2 columns],                 key   payload
11496     320811052  86042937
11500     920182072  72309059
72741     421579884  57088480
11506     716461298  89323727
72755     321035805  38486707
...             ...       ...
99998470  216595832  93973219
99998495  911390531  64729406
99998596  116703345  43221475
99998606  968302909  31448095
99998608  903778445  29300556

[12499414 rows x 2 columns],                  key   payload
31873     1051469116   8955829
31878     1064130204  78486132
11396     1037834306  55123412
31882     1009515761  36818094
11408     1018009762  49076612
...              ...       ...
9
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-05-03 05:47:09,670 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-84a0276e6a854cf0d6c4324869a61d39', 5)
Function:  <dask.layers.CallableLazyImport object at 0x7f0d2a
args:      ([                key   payload
31941     814889211  19930599
134368    839605561  83124806
31942     827379439  62224902
134369    820585575   4843611
134383    833645491  71299023
...             ...       ...
99986321  811137865  31513808
99986323  408941628    166886
99986325  859836760   6787416
99986329  207376929  91153993
99986334  804418274   1295276

[12498923 rows x 2 columns],                 key   payload
11499     624755270  41376459
11514     124900396  71248353
72736     908082607  24276637
11519     908417168  14682710
72739     622384917  19627211
...             ...       ...
99998598  961245075  66114992
99998602  911509502  79484534
99998607  946927929  81777774
99998610  968216640  98156635
99998612  947021236  82455248

[12501128 rows x 2 columns],                  key   payload
31884      125308011  12434678
11392     1028407171  99047905
11402     1025217534  21086548
11409     1044624375  66563289
11410      234394855  23036396
...              ...       ...
9
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-05-03 05:47:09,813 - distributed.core - ERROR - std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 373, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
2023-05-03 05:47:09,814 - distributed.worker - ERROR - std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 373, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
2023-05-03 05:47:09,820 - distributed.worker - ERROR - ('Unexpected response', {'op': 'get_data', 'keys': {"('split-simple-shuffle-b97b49bf1f4fa55d5e9cb449a2a42818', 6, 6)"}, 'who': 'ucx://127.0.0.1:36311', 'max_connections': None, 'reply': True})
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2902, in get_data_from_worker
    status = response["status"]
KeyError: 'status'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2904, in get_data_from_worker
    raise ValueError("Unexpected response", response)
ValueError: ('Unexpected response', {'op': 'get_data', 'keys': {"('split-simple-shuffle-b97b49bf1f4fa55d5e9cb449a2a42818', 6, 6)"}, 'who': 'ucx://127.0.0.1:36311', 'max_connections': None, 'reply': True})
[dgx13:80245:0:80245] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80245) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f6fa0032c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f6fa0032dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f6fa0033134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f7031215420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f6f8df6daa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f6f8df9eb48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f6f8defc427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f6f8defca08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f6f8defef2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f6fa003d539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f6f8defefdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f6f8df6a28a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f6fa00926e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x565350ecbb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x565350ebc112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x565350eb527a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x565350ec6c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x565350eb681b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x565350ec6ef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x565350ed4a16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x565350fe49b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x565350e72817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x565350ebdf83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x565350ebbd36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x565350ec6ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x565350eb681b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x565350ec6ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x565350eb681b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x565350ec6ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x565350eb681b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x565350ec6ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x565350eb681b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x565350eb527a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x565350ec6c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x565350ebafa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x565350eb527a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x565350ed4935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x565350ed5104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x565350f9bfc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x565350ebf2bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x565350eba1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x565350ec6ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x565350ed4c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x565350eba1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x565350ec6ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x565350eb681b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x565350eb527a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x565350ec6c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x565350eb681b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x565350ec6ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x565350eb6568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x565350eb527a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x565350ec6c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x565350eb73cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x565350eb527a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x565350eb4f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x565350eb4eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x565350f658bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x565350f93adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x565350f8fc24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x565350f877ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x565350f876bd]
=================================
2023-05-03 05:47:09,972 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-b97b49bf1f4fa55d5e9cb449a2a42818', 3)
Function:  <dask.layers.CallableLazyImport object at 0x7f0d2a
args:      ([               key   payload
shuffle                     
0           930159  12453774
0          1009472  90692106
0           709800  48167965
0           739544  96491575
0           931283  75375127
...            ...       ...
0        799862065  54310024
0        799866468   4377619
0        799928892  44511459
0        799978756   6803055
0        799859804  69310876

[12497076 rows x 2 columns],                key   payload
shuffle                     
1           326513  60846939
1           157443  22136342
1           182653  78633006
1            31611  46679609
1           465972  49773333
...            ...       ...
1        799931209  28663123
1        799857774  89749079
1        799828014  95783440
1        799955889  54781577
1        799835682  30815875

[12501362 rows x 2 columns],                key   payload
shuffle                     
2           236718  36608094
2           152116  86116406
2           105671  43882327
2           142909  74973032
2         
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-05-03 05:47:09,973 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-84a0276e6a854cf0d6c4324869a61d39', 7)
Function:  <dask.layers.CallableLazyImport object at 0x7f3178
args:      ([                key   payload
31936     820885180  16944189
134381    839576778   1378094
31940     843294877  70317547
134384    809412489  38733860
134389    805801435  81174858
...             ...       ...
99986364  837550820  43106056
99986413  822434531  10762731
99986429  840644819  71488864
99986431  818129420  10929969
99986306  819501344   6119170

[12500893 rows x 2 columns],                 key   payload
11494     906868113  47937112
11495     316708104  97338452
72737     912363126  65244285
11497     946593714  86670507
72746     927116357  65335798
...             ...       ...
99998618  929041081  35753025
99998620  931546376  55866446
99998621  941218178  32893944
99998622  116256929  49346169
99998623  519492805  71592438

[12495890 rows x 2 columns],                  key   payload
31880      135770687  13612820
31888     1054862076  76590686
11399      728563997  56006970
31891     1034484880  80138749
11405     1002827172  16864477
...              ...       ...
9
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-05-03 05:47:10,075 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:36311 -> ucx://127.0.0.1:58797
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f1e4126f280, tag: 0xca408bc4ac08d461, nbytes: 99987912, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
Task exception was never retrieved
future: <Task finished name='Task-2868' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-05-03 05:47:10,109 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-b97b49bf1f4fa55d5e9cb449a2a42818', 2)
Function:  <dask.layers.CallableLazyImport object at 0x7f3178
args:      ([               key   payload
shuffle                     
0           932716  69009543
0          1034286  44371054
0          1051176  26292402
0          1034292  71594317
0           914415  38972049
...            ...       ...
0        799809816  79823086
0        799951058  88804354
0        799837911  30525462
0        799974153  36967021
0        799854838  38433333

[12497244 rows x 2 columns],                key   payload
shuffle                     
1            15168  73543613
1           234294  42276295
1           442597  87529302
1           377655  65558510
1           356829  71145507
...            ...       ...
1        799887901  66711493
1        799835680  98263407
1        799855761  98530657
1        799860833  56390519
1        799850038  58537382

[12500558 rows x 2 columns],                key   payload
shuffle                     
2           160931  20215772
2           186028  46365843
2           142430  37258102
2           428230  42695502
2         
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-05-03 05:47:10,111 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42297 -> ucx://127.0.0.1:58797
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f36c8588300, tag: 0x34d3f60a50b4cfa5, nbytes: 99977512, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:10,125 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:10,142 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-b97b49bf1f4fa55d5e9cb449a2a42818', 4)
Function:  <dask.layers.CallableLazyImport object at 0x7f2b05
args:      ([               key   payload
shuffle                     
0           949193  23140668
0           928555  53000257
0           886230  29275150
0           946571  29358844
0          1058885  82509963
...            ...       ...
0        799680185  26946481
0        799653101  15025739
0        799817637  65529592
0        799854823  75749327
0        799985668   5738607

[12503392 rows x 2 columns],                key   payload
shuffle                     
1           189765  78878246
1           225252  65562901
1           124377  77888421
1           224077  37120839
1           535603  67974215
...            ...       ...
1        799965634  43701407
1        799878374  18214954
1        799961000  71268700
1        799828027  12194546
1        799861396  12282758

[12500389 rows x 2 columns],                key   payload
shuffle                     
2            83574  98966932
2           125488  19449510
2           188945  78446601
2           147653  66716305
2         
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-05-03 05:47:11,644 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:11,644 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[1683092834.122306] [dgx13:79726:0]    cuda_copy_md.c:208  UCX  ERROR   cuMemAlloc_v2((CUdeviceptr*)address_p, *length_p)() failed: out of memory
[1683092834.122326] [dgx13:79726:0]         uct_mem.c:155  UCX  ERROR   failed to allocate 536870912 bytes using md cuda_cpy for ucp_rndv_frags: Input/output error
[1683092834.122331] [dgx13:79726:0]           mpool.c:269  UCX  ERROR Failed to allocate memory pool (name=ucp_rndv_frags) chunk: Out of memory
[dgx13:79726:0:79726]        rndv.c:1369 Fatal: failed to allocate fragment memory buffer
==== backtrace (tid:  79726) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f3074479c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0xb8) [0x7f3074476b58]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_format+0x114) [0x7f3074476c74]
 3  /opt/conda/envs/gdf/lib/libucp.so.0(+0x7ebd4) [0x7f307452fbd4]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_receive+0x46c) [0x7f307453082c]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nbx+0xc1a) [0x7f307454a40a]
 6  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nb+0x5a) [0x7f30745497ca]
 7  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x51f0d) [0x7f30745e7f0d]
 8  /opt/conda/envs/gdf/bin/python(+0x149dc7) [0x558955bbddc7]
 9  /opt/conda/envs/gdf/bin/python(PyObject_Call+0x158) [0x558955bbc1a8]
10  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x558955ba2d36]
11  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558955b9c27a]
12  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558955badc05]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x558955b9e3cb]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558955b9c27a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558955badc05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x558955b9e3cb]
17  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x558955bc270e]
18  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x558955ba3923]
19  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x558955bc270e]
20  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x558955ba3923]
21  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x558955bc270e]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x558955ba3923]
23  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x558955bc270e]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x558955ba3923]
25  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x558955bc270e]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x558955ba3923]
27  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x558955bc270e]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x558955ba3923]
29  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x558955bc270e]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x558955ba3923]
31  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x558955bc270e]
32  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f30851882fe]
33  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x8b4e) [0x7f3085188b4e]
34  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x558955ba62bc]
35  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x558955b59817]
36  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x558955ba4f83]
37  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x558955ba2d36]
38  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558955badef3]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558955b9d81b]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558955badef3]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558955b9d81b]
42  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558955badef3]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558955b9d81b]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558955badef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558955b9d81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558955b9c27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558955badc05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x558955ba1fa7]
49  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558955b9c27a]
50  /opt/conda/envs/gdf/bin/python(+0x147935) [0x558955bbb935]
51  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x558955bbc104]
52  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x558955c82fc8]
53  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x558955ba62bc]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x558955ba11bb]
55  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558955badef3]
56  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x558955bbbc72]
57  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x558955ba11bb]
58  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558955badef3]
59  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558955b9d81b]
60  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558955b9c27a]
61  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558955badc05]
=================================
Task exception was never retrieved
future: <Task finished name='Task-829' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
Task exception was never retrieved
future: <Task finished name='Task-701' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-05-03 05:47:14,313 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58429
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f740c3a0100, tag: 0x264d3ef013cbefd9, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f740c3a0100, tag: 0x264d3ef013cbefd9, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-03 05:47:14,313 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58429
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f0724843100, tag: 0xb276366e247556c0, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f0724843100, tag: 0xb276366e247556c0, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-03 05:47:14,312 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58429
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f62f82d1100, tag: 0x1de6fc368ff3ce40, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f62f82d1100, tag: 0x1de6fc368ff3ce40, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 742, in cupy.cuda.memory.alloc
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/rmm/allocators/cupy.py", line 37, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
Exception ignored in: 'cupy.cuda.thrust.cupy_malloc'
Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 742, in cupy.cuda.memory.alloc
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/rmm/allocators/cupy.py", line 37, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
2023-05-03 05:47:14,365 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58429
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #099] ep: 0x7f1286d35200, tag: 0xff0281e6a489f0e7, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #099] ep: 0x7f1286d35200, tag: 0xff0281e6a489f0e7, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-03 05:47:14,322 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58429
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 468, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 316, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
[1683092834.398200] [dgx13:79729:0]    cuda_copy_md.c:208  UCX  ERROR   cuMemAlloc_v2((CUdeviceptr*)address_p, *length_p)() failed: out of memory
[1683092834.398217] [dgx13:79729:0]         uct_mem.c:155  UCX  ERROR   failed to allocate 536870912 bytes using md cuda_cpy for ucp_rndv_frags: Input/output error
[1683092834.398223] [dgx13:79729:0]           mpool.c:269  UCX  ERROR Failed to allocate memory pool (name=ucp_rndv_frags) chunk: Out of memory
[dgx13:79729:0:79729]        rndv.c:1369 Fatal: failed to allocate fragment memory buffer
==== backtrace (tid:  79729) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f36c90c8c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0xb8) [0x7f36c90c5b58]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_format+0x114) [0x7f36c90c5c74]
 3  /opt/conda/envs/gdf/lib/libucp.so.0(+0x7ebd4) [0x7f36c917ebd4]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_receive+0x46c) [0x7f36c917f82c]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nbx+0xc1a) [0x7f36c919940a]
 6  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nb+0x5a) [0x7f36c91987ca]
 7  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x51f0d) [0x7f36c9236f0d]
 8  /opt/conda/envs/gdf/bin/python(+0x149dc7) [0x559b25068dc7]
 9  /opt/conda/envs/gdf/bin/python(PyObject_Call+0x158) [0x559b250671a8]
10  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x559b2504dd36]
11  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x559b2504727a]
12  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559b25058c05]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x559b250493cb]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x559b2504727a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559b25058c05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x559b250493cb]
17  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x559b2506d70e]
18  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x559b2504e923]
19  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x559b2506d70e]
20  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x559b2504e923]
21  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x559b2506d70e]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x559b2504e923]
23  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x559b2506d70e]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x559b2504e923]
25  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x559b2506d70e]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x559b2504e923]
27  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x559b2506d70e]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x559b2504e923]
29  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x559b2506d70e]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x559b2504e923]
31  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x559b2506d70e]
32  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f36ebde22fe]
33  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x8b4e) [0x7f36ebde2b4e]
34  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x559b250512bc]
35  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x559b25004817]
36  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x559b2504ff83]
37  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x559b2504dd36]
38  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559b25058ef3]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559b2504881b]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559b25058ef3]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559b2504881b]
42  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559b25058ef3]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559b2504881b]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559b25058ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559b2504881b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x559b2504727a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559b25058c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x559b2504cfa7]
49  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x559b2504727a]
50  /opt/conda/envs/gdf/bin/python(+0x147935) [0x559b25066935]
51  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x559b25067104]
52  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x559b2512dfc8]
53  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x559b250512bc]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x559b2504c1bb]
55  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559b25058ef3]
56  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x559b25066c72]
57  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x559b2504c1bb]
58  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x559b25058ef3]
59  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x559b2504881b]
60  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x559b2504727a]
61  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x559b25058c05]
=================================
[1683092834.400168] [dgx13:80254:0]    cuda_copy_ep.c:246  UCX  ERROR cudaMemcpyAsync(buffer, (void*)remote_addr, length, cudaMemcpyDefault, *stream)() failed: an illegal memory access was encountered
[1683092834.400186] [dgx13:80254:0]    cuda_copy_ep.c:248  UCX  ERROR cudaStreamSynchronize(*stream)() failed: an illegal memory access was encountered
[dgx13:80254:0:80254]          dt.c:97   Fatal: mem type pack failed to uct_ep_get_short() Input/output error
==== backtrace (tid:  80254) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f740c725c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0xb8) [0x7f740c722b58]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_format+0x114) [0x7f740c722c74]
 3  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_pack+0x188) [0x7f740c7afdc8]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_dt_pack+0x69) [0x7f740c7afe69]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(+0x80331) [0x7f740c7dd331]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_ep_am_bcopy+0x7e) [0x7f740c6d798e]
 7  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_progress_am_bcopy+0x1bb) [0x7f740c7dd55b]
 8  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_rtr_handler+0xc8) [0x7f740c7e0108]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f740c6d6427]
10  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f740c6d6a08]
11  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f740c6d8f2c]
12  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f740c730539]
13  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f740c6d8fdb]
14  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f740c7ac28a]
15  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f740c86a6e1]
16  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55cf6aa7eb08]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55cf6aa6f112]
18  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55cf6aa6827a]
19  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55cf6aa79c05]
20  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cf6aa6981b]
21  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55cf6aa8e70e]
22  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f742b2b92fe]
23  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55cf6aa722bc]
24  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55cf6aa25817]
25  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55cf6aa70f83]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55cf6aa6ed36]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55cf6aa79ef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cf6aa6981b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55cf6aa79ef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cf6aa6981b]
31  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55cf6aa79ef3]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cf6aa6981b]
33  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55cf6aa79ef3]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cf6aa6981b]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55cf6aa6827a]
36  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55cf6aa79c05]
37  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55cf6aa6dfa7]
38  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55cf6aa6827a]
39  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55cf6aa87935]
40  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55cf6aa88104]
41  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55cf6ab4efc8]
42  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55cf6aa722bc]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55cf6aa6d1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55cf6aa79ef3]
45  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55cf6aa87c72]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55cf6aa6d1bb]
47  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55cf6aa79ef3]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cf6aa6981b]
49  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55cf6aa6827a]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55cf6aa79c05]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55cf6aa6981b]
52  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55cf6aa79ef3]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55cf6aa69568]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55cf6aa6827a]
55  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55cf6aa79c05]
56  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55cf6aa6a3cb]
57  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55cf6aa6827a]
58  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55cf6aa67f07]
59  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55cf6aa67eb9]
60  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55cf6ab188bb]
61  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55cf6ab46adc]
=================================
2023-05-03 05:47:14,462 - distributed.nanny - WARNING - Restarting worker
[dgx13:79735:0:79735] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  79735) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f1287871c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f1287871dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f1287872134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f132accc420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f12878fbaa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f128792cb48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f1287822427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f1287822a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f1287824f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f128787c539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f1287824fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f12878f828a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f12879b66e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x562bbfd1eb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x562bbfd0f112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x562bbfd0827a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x562bbfd19c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x562bbfd0981b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x562bbfd19ef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x562bbfd27a16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x562bbfe379b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x562bbfcc5817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x562bbfd10f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x562bbfd0ed36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x562bbfd19ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x562bbfd0981b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x562bbfd19ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x562bbfd0981b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x562bbfd19ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x562bbfd0981b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x562bbfd19ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x562bbfd0981b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x562bbfd0827a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x562bbfd19c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x562bbfd0dfa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x562bbfd0827a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x562bbfd27935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x562bbfd28104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x562bbfdeefc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x562bbfd122bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x562bbfd0d1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x562bbfd19ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x562bbfd27c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x562bbfd0d1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x562bbfd19ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x562bbfd0981b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x562bbfd0827a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x562bbfd19c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x562bbfd0981b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x562bbfd19ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x562bbfd09568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x562bbfd0827a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x562bbfd19c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x562bbfd0a3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x562bbfd0827a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x562bbfd07f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x562bbfd07eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x562bbfdb88bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x562bbfde6adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x562bbfde2c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x562bbfdda7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x562bbfdda6bd]
=================================
2023-05-03 05:47:14,593 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:42297
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f07248431c0, tag: 0xa9f92351fc4ba7dc, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f07248431c0, tag: 0xa9f92351fc4ba7dc, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-03 05:47:14,593 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:42297
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #009] ep: 0x7f62f82d1140, tag: 0x8f14614c1f0767fb, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #009] ep: 0x7f62f82d1140, tag: 0x8f14614c1f0767fb, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-05-03 05:47:14,594 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:39927 -> ucx://127.0.0.1:42297
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0724843240, tag: 0xaa7f34766dc02b06, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:14,692 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:14,751 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:39927 -> ucx://127.0.0.1:34715
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f07248432c0, tag: 0xc23101e10d6586ac, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:14,751 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:34715
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f0724843200, tag: 0xd6d0eb532e37f388, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f0724843200, tag: 0xd6d0eb532e37f388, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-03 05:47:14,752 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44183 -> ucx://127.0.0.1:34715
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f62f82d1300, tag: 0x706031a88eb745b2, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:14,753 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:34715
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f62f82d11c0, tag: 0x83b3e939ff59f910, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f62f82d11c0, tag: 0x83b3e939ff59f910, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-03 05:47:14,762 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:14,834 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:15,315 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:51521
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2907, in get_data_from_worker
    await comm.write("OK")
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 289, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message
2023-05-03 05:47:15,985 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:15,985 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:16,191 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:16,191 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:16,361 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:16,361 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:16,521 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:16,521 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:80310:0:80310] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
[dgx13:79732:0:79732] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80310) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7fed6815ac1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7fed6815adff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7fed6815b134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fedf9412420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7fed681e4aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fed68215b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7fed6810b427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7fed6810ba08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7fed6810df2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7fed68165539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fed6810dfdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fed681e128a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7fed6829f6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x5612628cdb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x5612628be112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5612628b727a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5612628c8c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5612628b881b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5612628dd70e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7fed78ccf2fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5612628c12bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x561262874817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x5612628bff83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5612628bdd36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5612628c8ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5612628b881b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5612628c8ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5612628b881b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5612628c8ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5612628b881b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5612628c8ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5612628b881b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5612628b727a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5612628c8c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5612628bcfa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5612628b727a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x5612628d6935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5612628d7104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x56126299dfc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5612628c12bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5612628bc1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5612628c8ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x5612628d6c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5612628bc1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5612628c8ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5612628b881b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5612628b727a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5612628c8c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5612628b881b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5612628c8ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5612628b8568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5612628b727a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5612628c8c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5612628b93cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5612628b727a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5612628b6f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5612628b6eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5612629678bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x561262995adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x561262991c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5612629897ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5612629896bd]
=================================
==== backtrace (tid:  79732) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f1e41dbfc1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f1e41dbfdff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f1e41dc0134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f1ee5208420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f1e41e49aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f1e41e7ab48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f1e41d70427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f1e41d70a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f1e41d72f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f1e41dca539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f1e41d72fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f1e41e4628a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f1e41f046e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55aa76a43b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55aa76a34112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55aa76a2d27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55aa76a3ec05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa76a2e81b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55aa76a5370e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f1ed85482fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55aa76a372bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55aa769ea817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55aa76a35f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55aa76a33d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa76a3eef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa76a2e81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa76a3eef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa76a2e81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa76a3eef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa76a2e81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa76a3eef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa76a2e81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55aa76a2d27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55aa76a3ec05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55aa76a32fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55aa76a2d27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55aa76a4c935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55aa76a4d104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55aa76b13fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55aa76a372bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55aa76a321bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa76a3eef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55aa76a4cc72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55aa76a321bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa76a3eef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa76a2e81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55aa76a2d27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55aa76a3ec05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa76a2e81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa76a3eef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55aa76a2e568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55aa76a2d27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55aa76a3ec05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55aa76a2f3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55aa76a2d27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55aa76a2cf07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55aa76a2ceb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55aa76add8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55aa76b0badc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55aa76b07c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55aa76aff7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55aa76aff6bd]
=================================
2023-05-03 05:47:17,523 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36311
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f62f82d11c0, tag: 0x68295ea38b85c5dc, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f62f82d11c0, tag: 0x68295ea38b85c5dc, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-03 05:47:17,523 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36311
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f0724843200, tag: 0x294824c01a64b96, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f0724843200, tag: 0x294824c01a64b96, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-05-03 05:47:17,525 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44183 -> ucx://127.0.0.1:36311
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f62f82d1140, tag: 0xb45c44551061a8b0, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:17,529 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50285
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #009] ep: 0x7f07248432c0, tag: 0x3fb8e65a27f2147d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #009] ep: 0x7f07248432c0, tag: 0x3fb8e65a27f2147d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-05-03 05:47:17,529 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50285
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7f62f82d1300, tag: 0x597abb099ea2de1e, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 329, in connect
    handshake = await wait_for(comm.read(), time_left())
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f62f82d1300, tag: 0x597abb099ea2de1e, nbytes: 16, type: <class 'numpy.ndarray'>>: ")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 334, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:50285 after 30 s
2023-05-03 05:47:17,628 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:17,837 - distributed.nanny - WARNING - Restarting worker
[dgx13:80512:0:80512] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80512) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f433c4edc1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f433c4eddff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f433c4ee134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f43db7bc420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f433c577aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f433c5a8b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f433c49e427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f433c49ea08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f433c4a0f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f433c4f8539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f433c4a0fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f433c57428a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f433c6326e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55a6e57fcb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55a6e57ed112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55a6e57e627a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55a6e57f7c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6e57e781b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55a6e57f7ef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x55a6e5805a16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x55a6e59159b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55a6e57a3817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55a6e57eef83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55a6e57ecd36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55a6e57f7ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6e57e781b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55a6e57f7ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6e57e781b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55a6e57f7ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6e57e781b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55a6e57f7ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6e57e781b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55a6e57e627a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55a6e57f7c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55a6e57ebfa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55a6e57e627a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55a6e5805935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55a6e5806104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55a6e58ccfc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55a6e57f02bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55a6e57eb1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55a6e57f7ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55a6e5805c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55a6e57eb1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55a6e57f7ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6e57e781b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55a6e57e627a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55a6e57f7c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55a6e57e781b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55a6e57f7ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55a6e57e7568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55a6e57e627a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55a6e57f7c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55a6e57e83cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55a6e57e627a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55a6e57e5f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55a6e57e5eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55a6e58968bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55a6e58c4adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55a6e58c0c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55a6e58b87ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55a6e58b86bd]
=================================
2023-05-03 05:47:18,057 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:18,062 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44183 -> ucx://127.0.0.1:40277
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f62f82d1200, tag: 0xe0767b25ea1a4f95, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:18,063 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:39927 -> ucx://127.0.0.1:40277
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f07248431c0, tag: 0x2c868c3143f10a4, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:19,285 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:19,285 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:19,449 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:19,449 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:19,738 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:19,738 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:80509:0:80509] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80509) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f3485865c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f3485865dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f3485866134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f3528b3f420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f34858efaa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f3485920b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f3485816427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f3485816a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f3485818f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f3485870539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f3485818fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f34858ec28a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f34859aa6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x5654fd124b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x5654fd115112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5654fd10e27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5654fd11fc05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654fd10f81b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5654fd13470e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f34a84052fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5654fd1182bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5654fd0cb817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x5654fd116f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5654fd114d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654fd11fef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654fd10f81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654fd11fef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654fd10f81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654fd11fef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654fd10f81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654fd11fef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654fd10f81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5654fd10e27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5654fd11fc05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5654fd113fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5654fd10e27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x5654fd12d935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5654fd12e104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x5654fd1f4fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5654fd1182bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5654fd1131bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654fd11fef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x5654fd12dc72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5654fd1131bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654fd11fef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654fd10f81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5654fd10e27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5654fd11fc05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5654fd10f81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5654fd11fef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5654fd10f568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5654fd10e27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5654fd11fc05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5654fd1103cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5654fd10e27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5654fd10df07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5654fd10deb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5654fd1be8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x5654fd1ecadc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x5654fd1e8c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5654fd1e07ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5654fd1e06bd]
=================================
2023-05-03 05:47:20,955 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43699
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f07248432c0, tag: 0xb02e4669a0cb2c9b, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f07248432c0, tag: 0xb02e4669a0cb2c9b, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-03 05:47:20,956 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43699
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f62f82d1200, tag: 0xf7dae189ae3a5f35, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f62f82d1200, tag: 0xf7dae189ae3a5f35, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-03 05:47:20,956 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:39927 -> ucx://127.0.0.1:43699
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0724843180, tag: 0x272e73d9f2c91c20, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:20,956 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43699
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7efb7152f180, tag: 0x1ee3fc7cb3696008, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7efb7152f180, tag: 0x1ee3fc7cb3696008, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-03 05:47:21,032 - distributed.nanny - WARNING - Restarting worker
[dgx13:80501:0:80501] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80501) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f63c8c9dc1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f63c8c9ddff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f63c8c9e134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f6459f66420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f63c8d27aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f63c8d58b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f63c8c4e427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f63c8c4ea08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f63c8c50f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f63c8ca8539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f63c8c50fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f63c8d2428a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f63c8de26e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x56528cad5b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x56528cac6112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56528cabf27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56528cad0c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56528cac081b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x56528cae570e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f63d982d2fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x56528cac92bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x56528ca7c817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x56528cac7f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x56528cac5d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56528cad0ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56528cac081b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56528cad0ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56528cac081b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56528cad0ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56528cac081b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56528cad0ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56528cac081b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56528cabf27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56528cad0c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x56528cac4fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56528cabf27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x56528cade935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x56528cadf104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x56528cba5fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x56528cac92bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x56528cac41bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56528cad0ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x56528cadec72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x56528cac41bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56528cad0ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56528cac081b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56528cabf27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56528cad0c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56528cac081b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56528cad0ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x56528cac0568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56528cabf27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56528cad0c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x56528cac13cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56528cabf27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x56528cabef07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56528cabeeb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56528cb6f8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x56528cb9dadc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x56528cb99c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x56528cb917ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x56528cb916bd]
=================================
2023-05-03 05:47:22,071 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58599
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f0724843180, tag: 0x123d1d832dd22f5d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f0724843180, tag: 0x123d1d832dd22f5d, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-03 05:47:22,071 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58599
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7efb7152f240, tag: 0x12e09eabbcf1bcb7, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7efb7152f240, tag: 0x12e09eabbcf1bcb7, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-05-03 05:47:22,071 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58599
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f62f82d1200, tag: 0x91539b084b192a57, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f62f82d1200, tag: 0x91539b084b192a57, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-03 05:47:22,072 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44183 -> ucx://127.0.0.1:58599
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f62f82d11c0, tag: 0x37fd0b00f84fb550, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:22,137 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:22,498 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:22,498 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:23,741 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:23,741 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
terminate called after throwing an instance of 'rmm::out_of_memory'
  what():  std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
2023-05-03 05:47:25,839 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:27,352 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:27,352 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:80753:0:80753] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80753) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f2bac6a5c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f2bac6a5dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f2bac6a6134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f2c3d989420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f2bac72faa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f2bac760b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f2bac656427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f2bac656a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f2bac658f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f2bac6b0539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f2bac658fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f2bac72c28a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f2bac7ea6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55d417c05b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55d417bf6112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d417bef27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d417c00c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d417bf081b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d417c00ef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x55d417c0ea16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x55d417d1e9b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55d417bac817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55d417bf7f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55d417bf5d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d417c00ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d417bf081b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d417c00ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d417bf081b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d417c00ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d417bf081b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d417c00ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d417bf081b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d417bef27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d417c00c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55d417bf4fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d417bef27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55d417c0e935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55d417c0f104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55d417cd5fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55d417bf92bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55d417bf41bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d417c00ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55d417c0ec72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55d417bf41bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d417c00ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d417bf081b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d417bef27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d417c00c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d417bf081b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d417c00ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55d417bf0568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d417bef27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d417c00c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55d417bf13cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d417bef27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55d417beef07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55d417beeeb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55d417c9f8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55d417ccdadc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55d417cc9c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55d417cc17ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55d417cc16bd]
=================================
[dgx13:80705:0:80705] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80705) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7fe441011c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7fe441011dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7fe441012134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fe4e0302420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7fe44109baa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fe4410ccb48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7fe440fc2427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7fe440fc2a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7fe440fc4f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7fe44101c539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fe440fc4fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fe44109828a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7fe4411566e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x5620e4caeb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x5620e4c9f112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5620e4c9827a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5620e4ca9c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5620e4c9981b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5620e4ca9ef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x5620e4cb7a16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x5620e4dc79b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5620e4c55817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x5620e4ca0f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5620e4c9ed36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5620e4ca9ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5620e4c9981b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5620e4ca9ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5620e4c9981b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5620e4ca9ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5620e4c9981b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5620e4ca9ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5620e4c9981b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5620e4c9827a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5620e4ca9c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5620e4c9dfa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5620e4c9827a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x5620e4cb7935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5620e4cb8104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x5620e4d7efc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5620e4ca22bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5620e4c9d1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5620e4ca9ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x5620e4cb7c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5620e4c9d1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5620e4ca9ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5620e4c9981b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5620e4c9827a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5620e4ca9c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5620e4c9981b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5620e4ca9ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5620e4c99568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5620e4c9827a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5620e4ca9c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5620e4c9a3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5620e4c9827a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5620e4c97f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5620e4c97eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5620e4d488bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x5620e4d76adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x5620e4d72c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5620e4d6a7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5620e4d6a6bd]
=================================
Task exception was never retrieved
future: <Task finished name='Task-793' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Endpoint timeout')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Endpoint timeout
2023-05-03 05:47:29,110 - distributed.nanny - WARNING - Restarting worker
Task exception was never retrieved
future: <Task finished name='Task-7339' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
[dgx13:80242:0:80242] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80242) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f072539ec1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f072539edff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f072539f134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f07c8674420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f0725428aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f0725459b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f072534f427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f072534fa08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f0725351f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f07253a9539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f0725351fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f072542528a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f07254e36e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x5583ee109b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x5583ee0fa112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5583ee0f327a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5583ee104c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5583ee0f481b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5583ee11970e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f0747f362fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5583ee0fd2bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5583ee0b0817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x5583ee0fbf83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5583ee0f9d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5583ee104ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5583ee0f481b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5583ee104ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5583ee0f481b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5583ee104ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5583ee0f481b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5583ee104ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5583ee0f481b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5583ee0f327a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5583ee104c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5583ee0f8fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5583ee0f327a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x5583ee112935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5583ee113104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x5583ee1d9fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5583ee0fd2bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5583ee0f81bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5583ee104ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x5583ee112c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5583ee0f81bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5583ee104ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5583ee0f481b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5583ee0f327a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5583ee104c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5583ee0f481b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5583ee104ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5583ee0f4568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5583ee0f327a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5583ee104c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5583ee0f53cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5583ee0f327a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5583ee0f2f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5583ee0f2eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5583ee1a38bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x5583ee1d1adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x5583ee1cdc24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5583ee1c57ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5583ee1c56bd]
=================================
2023-05-03 05:47:29,196 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50861 -> ucx://127.0.0.1:37079
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f6af0208240, tag: 0x5f6e36b26c29fc19, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:29,217 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:53555 -> ucx://127.0.0.1:37109
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7efb7152f180, tag: 0xb147c3406ec1ab8, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:29,307 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:29,374 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38865 -> ucx://127.0.0.1:39927
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff6440232c0, tag: 0x8a30e2b847ff4620, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:29,375 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:39927
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7ff644023100, tag: 0xb7751e006360af49, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7ff644023100, tag: 0xb7751e006360af49, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-03 05:47:29,513 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:30,646 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:30,646 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:30,838 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:30,838 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:31,150 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:31,150 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:80994:0:80994] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80994) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f5a508adc1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f5a508addff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f5a508ae134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f5aefb78420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f5a50937aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f5a50968b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f5a5085e427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f5a5085ea08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f5a50860f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f5a508b8539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f5a50860fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f5a5093428a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f5a509f26e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x5559dbca9b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x5559dbc9a112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5559dbc9327a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5559dbca4c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559dbc9481b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5559dbcb970e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f5a6f4402fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5559dbc9d2bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5559dbc50817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x5559dbc9bf83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5559dbc99d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5559dbca4ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559dbc9481b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5559dbca4ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559dbc9481b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5559dbca4ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559dbc9481b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5559dbca4ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559dbc9481b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5559dbc9327a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5559dbca4c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5559dbc98fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5559dbc9327a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x5559dbcb2935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5559dbcb3104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x5559dbd79fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5559dbc9d2bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5559dbc981bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5559dbca4ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x5559dbcb2c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5559dbc981bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5559dbca4ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559dbc9481b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5559dbc9327a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5559dbca4c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5559dbc9481b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5559dbca4ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5559dbc94568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5559dbc9327a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5559dbca4c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5559dbc953cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5559dbc9327a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5559dbc92f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5559dbc92eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5559dbd438bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x5559dbd71adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x5559dbd6dc24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5559dbd657ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5559dbd656bd]
=================================
[dgx13:80504:0:80504] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80504) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7efb740acc1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7efb740acdff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7efb740ad134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7efc13383420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7efb74136aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7efb74167b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7efb7405d427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7efb7405da08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7efb7405ff2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7efb740b7539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7efb7405ffdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7efb7413328a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7efb741f16e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55597d137b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55597d128112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55597d12127a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55597d132c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55597d12281b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55597d14770e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7efb92c492fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55597d12b2bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55597d0de817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55597d129f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55597d127d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55597d132ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55597d12281b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55597d132ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55597d12281b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55597d132ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55597d12281b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55597d132ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55597d12281b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55597d12127a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55597d132c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55597d126fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55597d12127a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55597d140935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55597d141104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55597d207fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55597d12b2bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55597d1261bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55597d132ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55597d140c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55597d1261bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55597d132ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55597d12281b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55597d12127a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55597d132c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55597d12281b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55597d132ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55597d122568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55597d12127a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55597d132c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55597d1233cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55597d12127a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55597d120f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55597d120eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55597d1d18bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55597d1ffadc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55597d1fbc24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55597d1f37ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55597d1f36bd]
=================================
[dgx13:80698:0:80698] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80698) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f612cc12c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f612cc12dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f612cc13134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f61bdedf420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f612cc9caa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f612cccdb48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f612cbc3427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f612cbc3a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f612cbc5f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f612cc1d539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f612cbc5fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f612cc9928a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f612cd576e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55e684a10b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55e684a01112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e6849fa27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e684a0bc05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e6849fb81b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55e684a2070e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f613d7a82fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55e684a042bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55e6849b7817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55e684a02f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55e684a00d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e684a0bef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e6849fb81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e684a0bef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e6849fb81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e684a0bef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e6849fb81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e684a0bef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e6849fb81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e6849fa27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e684a0bc05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55e6849fffa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e6849fa27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55e684a19935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55e684a1a104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55e684ae0fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55e684a042bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55e6849ff1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e684a0bef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55e684a19c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55e6849ff1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e684a0bef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e6849fb81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e6849fa27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e684a0bc05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e6849fb81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e684a0bef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55e6849fb568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e6849fa27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e684a0bc05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55e6849fc3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e6849fa27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55e6849f9f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55e6849f9eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55e684aaa8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55e684ad8adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55e684ad4c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55e684acc7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55e684acc6bd]
=================================
[dgx13:80694:0:80694] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  80694) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f6af0d74c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f6af0d74dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f6af0d75134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f6b9005e420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f6af0dfeaa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f6af0e2fb48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f6af0d25427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f6af0d25a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f6af0d27f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f6af0d7f539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f6af0d27fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f6af0dfb28a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f6af0eb96e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x558a1b68fb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x558a1b680112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558a1b67927a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558a1b68ac05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558a1b67a81b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558a1b68aef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x558a1b698a16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x558a1b7a89b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x558a1b636817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x558a1b681f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x558a1b67fd36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558a1b68aef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558a1b67a81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558a1b68aef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558a1b67a81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558a1b68aef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558a1b67a81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558a1b68aef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558a1b67a81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558a1b67927a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558a1b68ac05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x558a1b67efa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558a1b67927a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x558a1b698935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x558a1b699104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x558a1b75ffc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x558a1b6832bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x558a1b67e1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558a1b68aef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x558a1b698c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x558a1b67e1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558a1b68aef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558a1b67a81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558a1b67927a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558a1b68ac05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558a1b67a81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558a1b68aef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x558a1b67a568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558a1b67927a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558a1b68ac05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x558a1b67b3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558a1b67927a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x558a1b678f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x558a1b678eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x558a1b7298bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x558a1b757adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x558a1b753c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x558a1b74b7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x558a1b74b6bd]
=================================
2023-05-03 05:47:32,574 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38865 -> ucx://127.0.0.1:40605
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff644023280, tag: 0x909ca29e3233bed, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:32,574 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40605
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7ff644023100, tag: 0xe28f68560d2f988b, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7ff644023100, tag: 0xe28f68560d2f988b, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-03 05:47:32,576 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53555
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #032] ep: 0x7ff6440231c0, tag: 0x10180740929959cb, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #032] ep: 0x7ff6440231c0, tag: 0x10180740929959cb, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-05-03 05:47:32,576 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43869
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #025] ep: 0x7ff644023180, tag: 0x2398299a012086a0, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #025] ep: 0x7ff644023180, tag: 0x2398299a012086a0, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-05-03 05:47:32,577 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38865 -> ucx://127.0.0.1:43869
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7ff6440232c0, tag: 0x3b54bcd4d0d17ecb, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1793, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7ff6440232c0, tag: 0x3b54bcd4d0d17ecb, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-03 05:47:32,630 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38865 -> ucx://127.0.0.1:50861
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff644023300, tag: 0x58bedfb10ccd79a2, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-03 05:47:32,631 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:50861
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7ff644023240, tag: 0x7a09fc5e6aa69985, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7ff644023240, tag: 0x7a09fc5e6aa69985, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-03 05:47:32,688 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:32,765 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:32,809 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:32,879 - distributed.nanny - WARNING - Restarting worker
2023-05-03 05:47:34,268 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:34,269 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:34,278 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:34,279 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:34,322 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:34,322 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-03 05:47:34,434 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-03 05:47:34,434 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 742, in cupy.cuda.memory.alloc
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/rmm/allocators/cupy.py", line 37, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
Exception ignored in: 'cupy.cuda.thrust.cupy_malloc'
Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 742, in cupy.cuda.memory.alloc
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/rmm/allocators/cupy.py", line 37, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
2023-05-03 05:47:35,960 - distributed.worker - WARNING - Compute Failed
Key:       ('generate-data-5366301a596b755bb8c33997d3ce7726', 4)
Function:  generate_chunk
args:      (4, 100000000, 8, 'build', 0.3, True)
kwargs:    {}
Exception: "RuntimeError('transform: failed to synchronize: cudaErrorIllegalAddress: an illegal memory access was encountered')"

2023-05-03 05:47:38,608 - distributed.core - ERROR - std::bad_alloc: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 373, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
2023-05-03 05:47:38,608 - distributed.worker - ERROR - std::bad_alloc: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 373, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
2023-05-03 05:47:38,616 - distributed.core - ERROR - std::bad_alloc: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 373, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
2023-05-03 05:47:38,616 - distributed.worker - ERROR - std::bad_alloc: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 373, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
2023-05-03 05:47:38,623 - distributed.core - ERROR - std::bad_alloc: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 373, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
2023-05-03 05:47:38,624 - distributed.worker - ERROR - std::bad_alloc: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 373, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
2023-05-03 05:47:58,767 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:37079
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 490, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 492, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 318, in connect
    raise OSError(
OSError: Timed out trying to connect to ucx://127.0.0.1:37079 after 30 s
2023-05-03 05:47:58,769 - distributed.worker - ERROR - 'data'
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2085, in gather_dep
    data=response["data"],
KeyError: 'data'
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 36 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
