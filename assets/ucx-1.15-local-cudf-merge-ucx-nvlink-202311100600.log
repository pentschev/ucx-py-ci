[dgx13:81592:0:81592] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  81592) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f3becf1107d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f3becf11274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f3becf1143a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f3c8e24e420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f3becf906b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f3becfb9839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f3bececb3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f3becece838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f3becf1a4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f3bececd5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f3becf8d8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f3bed04606a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55cd98d3e6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55cd98d3a094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55cd98d4b519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cd98d3b5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55cd98dee162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f3c842991e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55cd98d4377c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55cd98cf5d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55cd98d427f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55cd98d40929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55cd98d4b7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cd98d3b5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55cd98d4b7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cd98d3b5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55cd98d4b7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cd98d3b5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55cd98d4b7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cd98d3b5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55cd98d3a094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55cd98d4b519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55cd98d3c128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55cd98d3a094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55cd98d58ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55cd98d5944c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55cd98e1c10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55cd98d4377c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55cd98d3e6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55cd98d4b7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55cd98d58dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55cd98d3e6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55cd98d4b7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cd98d3b5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55cd98d3a094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55cd98d4b519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55cd98d3b5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55cd98d4b7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55cd98d3b312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55cd98d3a094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55cd98d4b519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55cd98d3c128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55cd98d3a094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55cd98d39d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55cd98d39d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55cd98de707b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55cd98e13fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55cd98e10353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55cd98e0816a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55cd98e0805c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55cd98e07297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55cd98ddaf07]
=================================
2023-11-10 08:58:52,319 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:40545 -> ucx://127.0.0.1:34097
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fd0c2e31100, tag: 0xc6995340094e51f0, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-10 08:58:52,319 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:34097
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #009] ep: 0x7f680c608140, tag: 0x13a8db924abd5648, nbytes: 800000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #009] ep: 0x7f680c608140, tag: 0x13a8db924abd5648, nbytes: 800000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-11-10 08:58:52,400 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:35299 -> ucx://127.0.0.1:34097
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 294, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message
[dgx13:81577:0:81577] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  81577) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fbe6c90407d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7fbe6c904274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7fbe6c90443a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fbeffcbf420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fbe6c9836b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fbe6c9ac839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fbe6c8be3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fbe6c8c1838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fbe6c90d4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fbe6c8c05dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fbe6c9808da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fbe6ca3906a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ed791586fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ed79154094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ed79165519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed791555c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ed791657c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55ed79172e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55ed7927db2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55ed7910fd05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55ed7915c7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55ed7915a929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ed791657c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed791555c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ed791657c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed791555c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ed791657c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed791555c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ed791657c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed791555c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ed79154094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ed79165519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55ed79156128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ed79154094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55ed79172ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55ed7917344c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55ed7923610e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55ed7915d77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ed791586fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ed791657c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55ed79172dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55ed791586fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ed791657c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed791555c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ed79154094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ed79165519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55ed791555c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55ed791657c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55ed79155312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ed79154094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55ed79165519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55ed79156128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55ed79154094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55ed79153d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55ed79153d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55ed7920107b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55ed7922dfca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55ed7922a353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55ed7922216a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55ed7922205c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55ed79221297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55ed791f4f07]
=================================
[dgx13:81588:0:81588] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  81588) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f7e551dc07d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f7e551dc274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f7e551dc43a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f7efa514420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f7e5525b6b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f7e55284839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f7e551963df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f7e55199838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f7e551e54a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f7e551985dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f7e552588da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f7e5531106a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559a6645e6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559a6645a094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559a6646b519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559a6645b5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559a6646b7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x559a66478e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x559a66583b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x559a66415d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x559a664627f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x559a66460929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559a6646b7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559a6645b5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559a6646b7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559a6645b5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559a6646b7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559a6645b5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559a6646b7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559a6645b5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559a6645a094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559a6646b519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x559a6645c128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559a6645a094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x559a66478ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x559a6647944c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x559a6653c10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559a6646377c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559a6645e6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559a6646b7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x559a66478dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559a6645e6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559a6646b7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559a6645b5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559a6645a094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559a6646b519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559a6645b5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559a6646b7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x559a6645b312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559a6645a094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559a6646b519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x559a6645c128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559a6645a094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x559a66459d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559a66459d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x559a6650707b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x559a66533fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x559a66530353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x559a6652816a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x559a6652805c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x559a66527297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x559a664faf07]
=================================
[dgx13:81581:0:81581] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  81581) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd0c802e07d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7fd0c802e274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7fd0c802e43a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd168b02420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fd0c39026b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fd0c392b839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fd0c389c3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fd0c389f838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd0c80374a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd0c389e5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd0c38ff8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fd0c39b806a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55eca7e3e6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55eca7e3a094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55eca7e4b519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eca7e3b5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eca7e4b7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55eca7e58e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55eca7f63b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55eca7df5d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55eca7e427f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55eca7e40929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eca7e4b7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eca7e3b5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eca7e4b7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eca7e3b5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eca7e4b7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eca7e3b5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eca7e4b7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eca7e3b5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55eca7e3a094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55eca7e4b519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55eca7e3c128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55eca7e3a094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55eca7e58ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55eca7e5944c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55eca7f1c10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55eca7e4377c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55eca7e3e6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eca7e4b7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55eca7e58dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55eca7e3e6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eca7e4b7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eca7e3b5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55eca7e3a094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55eca7e4b519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55eca7e3b5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55eca7e4b7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55eca7e3b312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55eca7e3a094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55eca7e4b519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55eca7e3c128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55eca7e3a094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55eca7e39d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55eca7e39d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55eca7ee707b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55eca7f13fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55eca7f10353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55eca7f0816a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55eca7f0805c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55eca7f07297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55eca7edaf07]
=================================
[dgx13:81601:0:81601] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  81601) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f127595007d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f1275950274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f127595043a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f131cc8b420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f12759cf6b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f12759f8839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f127590a3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f127590d838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f12759594a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f127590c5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f12759cc8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f1275a8506a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56245a1c06fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56245a1bc094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56245a1cd519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56245a1bd5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x56245a270162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f1312cd61e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56245a1c577c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x56245a177d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x56245a1c47f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x56245a1c2929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56245a1cd7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56245a1bd5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56245a1cd7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56245a1bd5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56245a1cd7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56245a1bd5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56245a1cd7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56245a1bd5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56245a1bc094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56245a1cd519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56245a1be128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56245a1bc094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x56245a1daccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56245a1db44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x56245a29e10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56245a1c577c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56245a1c06fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56245a1cd7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x56245a1dadac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56245a1c06fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56245a1cd7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56245a1bd5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56245a1bc094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56245a1cd519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56245a1bd5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56245a1cd7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x56245a1bd312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56245a1bc094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56245a1cd519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56245a1be128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56245a1bc094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x56245a1bbd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56245a1bbd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56245a26907b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x56245a295fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x56245a292353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x56245a28a16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x56245a28a05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x56245a289297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x56245a25cf07]
=================================
Task exception was never retrieved
future: <Task finished name='Task-1405' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-11-10 08:58:55,818 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:59227 -> ucx://127.0.0.1:54283
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f90f84ac140, tag: 0x55f92af3be845399, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-10 08:58:55,822 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54283
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-11-10 08:58:55,823 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54283
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-11-10 08:58:55,909 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42513 -> ucx://127.0.0.1:35299
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f680c608140, tag: 0x8c83d7724a441dde, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-10 08:58:55,909 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35299
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f680c608100, tag: 0xebd0f864ec9b1344, nbytes: 800000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f680c608100, tag: 0xebd0f864ec9b1344, nbytes: 800000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-11-10 08:58:55,913 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:35299
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXNotConnected: <stream_recv>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1628, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-11-10 08:58:56,072 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40545
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f680c608280, tag: 0x357c244bbe3f9d6b, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f680c608280, tag: 0x357c244bbe3f9d6b, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-11-10 08:58:56,073 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:42513 -> ucx://127.0.0.1:40545
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f680c608180, tag: 0xdab81a6ffbca64fc, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-10 08:58:56,202 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:45657
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f680c608200, tag: 0xc4215939cbe229df, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f680c608200, tag: 0xc4215939cbe229df, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-11-10 08:58:56,229 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:51213 -> ucx://127.0.0.1:45657
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f23d8873200, tag: 0x6900390acb2a7ba9, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-11-10 08:58:56,230 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:45657
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f23d8873280, tag: 0x2748d4d38c8a8be8, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f23d8873280, tag: 0x2748d4d38c8a8be8, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-11-10 08:58:57,262 - distributed.worker - WARNING - Compute Failed
Key:       ('sort_index-86563d3c54ed11bf71e0c240596313fc', 3)
Function:  subgraph_callable-7518b1e7-17bb-46fe-9e99-a645e2bb
args:      ('set_index_post_scalar-ceb9308523ab39bbcf59f6dccd678d89',                 key  shuffle   payload  _partitions
0            143421        3  42831051            3
1            143552        3  54071581            3
2             41029        3  92401104            3
3            111619        3  59753675            3
4            143565        3  91920180            3
...             ...      ...       ...          ...
99999995  799982598        3  10756975            3
99999996  799982721        3  51785114            3
99999997  799982730        3  78124817            3
99999998  799982741        3  28636197            3
99999999  799982750        3  71213788            3

[100000000 rows x 4 columns], 'simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e')
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-10 08:58:57,405 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 6)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0           143393        6  20881504            6
1           143415        6   2842483            6
2           143555        6  59438232            6
3            41025        6   8066753            6
4           111616        6  46210787            6
...            ...      ...       ...          ...
12499995  99989425        6  20231144            6
12499996  99976979        6  10065936            6
12499997  99989428        6  41294008            6
12499998  99976983        6  52555977            6
12499999  99989431        6  44089402            6

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100052291        6  34808780            6
1         100052833        6  84344060            6
2         100031786        6  24514719            6
3         100052839        6  20994800            6
4         100052296        6  62199302            6
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:201: Maximum pool size exceeded')"

2023-11-10 08:58:57,929 - distributed.nanny - WARNING - Restarting worker
2023-11-10 08:59:22,916 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:40545
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 490, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1920, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 492, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 368, in connect
    raise OSError(
OSError: Timed out trying to connect to ucx://127.0.0.1:40545 after 30 s
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 24 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
