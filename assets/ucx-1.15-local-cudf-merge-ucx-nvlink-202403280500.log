/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/node.py:182: UserWarning: Port 8787 is already in use.
Perhaps you already have a cluster running?
Hosting the HTTP server on port 41877 instead
  warnings.warn(
[dgx13:64386:0:64386] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  64386) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f0d103d707d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f0d103d7274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f0d103d743a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f0d3bd0c420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f0d104566b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f0d1047f839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f0d103913df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f0d10394838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f0d103e04a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f0d103935dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f0d104538da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f0d1050c06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55accd5fa516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55accd5f5184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55accd606559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55accd5f6606]
16  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55accd606802]
17  /opt/conda/envs/gdf/bin/python(+0x14cbb3) [0x55accd613bb3]
18  /opt/conda/envs/gdf/bin/python(+0x25842c) [0x55accd71f42c]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x55accd5b966c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x55accd5fd833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x55accd5fb824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55accd606802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55accd5f6606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55accd606802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55accd5f6606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55accd606802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55accd5f6606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55accd606802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55accd5f6606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55accd5f5184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55accd606559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55accd5f7162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55accd5f5184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x55accd6139fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55accd61417c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x55accd6d79ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55accd5fe7ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55accd5fa516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55accd606802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x55accd613adc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55accd5fa516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55accd606802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55accd5f6606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55accd5f5184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55accd606559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55accd5f6606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55accd606802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55accd5f6352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55accd5f5184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55accd606559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55accd5f7162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55accd5f5184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55accd5f4e58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55accd5f4e09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55accd6a24ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x55accd6cf87a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x55accd6cbc03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55accd6c3a1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55accd6c390c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55accd6c2b47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55accd6962e7]
=================================
[1711606743.210166] [dgx13:64364:0]    cuda_copy_md.c:210  UCX  ERROR   cuMemAlloc_v2((CUdeviceptr*)address_p, *length_p)() failed: out of memory
[1711606743.210184] [dgx13:64364:0]         uct_mem.c:155  UCX  ERROR   failed to allocate 536870912 bytes using md cuda_cpy for ucp_rndv_frags: Input/output error
[1711606743.210189] [dgx13:64364:0]           mpool.c:269  UCX  ERROR Failed to allocate memory pool (name=ucp_rndv_frags) chunk: Out of memory
[dgx13:64364:0:64364]        rndv.c:1374 Fatal: failed to allocate fragment memory buffer
==== backtrace (tid:  64364) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7ff0d0d3907d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0x51) [0x7ff0d0d36c21]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x27dbc) [0x7ff0d0d36dbc]
 3  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_receive+0x121a) [0x7ff0d0de510a]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nbx+0xaeb) [0x7ff0d0df826b]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nb+0x57) [0x7ff0d0df8447]
 6  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x8129d) [0x7ff0d0ebd29d]
 7  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x562e25a9517c]
 8  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x562e25a7b516]
 9  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x562e25a76184]
10  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x562e25a87559]
11  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x562e25a78162]
12  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x562e25a76184]
13  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x562e25a87559]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x562e25a78162]
15  /opt/conda/envs/gdf/bin/python(+0x1e28a2) [0x562e25b2a8a2]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6410) [0x562e25a7d380]
17  /opt/conda/envs/gdf/bin/python(+0x1e28a2) [0x562e25b2a8a2]
18  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6410) [0x562e25a7d380]
19  /opt/conda/envs/gdf/bin/python(+0x1e28a2) [0x562e25b2a8a2]
20  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6410) [0x562e25a7d380]
21  /opt/conda/envs/gdf/bin/python(+0x1e28a2) [0x562e25b2a8a2]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6410) [0x562e25a7d380]
23  /opt/conda/envs/gdf/bin/python(+0x1e28a2) [0x562e25b2a8a2]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6410) [0x562e25a7d380]
25  /opt/conda/envs/gdf/bin/python(+0x1e28a2) [0x562e25b2a8a2]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6410) [0x562e25a7d380]
27  /opt/conda/envs/gdf/bin/python(+0x1e28a2) [0x562e25b2a8a2]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6410) [0x562e25a7d380]
29  /opt/conda/envs/gdf/bin/python(+0x1e28a2) [0x562e25b2a8a2]
30  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7ff0f47fe1e9]
31  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x8aa6) [0x7ff0f47feaa6]
32  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x562e25a7f7ac]
33  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x562e25a3a66c]
34  /opt/conda/envs/gdf/bin/python(+0x136833) [0x562e25a7e833]
35  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x562e25a7c824]
36  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x562e25a87802]
37  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562e25a77606]
38  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x562e25a87802]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562e25a77606]
40  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x562e25a87802]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562e25a77606]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x562e25a87802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562e25a77606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x562e25a76184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x562e25a87559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x562e25a78162]
47  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x562e25a76184]
48  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x562e25a949fb]
49  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x562e25a9517c]
50  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x562e25b589ce]
51  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x562e25a7f7ac]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x562e25a7b516]
53  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x562e25a87802]
54  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x562e25a94adc]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x562e25a7b516]
56  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x562e25a87802]
57  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562e25a77606]
58  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x562e25a76184]
59  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x562e25a87559]
60  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562e25a77606]
61  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x562e25a87802]
=================================
[dgx13:64394:0:64394] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  64394) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f9684ae207d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7f9684ae2274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7f9684ae243a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f96be44a420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f9684b616b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f9684b8a839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f9684a9c3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f9684a9f838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f9684aeb4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f9684a9e5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f9684b5e8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7f9684c1706a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x556e59789516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x556e59784184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556e59795559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e59785606]
16  /opt/conda/envs/gdf/bin/python(+0x1e28a2) [0x556e598388a2]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f96a85981e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x556e5978d7ac]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x556e5974866c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x556e5978c833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x556e5978a824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x556e59795802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e59785606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x556e59795802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e59785606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x556e59795802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e59785606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x556e59795802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e59785606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x556e59784184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556e59795559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x556e59786162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x556e59784184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x556e597a29fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x556e597a317c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x556e598669ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x556e5978d7ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x556e59789516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x556e59795802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x556e597a2adc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x556e59789516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x556e59795802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e59785606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x556e59784184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556e59795559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x556e59785606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x556e59795802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x556e59785352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x556e59784184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x556e59795559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x556e59786162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x556e59784184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x556e59783e58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x556e59783e09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x556e598314ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x556e5985e87a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x556e5985ac03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x556e59852a1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x556e5985290c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x556e59851b47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x556e598252e7]
=================================
[dgx13:64369:0:64369] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  64369) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fee0c8e307d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7fee0c8e3274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7fee0c8e343a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fee46216420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fee0c9626b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fee0c98b839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fee0c89d3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fee0c8a0838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fee0c8ec4a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fee0c89f5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fee0c95f8da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fee0ca1806a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55953f83d516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55953f838184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55953f849559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55953f839606]
16  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55953f849802]
17  /opt/conda/envs/gdf/bin/python(+0x14cbb3) [0x55953f856bb3]
18  /opt/conda/envs/gdf/bin/python(+0x25842c) [0x55953f96242c]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x55953f7fc66c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x55953f840833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x55953f83e824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55953f849802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55953f839606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55953f849802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55953f839606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55953f849802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55953f839606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55953f849802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55953f839606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55953f838184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55953f849559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55953f83a162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55953f838184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x55953f8569fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55953f85717c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x55953f91a9ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55953f8417ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55953f83d516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55953f849802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x55953f856adc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55953f83d516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55953f849802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55953f839606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55953f838184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55953f849559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55953f839606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55953f849802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55953f839352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55953f838184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55953f849559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55953f83a162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55953f838184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55953f837e58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55953f837e09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55953f8e54ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x55953f91287a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x55953f90ec03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55953f906a1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55953f90690c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55953f905b47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55953f8d92e7]
=================================
[dgx13:64379:0:64379] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  64379) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fbaf3c4707d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a274) [0x7fbaf3c47274]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a43a) [0x7fbaf3c4743a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fbb335c9420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fbaf3cc66b4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fbaf3cef839]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fbaf3c013df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fbaf3c04838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fbaf3c504a9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fbaf3c035dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fbaf3cc38da]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3206a) [0x7fbaf3d7c06a]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55dedc09b516]
13  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55dedc096184]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55dedc0a7559]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dedc097606]
16  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55dedc0a7802]
17  /opt/conda/envs/gdf/bin/python(+0x14cbb3) [0x55dedc0b4bb3]
18  /opt/conda/envs/gdf/bin/python(+0x25842c) [0x55dedc1c042c]
19  /opt/conda/envs/gdf/bin/python(+0xf266c) [0x55dedc05a66c]
20  /opt/conda/envs/gdf/bin/python(+0x136833) [0x55dedc09e833]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x55dedc09c824]
22  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55dedc0a7802]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dedc097606]
24  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55dedc0a7802]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dedc097606]
26  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55dedc0a7802]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dedc097606]
28  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55dedc0a7802]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dedc097606]
30  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55dedc096184]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55dedc0a7559]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55dedc098162]
33  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55dedc096184]
34  /opt/conda/envs/gdf/bin/python(+0x14c9fb) [0x55dedc0b49fb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55dedc0b517c]
36  /opt/conda/envs/gdf/bin/python(+0x2109ce) [0x55dedc1789ce]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55dedc09f7ac]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55dedc09b516]
39  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55dedc0a7802]
40  /opt/conda/envs/gdf/bin/python(+0x14cadc) [0x55dedc0b4adc]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55dedc09b516]
42  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55dedc0a7802]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dedc097606]
44  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55dedc096184]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55dedc0a7559]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dedc097606]
47  /opt/conda/envs/gdf/bin/python(+0x13f802) [0x55dedc0a7802]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55dedc097352]
49  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55dedc096184]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55dedc0a7559]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55dedc098162]
52  /opt/conda/envs/gdf/bin/python(+0x12e184) [0x55dedc096184]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55dedc095e58]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55dedc095e09]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55dedc1434ab]
56  /opt/conda/envs/gdf/bin/python(+0x20887a) [0x55dedc17087a]
57  /opt/conda/envs/gdf/bin/python(+0x204c03) [0x55dedc16cc03]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55dedc164a1a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55dedc16490c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55dedc163b47]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55dedc1372e7]
=================================
2024-03-28 06:19:05,361 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58961
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f83f807a100, tag: 0xfd3d69f1afb64c22, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f83f807a100, tag: 0xfd3d69f1afb64c22, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-28 06:19:05,363 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:58961' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 5, 3), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 0, 3), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 6, 3), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 1, 3), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 7, 3), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 2, 3), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 3, 3), ('generate-data-8272b35ed56eebf02983170a8d0abff0', 0), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 4, 3)} (stimulus_id='handle-worker-cleanup-1711606745.3628147')
2024-03-28 06:19:05,361 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58961
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f86280b9180, tag: 0xe5a26aacc7b7643c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f86280b9180, tag: 0xe5a26aacc7b7643c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-03-28 06:19:05,367 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58961
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 467, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1016, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 328, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 60, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1940, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 469, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1564, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1674, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2860, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1676, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2024-03-28 06:19:05,476 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:55727 -> ucx://127.0.0.1:53117
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f86280b9300, tag: 0x6372eb651eeb406f, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-28 06:19:05,477 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:53117' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 6, 1), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 1, 1), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 7, 1), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 2, 1), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 5, 1), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 0, 1), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 3, 1), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 6, 4), ('generate-data-8272b35ed56eebf02983170a8d0abff0', 3)} (stimulus_id='handle-worker-cleanup-1711606745.477047')
2024-03-28 06:19:05,477 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53117
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f86280b9200, tag: 0xd26f4cdc275585d0, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f86280b9200, tag: 0xd26f4cdc275585d0, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
Task exception was never retrieved
future: <Task finished name='Task-1149' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:140> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 155, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 55, in exchange_peer_info
    await asyncio.wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2024-03-28 06:19:05,494 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53117
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f83f807a240, tag: 0xbf9ad7c0eed54b1d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f83f807a240, tag: 0xbf9ad7c0eed54b1d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-28 06:19:05,622 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58623
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f83f807a140, tag: 0x4d40db6e246778ca, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f83f807a140, tag: 0x4d40db6e246778ca, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2024-03-28 06:19:05,622 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58623
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7ff93835b140, tag: 0xdd176745f5f3e65e, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7ff93835b140, tag: 0xdd176745f5f3e65e, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-03-28 06:19:05,623 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:58623' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 4, 5), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 5, 5), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 0, 5), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 6, 5), ('generate-data-8272b35ed56eebf02983170a8d0abff0', 1), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 1, 5), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 7, 5), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 2, 5), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 3, 5)} (stimulus_id='handle-worker-cleanup-1711606745.6231258')
2024-03-28 06:19:05,622 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58623
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f86280b9100, tag: 0xf1074a72d23cc254, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f86280b9100, tag: 0xf1074a72d23cc254, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-28 06:19:05,913 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48263
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f83f807a1c0, tag: 0xd6f7b015ed602d96, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f83f807a1c0, tag: 0xd6f7b015ed602d96, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-03-28 06:19:05,914 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48263
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 350, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f86280b91c0, tag: 0xda1581e63e10820a, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 368, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f86280b91c0, tag: 0xda1581e63e10820a, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2024-03-28 06:19:05,914 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:47169 -> ucx://127.0.0.1:48263
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff93835b440, tag: 0x7482f0093dd23c4f, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-28 06:19:05,915 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:48263' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 6, 6), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 1, 6), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 7, 6), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 2, 6), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 3, 6), ('generate-data-8272b35ed56eebf02983170a8d0abff0', 4), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 4, 6), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 5, 6), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 0, 6)} (stimulus_id='handle-worker-cleanup-1711606745.9149063')
2024-03-28 06:19:05,915 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38741 -> ucx://127.0.0.1:48263
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f83f807a3c0, tag: 0x7a5fb732062d8d01, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-28 06:19:05,915 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:48263
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7ff93835b200, tag: 0x2d10c29caa26e9cb, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7ff93835b200, tag: 0x2d10c29caa26e9cb, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-03-28 06:19:05,928 - distributed.scheduler - WARNING - Removing worker 'ucx://127.0.0.1:44999' caused the cluster to lose already computed task(s), which will be recomputed elsewhere: {('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 1, 0), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 4, 2), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 5, 2), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 0, 2), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 6, 2), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 1, 2), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 2, 2), ('split-simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 3, 2), ('generate-data-8272b35ed56eebf02983170a8d0abff0', 6)} (stimulus_id='handle-worker-cleanup-1711606745.9287355')
2024-03-28 06:19:05,934 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38741 -> ucx://127.0.0.1:44999
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 334, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 662, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f83f807a300, tag: 0xe2846b3a9af4c1bd, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2024-03-28 06:19:05,946 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:44999
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f83f807a180, tag: 0xc3cd0b10f8457a7e, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f83f807a180, tag: 0xc3cd0b10f8457a7e, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-03-28 06:19:05,946 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:44999
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 392, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 737, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7ff93835b240, tag: 0xd2e73e70c8e693b5, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1154, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 832, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 398, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7ff93835b240, tag: 0xd2e73e70c8e693b5, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2024-03-28 06:19:06,854 - distributed.worker - WARNING - Compute Failed
Key:       ('sort_index-e84572c8c86d004d17fc3bda3df647a6', 4)
Function:  subgraph_callable-4a2dcbdaf1fd40dbb7dce1f343ec547f
args:      ('set_index_post_scalar-7790638cf35891e298531e2ec720c4c5',                 key  shuffle   payload  _partitions
0             11975        4  84513553            4
1             23234        4  39742374            4
2             11978        4  94210713            4
3             23242        4  65444865            4
4             11397        4  83270254            4
...             ...      ...       ...          ...
99999995  799987927        4  75736333            4
99999996  799987963        4  78472678            4
99999997  799987854        4   9077262            4
99999998  799987864        4  87217155            4
99999999  799987865        4  92953893            4

[100000000 rows x 4 columns], 'simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4')
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:424: Maximum pool size exceeded')"

2024-03-28 06:19:06,987 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-2458cef5ac6baf4e0e743a53a45427b4', 3)
Function:  _concat
args:      ([               key  shuffle   payload  _partitions
0            11981        3  56312204            3
1            23233        3  15785579            3
2            11984        3  28911668            3
3            23241        3  18519986            3
4            11393        3   8776956            3
...            ...      ...       ...          ...
12499995  99959660        3  73272382            3
12499996  99959669        3  65032622            3
12499997  99959674        3  47471371            3
12499998  99959675        3  34078593            3
12499999  99959676        3  95255966            3

[12500000 rows x 4 columns],                 key  shuffle   payload  _partitions
0         100032359        3  45025705            3
1         100002284        3  60590562            3
2         100032363        3  19461576            3
3         100002292        3  19194261            3
4         100020161        3  20415727            3
...             ...      ...       ...      
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:424: Maximum pool size exceeded')"

2024-03-28 06:19:18,104 - distributed.nanny - WARNING - Restarting worker
2024-03-28 06:19:18,707 - distributed.nanny - WARNING - Restarting worker
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 18 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
