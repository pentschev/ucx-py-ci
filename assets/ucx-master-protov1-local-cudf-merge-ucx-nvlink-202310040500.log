/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/node.py:182: UserWarning: Port 8787 is already in use.
Perhaps you already have a cluster running?
Hosting the HTTP server on port 42335 instead
  warnings.warn(
[dgx13:85193:0:85193] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  85193) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd0ddc47eed]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c0e4) [0x7fd0ddc480e4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c2aa) [0x7fd0ddc482aa]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd182cff420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fd0ddcc9657]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fd0ddcf1dcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2086f) [0x7fd0ddc0086f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a48) [0x7fd0ddc03a48]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd0ddc51639]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd0ddc02b5d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd0ddcc655a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fd0ddd8d5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x558af1e2a6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558af1e26094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558af1e37519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558af1e275c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x558af1eda162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7fd102ecd1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x558af1e2f77c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x558af1de1d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x558af1e2e7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x558af1e2c929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558af1e377c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558af1e275c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558af1e377c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558af1e275c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558af1e377c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558af1e275c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558af1e377c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558af1e275c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558af1e26094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558af1e37519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x558af1e28128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558af1e26094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x558af1e44ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x558af1e4544c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x558af1f0810e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x558af1e2f77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x558af1e2a6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558af1e377c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x558af1e44dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x558af1e2a6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558af1e377c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558af1e275c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558af1e26094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558af1e37519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558af1e275c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x558af1e377c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x558af1e27312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558af1e26094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558af1e37519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x558af1e28128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x558af1e26094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x558af1e25d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x558af1e25d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x558af1ed307b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x558af1efffca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x558af1efc353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x558af1ef416a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x558af1ef405c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x558af1ef3297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x558af1ec6f07]
=================================
2023-10-04 05:50:56,615 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:36063 -> ucx://127.0.0.1:36775
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3be8f51100, tag: 0x107b1a0fdaba0c10, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:50:56,716 - distributed.nanny - WARNING - Restarting worker
[dgx13:85189:0:85189] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  85189) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f7f64044eed]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c0e4) [0x7f7f640450e4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c2aa) [0x7f7f640452aa]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f8005100420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f7f640c6657]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f7f640eedcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2086f) [0x7f7f61fe486f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a48) [0x7f7f61fe7a48]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f7f6404e639]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f7f61fe6b5d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f7f640c355a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f7f6418a5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5620d52f06fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5620d52ec094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5620d52fd519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5620d52ed5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5620d53a0162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f7f852c51e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5620d52f577c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5620d52a7d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5620d52f47f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5620d52f2929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5620d52fd7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5620d52ed5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5620d52fd7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5620d52ed5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5620d52fd7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5620d52ed5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5620d52fd7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5620d52ed5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5620d52ec094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5620d52fd519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5620d52ee128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5620d52ec094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5620d530accb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5620d530b44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5620d53ce10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5620d52f577c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5620d52f06fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5620d52fd7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5620d530adac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5620d52f06fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5620d52fd7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5620d52ed5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5620d52ec094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5620d52fd519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5620d52ed5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5620d52fd7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5620d52ed312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5620d52ec094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5620d52fd519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5620d52ee128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5620d52ec094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5620d52ebd68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5620d52ebd19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5620d539907b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5620d53c5fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5620d53c2353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5620d53ba16a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5620d53ba05c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5620d53b9297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5620d538cf07]
=================================
[dgx13:85181:0:85181] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  85181) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f3be921deed]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c0e4) [0x7f3be921e0e4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c2aa) [0x7f3be921e2aa]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f3c8e180420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f3be929f657]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f3be92c7dcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2086f) [0x7f3be91d686f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a48) [0x7f3be91d9a48]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f3be9227639]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f3be91d8b5d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f3be929c55a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f3be93635fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55b86adf96fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55b86adf5094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55b86ae06519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b86adf65c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x55b86aea9162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f3c0e3481e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55b86adfe77c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55b86adb0d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55b86adfd7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55b86adfb929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55b86ae067c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b86adf65c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55b86ae067c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b86adf65c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55b86ae067c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b86adf65c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55b86ae067c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b86adf65c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55b86adf5094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55b86ae06519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55b86adf7128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55b86adf5094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55b86ae13ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55b86ae1444c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55b86aed710e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55b86adfe77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55b86adf96fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55b86ae067c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55b86ae13dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55b86adf96fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55b86ae067c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b86adf65c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55b86adf5094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55b86ae06519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55b86adf65c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55b86ae067c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55b86adf6312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55b86adf5094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55b86ae06519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55b86adf7128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55b86adf5094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55b86adf4d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55b86adf4d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55b86aea207b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55b86aecefca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55b86aecb353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55b86aec316a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55b86aec305c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55b86aec2297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55b86ae95f07]
=================================
[dgx13:85185:0:85185] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  85185) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f5a94098eed]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c0e4) [0x7f5a940990e4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c2aa) [0x7f5a940992aa]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f5b35095420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f5a91f76657]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f5a91f9edcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2086f) [0x7f5a9405186f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a48) [0x7f5a94054a48]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f5a940a2639]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f5a94053b5d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f5a91f7355a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f5a941095fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5636f56786fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5636f5674094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5636f5685519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636f56755c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636f56857c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x5636f5692e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x5636f579db2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5636f562fd05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5636f567c7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5636f567a929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636f56857c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636f56755c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636f56857c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636f56755c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636f56857c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636f56755c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636f56857c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636f56755c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5636f5674094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5636f5685519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5636f5676128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5636f5674094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5636f5692ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5636f569344c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5636f575610e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5636f567d77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5636f56786fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636f56857c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5636f5692dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5636f56786fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636f56857c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636f56755c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5636f5674094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5636f5685519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5636f56755c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5636f56857c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5636f5675312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5636f5674094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5636f5685519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5636f5676128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5636f5674094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5636f5673d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5636f5673d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5636f572107b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5636f574dfca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5636f574a353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5636f574216a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5636f574205c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5636f5741297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5636f5714f07]
=================================
2023-10-04 05:50:57,345 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:57409 -> ucx://127.0.0.1:36063
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f9db3f31140, tag: 0x9ca751f8bc037f5, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:50:57,345 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44927 -> ucx://127.0.0.1:57421
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fd347570140, tag: 0xd15d1120851b017c, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:50:57,350 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44927 -> ucx://127.0.0.1:34635
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fd3475701c0, tag: 0xee3a0eef0f51eca2, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:50:57,350 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:57409 -> ucx://127.0.0.1:34635
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f9db3f311c0, tag: 0xd8a3ae34bc41a4d4, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:50:57,351 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44927 -> ucx://127.0.0.1:36063
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fd347570100, tag: 0xa8f8a89037469553, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:50:57,349 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36063
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fe6bcc3c140, tag: 0x95f356df688707ae, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fe6bcc3c140, tag: 0x95f356df688707ae, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-10-04 05:50:57,356 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34245 -> ucx://127.0.0.1:36063
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fe6bcc3c2c0, tag: 0xb1baac96bb5658a, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:50:57,357 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34245 -> ucx://127.0.0.1:34635
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #015] ep: 0x7fe6bcc3c100, tag: 0x2e823646260e609, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:50:57,357 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:34635
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #010] ep: 0x7fe6bcc3c280, tag: 0xd5123954ac6b601c, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #010] ep: 0x7fe6bcc3c280, tag: 0xd5123954ac6b601c, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-10-04 05:50:57,358 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:57421
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7fe6bcc3c1c0, tag: 0x1e1d521b429454c4, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2849, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1626, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1516, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7fe6bcc3c1c0, tag: 0x1e1d521b429454c4, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
Task exception was never retrieved
future: <Task finished name='Task-955' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-10-04 05:50:57,361 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38823 -> ucx://127.0.0.1:57421
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff0d48b6180, tag: 0xcc987895901c19e6, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:50:57,363 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38823 -> ucx://127.0.0.1:36063
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 320, in write
    await self.ep.send(struct.pack("?Q", False, nframes))
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 629, in send
    self._ep.raise_on_error()
  File "ucp/_libs/ucx_endpoint.pyx", line 353, in ucp._libs.ucx_api.UCXEndpoint.raise_on_error
ucp._libs.exceptions.UCXConnectionReset: Endpoint 0x7ff0d48b6140 error: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:50:57,454 - distributed.nanny - WARNING - Restarting worker
2023-10-04 05:50:57,599 - distributed.nanny - WARNING - Restarting worker
2023-10-04 05:50:57,600 - distributed.nanny - WARNING - Restarting worker
[dgx13:85177:0:85177] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  85177) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f9de01f7eed]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c0e4) [0x7f9de01f80e4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c2aa) [0x7f9de01f82aa]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f9e8116b420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f9de0279657]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f9de02a1dcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2086f) [0x7f9de01b086f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a48) [0x7f9de01b3a48]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f9de0201639]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f9de01b2b5d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f9de027655a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f9de033d5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x561274fdf6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561274fdb094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561274fec519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561274fdc5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x56127508f162]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f9e7401e1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x561274fe477c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x561274f96d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x561274fe37f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x561274fe1929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561274fec7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561274fdc5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561274fec7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561274fdc5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561274fec7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561274fdc5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561274fec7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561274fdc5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561274fdb094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561274fec519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x561274fdd128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561274fdb094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x561274ff9ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x561274ffa44c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5612750bd10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x561274fe477c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x561274fdf6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561274fec7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x561274ff9dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x561274fdf6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561274fec7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561274fdc5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561274fdb094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561274fec519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561274fdc5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561274fec7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x561274fdc312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561274fdb094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561274fec519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x561274fdd128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561274fdb094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x561274fdad68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x561274fdad19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56127508807b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5612750b4fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5612750b1353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5612750a916a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5612750a905c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5612750a8297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x56127507bf07]
=================================
[dgx13:85195:0:85195] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  85195) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd34781deed]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c0e4) [0x7fd34781e0e4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c2aa) [0x7fd34781e2aa]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd3ec905420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fd34789f657]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fd3478c7dcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2086f) [0x7fd3477d686f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a48) [0x7fd3477d9a48]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd347827639]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd3477d8b5d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd34789c55a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fd3479635fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559132b3d6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559132b39094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559132b4a519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559132b3a5c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559132b4a7c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x559132b57e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x559132c62b2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x559132af4d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x559132b417f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x559132b3f929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559132b4a7c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559132b3a5c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559132b4a7c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559132b3a5c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559132b4a7c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559132b3a5c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559132b4a7c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559132b3a5c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559132b39094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559132b4a519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x559132b3b128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559132b39094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x559132b57ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x559132b5844c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x559132c1b10e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559132b4277c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559132b3d6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559132b4a7c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x559132b57dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x559132b3d6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559132b4a7c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559132b3a5c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559132b39094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559132b4a519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559132b3a5c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x559132b4a7c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x559132b3a312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559132b39094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559132b4a519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x559132b3b128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x559132b39094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x559132b38d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559132b38d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x559132be607b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x559132c12fca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x559132c0f353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x559132c0716a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x559132c0705c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x559132c06297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x559132bd9f07]
=================================
2023-10-04 05:50:58,155 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38823 -> ucx://127.0.0.1:44927
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff0d48b6240, tag: 0x7b568147a70155f6, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:50:58,155 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:57409
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #017] ep: 0x7fe6bcc3c180, tag: 0xa123d13f520b14f4, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #017] ep: 0x7fe6bcc3c180, tag: 0xa123d13f520b14f4, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-10-04 05:50:58,155 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38823 -> ucx://127.0.0.1:57409
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff0d48b6200, tag: 0xa74a6f25704797f6, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:50:58,155 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:44927
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #017] ep: 0x7fe6bcc3c240, tag: 0x34ec5892a269a6b7, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #017] ep: 0x7fe6bcc3c240, tag: 0x34ec5892a269a6b7, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-10-04 05:50:58,156 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:44927
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7ff0d48b61c0, tag: 0x14809df12bfbea33, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7ff0d48b61c0, tag: 0x14809df12bfbea33, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-10-04 05:50:58,157 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:57409
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7ff0d48b6180, tag: 0xa8af008ebdb47660, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7ff0d48b6180, tag: 0xa8af008ebdb47660, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-10-04 05:50:58,282 - distributed.nanny - WARNING - Restarting worker
2023-10-04 05:50:58,369 - distributed.nanny - WARNING - Restarting worker
[dgx13:85362:0:85362] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  85362) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fda63de8eed]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c0e4) [0x7fda63de90e4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c2aa) [0x7fda63de92aa]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fdb0ad51420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fda63e6a657]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fda63e92dcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2086f) [0x7fda63da186f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a48) [0x7fda63da4a48]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fda63df2639]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fda63da3b5d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fda63e6755a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fda63f2e5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55c2e522a6fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c2e5226094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c2e5237519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c2e52275c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c2e52377c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55c2e5244e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55c2e534fb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55c2e51e1d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55c2e522e7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55c2e522c929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c2e52377c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c2e52275c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c2e52377c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c2e52275c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c2e52377c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c2e52275c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c2e52377c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c2e52275c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c2e5226094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c2e5237519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55c2e5228128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c2e5226094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55c2e5244ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55c2e524544c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55c2e530810e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55c2e522f77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55c2e522a6fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c2e52377c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55c2e5244dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55c2e522a6fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c2e52377c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c2e52275c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c2e5226094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c2e5237519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c2e52275c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55c2e52377c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55c2e5227312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c2e5226094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c2e5237519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55c2e5228128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55c2e5226094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55c2e5225d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55c2e5225d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55c2e52d307b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55c2e52fffca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55c2e52fc353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55c2e52f416a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55c2e52f405c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55c2e52f3297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55c2e52c6f07]
=================================
2023-10-04 05:51:01,402 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34245 -> ucx://127.0.0.1:47961
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fe6bcc3c100, tag: 0xef7ec7585aa46ff3, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:51:01,447 - distributed.nanny - WARNING - Restarting worker
[dgx13:85372:0:85372] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  85372) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f27e8871eed]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c0e4) [0x7f27e88720e4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c2aa) [0x7f27e88722aa]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f287b7b7420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f27e88f3657]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f27e891bdcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2086f) [0x7f27e882a86f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a48) [0x7f27e882da48]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f27e887b639]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f27e882cb5d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f27e88f055a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f27e89b75fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x561be92396fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561be9235094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561be9246519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561be92365c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561be92467c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x561be9253e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x561be935eb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x561be91f0d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x561be923d7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x561be923b929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561be92467c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561be92365c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561be92467c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561be92365c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561be92467c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561be92365c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561be92467c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561be92365c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561be9235094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561be9246519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x561be9237128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561be9235094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x561be9253ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x561be925444c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x561be931710e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x561be923e77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x561be92396fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561be92467c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x561be9253dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x561be92396fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561be92467c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561be92365c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561be9235094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561be9246519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x561be92365c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x561be92467c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x561be9236312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561be9235094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x561be9246519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x561be9237128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x561be9235094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x561be9234d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x561be9234d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x561be92e207b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x561be930efca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x561be930b353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x561be930316a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x561be930305c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x561be9302297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x561be92d5f07]
=================================
2023-10-04 05:51:01,783 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34245 -> ucx://127.0.0.1:42077
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fe6bcc3c100, tag: 0xaaf5b8cf2bdea7eb, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:51:01,784 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38823 -> ucx://127.0.0.1:42077
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff0d48b6240, tag: 0xeeb3737656363a41, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:51:01,828 - distributed.nanny - WARNING - Restarting worker
[dgx13:85375:0:85375] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  85375) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fc0337e6eed]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c0e4) [0x7fc0337e70e4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c2aa) [0x7fc0337e72aa]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fc0d874f420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7fc033868657]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7fc033890dcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2086f) [0x7fc03379f86f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a48) [0x7fc0337a2a48]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fc0337f0639]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fc0337a1b5d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fc03386555a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7fc03392c5fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55fcb5aa76fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55fcb5aa3094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55fcb5ab4519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fcb5aa45c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fcb5ab47c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x55fcb5ac1e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x55fcb5bccb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x55fcb5a5ed05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x55fcb5aab7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x55fcb5aa9929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fcb5ab47c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fcb5aa45c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fcb5ab47c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fcb5aa45c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fcb5ab47c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fcb5aa45c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fcb5ab47c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fcb5aa45c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55fcb5aa3094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55fcb5ab4519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55fcb5aa5128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55fcb5aa3094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x55fcb5ac1ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55fcb5ac244c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x55fcb5b8510e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55fcb5aac77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55fcb5aa76fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fcb5ab47c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x55fcb5ac1dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x55fcb5aa76fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fcb5ab47c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fcb5aa45c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55fcb5aa3094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55fcb5ab4519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55fcb5aa45c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x55fcb5ab47c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55fcb5aa4312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55fcb5aa3094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55fcb5ab4519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x55fcb5aa5128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x55fcb5aa3094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55fcb5aa2d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55fcb5aa2d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55fcb5b5007b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x55fcb5b7cfca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x55fcb5b79353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55fcb5b7116a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55fcb5b7105c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55fcb5b70297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55fcb5b43f07]
=================================
2023-10-04 05:51:02,186 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34245 -> ucx://127.0.0.1:54305
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fe6bcc3c100, tag: 0x358d57721c96b1c8, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:51:02,187 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38823 -> ucx://127.0.0.1:54305
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff0d48b6240, tag: 0x39a00652cb381df8, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:51:02,233 - distributed.nanny - WARNING - Restarting worker
[dgx13:85365:0:85365] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x450)
==== backtrace (tid:  85365) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f3d25a1eeed]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c0e4) [0x7f3d25a1f0e4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2c2aa) [0x7f3d25a1f2aa]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f3de096b420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x17) [0x7f3d25aa0657]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x65d) [0x7f3d25ac8dcd]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2086f) [0x7f3d259d786f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a48) [0x7f3d259daa48]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f3d25a28639]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f3d259d9b5d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f3d25a9d55a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x3a5fa) [0x7f3d25b645fa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5639b86596fb]
13  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5639b8655094]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5639b8666519]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5639b86565c6]
16  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5639b86667c2]
17  /opt/conda/envs/gdf/bin/python(+0x14de83) [0x5639b8673e83]
18  /opt/conda/envs/gdf/bin/python(+0x258b2c) [0x5639b877eb2c]
19  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5639b8610d05]
20  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5639b865d7f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5639b865b929]
22  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5639b86667c2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5639b86565c6]
24  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5639b86667c2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5639b86565c6]
26  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5639b86667c2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5639b86565c6]
28  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5639b86667c2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5639b86565c6]
30  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5639b8655094]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5639b8666519]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5639b8657128]
33  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5639b8655094]
34  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5639b8673ccb]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5639b867444c]
36  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5639b873710e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5639b865e77c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5639b86596fb]
39  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5639b86667c2]
40  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5639b8673dac]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5639b86596fb]
42  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5639b86667c2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5639b86565c6]
44  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5639b8655094]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5639b8666519]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5639b86565c6]
47  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5639b86667c2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5639b8656312]
49  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5639b8655094]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5639b8666519]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5639b8657128]
52  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5639b8655094]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5639b8654d68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5639b8654d19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5639b870207b]
56  /opt/conda/envs/gdf/bin/python(+0x208fca) [0x5639b872efca]
57  /opt/conda/envs/gdf/bin/python(+0x205353) [0x5639b872b353]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5639b872316a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5639b872305c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5639b8722297]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5639b86f5f07]
=================================
2023-10-04 05:51:02,594 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34245 -> ucx://127.0.0.1:52837
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fe6bcc3c100, tag: 0xb4f6a3d176053770, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-10-04 05:51:02,635 - distributed.nanny - WARNING - Restarting worker
2023-10-04 05:51:04,395 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38823 -> ucx://127.0.0.1:52837
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7ff0d48b6240, tag: 0x55b076c26c992dab, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1782, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
