[1702624381.102344] [dgx13:73416:0]            sock.c:470  UCX  ERROR bind(fd=164 addr=0.0.0.0:36166) failed: Address already in use
[1702624381.308232] [dgx13:73416:0]            sock.c:470  UCX  ERROR bind(fd=179 addr=0.0.0.0:39578) failed: Address already in use
[1702624393.220374] [dgx13:73516:0]    ib_mlx5dv_md.c:468  UCX  ERROR mlx5_1: LRU push returned Unsupported operation
[dgx13:73516:0:73516]        rndv.c:166  Fatal: failed to pack rendezvous remote key: Unsupported operation
==== backtrace (tid:  73516) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f8dcd9a806d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0x51) [0x7f8dcd9a5c11]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x27dac) [0x7f8dcd9a5dac]
 3  /opt/conda/envs/gdf/lib/libucp.so.0(+0x739e8) [0x7f8dcda4f9e8]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_do_am_single+0xdf) [0x7f8dcda26d7f]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_proto_progress_tag_rndv_rts+0x1d) [0x7f8dcda62aed]
 6  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_send_nbx+0x6da) [0x7f8dcda679da]
 7  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_send_nb+0x4f) [0x7f8dcda6871f]
 8  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x6c6f0) [0x7f8dcdb166f0]
 9  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5612dce5e44c]
10  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5612dce436fb]
11  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5612dce3f094]
12  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5612dce50519]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5612dce41128]
14  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5612dce3f094]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5612dce50519]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5612dce41128]
17  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5612dcef3162]
18  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x5612dce45e64]
19  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5612dcef3162]
20  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x5612dce45e64]
21  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5612dcef3162]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x5612dce45e64]
23  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5612dcef3162]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x5612dce45e64]
25  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5612dcef3162]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x5612dce45e64]
27  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x5612dcef3162]
28  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f8e68fc51e9]
29  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x8aa6) [0x7f8e68fc5aa6]
30  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5612dce4877c]
31  /opt/conda/envs/gdf/bin/python(+0xead05) [0x5612dcdfad05]
32  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x5612dce477f3]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x5612dce45929]
34  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5612dce507c2]
35  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5612dce405c6]
36  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5612dce507c2]
37  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5612dce405c6]
38  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5612dce507c2]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5612dce405c6]
40  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5612dce507c2]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5612dce405c6]
42  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5612dce3f094]
43  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5612dce50519]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x5612dce41128]
45  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5612dce3f094]
46  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x5612dce5dccb]
47  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5612dce5e44c]
48  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x5612dcf2110e]
49  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5612dce4877c]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5612dce436fb]
51  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5612dce507c2]
52  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x5612dce5ddac]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x5612dce436fb]
54  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5612dce507c2]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5612dce405c6]
56  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5612dce3f094]
57  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5612dce50519]
58  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5612dce405c6]
59  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x5612dce507c2]
60  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5612dce40312]
61  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x5612dce3f094]
=================================
[1702624393.442583] [dgx13:73504:0]    ib_mlx5dv_md.c:468  UCX  ERROR mlx5_0: LRU push returned Unsupported operation
[dgx13:73504:0:73504]        rndv.c:166  Fatal: failed to pack rendezvous remote key: Unsupported operation
==== backtrace (tid:  73504) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f285c02c06d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0x51) [0x7f285c029c11]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x27dac) [0x7f285c029dac]
 3  /opt/conda/envs/gdf/lib/libucp.so.0(+0x739e8) [0x7f284938b9e8]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_do_am_single+0xdf) [0x7f2849362d7f]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_proto_progress_tag_rndv_rts+0x1d) [0x7f284939eaed]
 6  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_send_nbx+0x6da) [0x7f28493a39da]
 7  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_send_nb+0x4f) [0x7f28493a471f]
 8  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x6c6f0) [0x7f28494526f0]
 9  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56030bcfa44c]
10  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56030bcdf6fb]
11  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56030bcdb094]
12  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56030bcec519]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56030bcdd128]
14  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56030bcdb094]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56030bcec519]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56030bcdd128]
17  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x56030bd8f162]
18  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x56030bce1e64]
19  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x56030bd8f162]
20  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x56030bce1e64]
21  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x56030bd8f162]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x56030bce1e64]
23  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x56030bd8f162]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x56030bce1e64]
25  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x56030bd8f162]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f34) [0x56030bce1e64]
27  /opt/conda/envs/gdf/bin/python(+0x1e3162) [0x56030bd8f162]
28  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f28e49501e9]
29  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x8aa6) [0x7f28e4950aa6]
30  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56030bce477c]
31  /opt/conda/envs/gdf/bin/python(+0xead05) [0x56030bc96d05]
32  /opt/conda/envs/gdf/bin/python(+0x1377f3) [0x56030bce37f3]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x59f9) [0x56030bce1929]
34  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56030bcec7c2]
35  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56030bcdc5c6]
36  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56030bcec7c2]
37  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56030bcdc5c6]
38  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56030bcec7c2]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56030bcdc5c6]
40  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56030bcec7c2]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56030bcdc5c6]
42  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56030bcdb094]
43  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56030bcec519]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f8) [0x56030bcdd128]
45  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56030bcdb094]
46  /opt/conda/envs/gdf/bin/python(+0x14dccb) [0x56030bcf9ccb]
47  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56030bcfa44c]
48  /opt/conda/envs/gdf/bin/python(+0x21110e) [0x56030bdbd10e]
49  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56030bce477c]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56030bcdf6fb]
51  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56030bcec7c2]
52  /opt/conda/envs/gdf/bin/python(+0x14ddac) [0x56030bcf9dac]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x37cb) [0x56030bcdf6fb]
54  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56030bcec7c2]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56030bcdc5c6]
56  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56030bcdb094]
57  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56030bcec519]
58  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56030bcdc5c6]
59  /opt/conda/envs/gdf/bin/python(+0x1407c2) [0x56030bcec7c2]
60  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x56030bcdc312]
61  /opt/conda/envs/gdf/bin/python(+0x12f094) [0x56030bcdb094]
=================================
2023-12-15 07:13:15,824 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:44015
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #007] ep: 0x7f4bf0188100, tag: 0xa5207893d8c26c35, nbytes: 800000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #007] ep: 0x7f4bf0188100, tag: 0xa5207893d8c26c35, nbytes: 800000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-12-15 07:13:16,065 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41204
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #007] ep: 0x7f4bf0188180, tag: 0x1e57b822532f47e6, nbytes: 800000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #007] ep: 0x7f4bf0188180, tag: 0x1e57b822532f47e6, nbytes: 800000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-12-15 07:13:18,307 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-b0648aa7f9e27a40d5f4d39e31c5b5a2', 7)
Function:  _concat
args:      ([               key   payload
shuffle                     
0            16690  13801882
0           196541  96569504
0           207186  14192911
0           251682  59686912
0           178394  18327728
...            ...       ...
0        799893403  48959984
0        799948116  24969656
0        799854622  65779516
0        799848031  72418147
0        799925626  84739405

[12498151 rows x 2 columns],                key   payload
shuffle                     
1           253234  98655077
1           115791  49762161
1           233625  17461645
1           158933  15567581
1            45599  78056049
...            ...       ...
1        799839566  99385704
1        799771413  71117334
1        799825664  95663928
1        799704764  76244678
1        799830444  47192694

[12498591 rows x 2 columns],                key   payload
shuffle                     
2          1113771  34586860
2          1122434  21028665
2          1120454  25105490
2          1088588  31149358
2         
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:273: Maximum pool size exceeded')"

2023-12-15 07:13:18,361 - distributed.core - ERROR - std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:273: Maximum pool size exceeded
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 377, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 378, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:273: Maximum pool size exceeded
2023-12-15 07:13:18,361 - distributed.worker - ERROR - std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:273: Maximum pool size exceeded
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 377, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 378, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:273: Maximum pool size exceeded
2023-12-15 07:13:18,365 - distributed.worker - WARNING - Compute Failed
Key:       ('merge_chunk-adccb87e3fee0e0ff9c5206a34e9fe09', 4)
Function:  subgraph_callable-fa358775-a464-4fb9-821a-41ad66af
args:      (               key   payload
shuffle                     
0           185240  50792488
0           103757  27280083
0            95306  98383655
0            50203  87751007
0           224248   6211716
...            ...       ...
7        799832405   9542045
7        799772062  77406804
7        799891369  16885020
7        799843733  52465264
7        799819145  25293905

[100023899 rows x 2 columns],                  key   payload
2296          783923  85228195
80488      208675411  43382492
2303       860970085  54631523
80492      307449533  57142141
80503      825233458  63344478
...              ...       ...
99958264  1549523744  27245996
99958020  1562349035  31973694
99958028   794803294  79113131
99958033  1541058574  69129523
99958041  1551077164  86432448

[99980499 rows x 2 columns], 'simple-shuffle-84a0276e6a854cf0d6c4324869a61d39', 'simple-shuffle-b0648aa7f9e27a40d5f4d39e31c5b5a2')
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:273: Maximum pool size exceeded')"

2023-12-15 07:13:18,476 - distributed.worker - WARNING - Compute Failed
Key:       ('simple-shuffle-84a0276e6a854cf0d6c4324869a61d39', 6)
Function:  _concat
args:      ([                key   payload
2274        1684027  36609210
80487     861449575  34905541
2290      832365749  90079087
80491     801361136  21222032
2294      854627315  27858095
...             ...       ...
99989448  801383142  51402235
99989454  505630371  99022643
99989456  826809893  85966021
99989457  805328695  37557658
99989467  825099783  22565225

[12497796 rows x 2 columns],                 key   payload
18670     938445100  72528511
39140     941411005  55239584
73413     919703551  57999483
73416     936020591  25199526
39148      17881492  37715732
...             ...       ...
99999704  949474816  91735488
99999710  919055398    199535
99999636  938660106  59117843
99999637  936603874   6216317
99999646  967063132  92441209

[12497151 rows x 2 columns],                  key   payload
11436     1004834137  15614818
11446      328323426  23567619
11448     1030687371  39580142
11455      228715268   3490766
31747     1053018020  71366446
...              ...       ...
9
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/conda-bld/work/include/rmm/mr/device/pool_memory_resource.hpp:273: Maximum pool size exceeded')"

2023-12-15 07:13:19,551 - distributed.core - ERROR - not enough values to unpack (expected 2, got 0)
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 381, in read
    cuda_recv_frames, recv_frames = zip(
ValueError: not enough values to unpack (expected 2, got 0)
2023-12-15 07:13:19,551 - distributed.worker - ERROR - not enough values to unpack (expected 2, got 0)
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 381, in read
    cuda_recv_frames, recv_frames = zip(
ValueError: not enough values to unpack (expected 2, got 0)
2023-12-15 07:13:19,581 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:38172
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 364, in read
    await self.ep.recv(header)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #042] ep: 0x7f6461342180, tag: 0x13987e7d731adcf3, nbytes: 24, type: <class 'numpy.ndarray'>>: Message truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2059, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2852, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1106, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #042] ep: 0x7f6461342180, tag: 0x13987e7d731adcf3, nbytes: 24, type: <class 'numpy.ndarray'>>: Message truncated")
2023-12-15 07:13:25,488 - distributed.nanny - WARNING - Restarting worker
2023-12-15 07:13:25,825 - distributed.nanny - WARNING - Restarting worker
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
