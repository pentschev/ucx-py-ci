/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/node.py:182: UserWarning: Port 8787 is already in use.
Perhaps you already have a cluster running?
Hosting the HTTP server on port 42489 instead
  warnings.warn(
2023-08-04 05:50:52,441 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:50:52,441 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:50:52,449 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:50:52,449 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:50:52,450 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:50:52,450 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:50:52,499 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:50:52,499 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:50:52,500 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:50:52,500 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:50:52,530 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:50:52,530 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:50:52,531 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:50:52,531 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:50:52,548 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:50:52,548 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:74041:0:74041] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74041) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f62782e8f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f62782e9114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f62782e92da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f6309b5d420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f62783625d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f6278387859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f62782a442f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f62782a7798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f62782f1989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f62782a662d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f627835fc4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7f627840a17a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55d5192fab08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55d5192eb112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d5192e427a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d5192f5c05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d5192e581b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d5192f5ef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x55d519303a16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x55d5194139b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55d5192a1817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55d5192ecf83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55d5192ead36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d5192f5ef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d5192e581b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d5192f5ef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d5192e581b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d5192f5ef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d5192e581b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d5192f5ef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d5192e581b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d5192e427a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d5192f5c05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55d5192e9fa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d5192e427a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55d519303935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55d519304104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55d5193cafc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55d5192ee2bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55d5192e91bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d5192f5ef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55d519303c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55d5192e91bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d5192f5ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d5192e581b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d5192e427a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d5192f5c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55d5192e581b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55d5192f5ef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55d5192e5568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d5192e427a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55d5192f5c05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55d5192e63cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55d5192e427a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55d5192e3f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55d5192e3eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55d5193948bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55d5193c2adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55d5193bec24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55d5193b67ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55d5193b66bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x55d5193b58a2]
=================================
2023-08-04 05:51:05,681 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:41441 -> ucx://127.0.0.1:46847
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f4afc650100, tag: 0xcbceb3f6be67cff9, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
[dgx13:74047:0:74047] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74047) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7efeb041df1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7efeb041e114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7efeb041e2da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7eff41c33420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7efeb04975d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7efeb04bc859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7efeb03d942f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7efeb03dc798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7efeb0426989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7efeb03db62d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7efeb0494c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7efeb053f17a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55aa3aea7b08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55aa3ae98112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55aa3ae9127a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55aa3aea2c05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa3ae9281b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa3aea2ef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x55aa3aeb0a16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x55aa3afc09b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55aa3ae4e817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55aa3ae99f83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55aa3ae97d36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa3aea2ef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa3ae9281b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa3aea2ef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa3ae9281b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa3aea2ef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa3ae9281b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa3aea2ef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa3ae9281b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55aa3ae9127a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55aa3aea2c05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55aa3ae96fa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55aa3ae9127a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55aa3aeb0935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55aa3aeb1104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55aa3af77fc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55aa3ae9b2bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55aa3ae961bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa3aea2ef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55aa3aeb0c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55aa3ae961bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa3aea2ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa3ae9281b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55aa3ae9127a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55aa3aea2c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55aa3ae9281b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55aa3aea2ef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55aa3ae92568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55aa3ae9127a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55aa3aea2c05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55aa3ae933cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55aa3ae9127a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55aa3ae90f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55aa3ae90eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55aa3af418bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55aa3af6fadc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55aa3af6bc24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55aa3af637ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55aa3af636bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x55aa3af628a2]
=================================
[dgx13:74038:0:74038] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74038) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f0720665f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f0720666114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f07206662da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f07bfe79420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f07206df5d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f0720704859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f072062142f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f0720624798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f072066e989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f072062362d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f07206dcc4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7f072078717a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x564817e0bb08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x564817dfc112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x564817df527a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x564817e06c05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564817df681b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564817e06ef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x564817e14a16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x564817f249b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x564817db2817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x564817dfdf83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x564817dfbd36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564817e06ef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564817df681b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564817e06ef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564817df681b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564817e06ef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564817df681b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564817e06ef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564817df681b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x564817df527a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x564817e06c05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x564817dfafa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x564817df527a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x564817e14935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x564817e15104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x564817edbfc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x564817dff2bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x564817dfa1bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564817e06ef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x564817e14c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x564817dfa1bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564817e06ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564817df681b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x564817df527a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x564817e06c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564817df681b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564817e06ef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x564817df6568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x564817df527a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x564817e06c05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x564817df73cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x564817df527a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x564817df4f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x564817df4eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x564817ea58bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x564817ed3adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x564817ecfc24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x564817ec77ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x564817ec76bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x564817ec68a2]
=================================
[dgx13:74023:0:74023] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74023) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f9044aebf1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f9044aec114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f9044aec2da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f90d6338420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f9044b655d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f9044b8a859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f9044aa742f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f9044aaa798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f9044af4989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f9044aa962d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f9044b62c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7f9044c0d17a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55e9ed76eb08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55e9ed75f112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e9ed75827a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e9ed769c05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e9ed75981b]
17  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55e9ed77e70e]
18  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f9056ee82fe]
19  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55e9ed7622bc]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55e9ed715817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55e9ed760f83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55e9ed75ed36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e9ed769ef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e9ed75981b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e9ed769ef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e9ed75981b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e9ed769ef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e9ed75981b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e9ed769ef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e9ed75981b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e9ed75827a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e9ed769c05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55e9ed75dfa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e9ed75827a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55e9ed777935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55e9ed778104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55e9ed83efc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55e9ed7622bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55e9ed75d1bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e9ed769ef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55e9ed777c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55e9ed75d1bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e9ed769ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e9ed75981b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e9ed75827a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e9ed769c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55e9ed75981b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55e9ed769ef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55e9ed759568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e9ed75827a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55e9ed769c05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55e9ed75a3cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55e9ed75827a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55e9ed757f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55e9ed757eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55e9ed8088bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55e9ed836adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55e9ed832c24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55e9ed82a7ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55e9ed82a6bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x55e9ed8298a2]
=================================
[dgx13:74044:0:74044] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74044) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fb971e6ff1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7fb971e70114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7fb971e702da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fba136d3420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fb971ee95d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fb971f0e859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7fb97402c42f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7fb97402f798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fb971e78989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fb97402e62d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fb971ee6c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7fb971f9117a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x555993bffb08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x555993bf0112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x555993be927a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x555993bfac05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555993bea81b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555993bfaef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x555993c08a16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x555993d189b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x555993ba6817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x555993bf1f83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x555993befd36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555993bfaef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555993bea81b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555993bfaef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555993bea81b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555993bfaef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555993bea81b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555993bfaef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555993bea81b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x555993be927a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x555993bfac05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x555993beefa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x555993be927a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x555993c08935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x555993c09104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x555993ccffc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x555993bf32bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x555993bee1bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555993bfaef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x555993c08c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x555993bee1bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555993bfaef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555993bea81b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x555993be927a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x555993bfac05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x555993bea81b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x555993bfaef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x555993bea568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x555993be927a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x555993bfac05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x555993beb3cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x555993be927a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x555993be8f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x555993be8eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x555993c998bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x555993cc7adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x555993cc3c24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x555993cbb7ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x555993cbb6bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x555993cba8a2]
=================================
2023-08-04 05:51:06,327 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:06,459 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:41441 -> ucx://127.0.0.1:54623
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f4afc650300, tag: 0x5514ccfd8a3442ab, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-04 05:51:06,459 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54623
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fc4e8d61240, tag: 0x2200391e5558259c, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fc4e8d61240, tag: 0x2200391e5558259c, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-04 05:51:06,460 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54623
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f4afc6501c0, tag: 0x70ac44361a4d0643, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f4afc6501c0, tag: 0x70ac44361a4d0643, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-04 05:51:06,459 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54623
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f9ba8049180, tag: 0x3609c17946465989, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f9ba8049180, tag: 0x3609c17946465989, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
Task exception was never retrieved
future: <Task finished name='Task-1268' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
Task exception was never retrieved
future: <Task finished name='Task-1332' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-08-04 05:51:06,482 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36407
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 468, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 316, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-08-04 05:51:06,483 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36407
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 468, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 316, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-08-04 05:51:06,539 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34201 -> ucx://127.0.0.1:36407
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fc4e8d61300, tag: 0xe35a50eb4db022c2, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-04 05:51:06,583 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:36407
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fc4e8d61180, tag: 0x4b719fb9c9273760, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fc4e8d61180, tag: 0x4b719fb9c9273760, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-04 05:51:06,598 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34201 -> ucx://127.0.0.1:55075
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fc4e8d61380, tag: 0x982599af613cea77, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-04 05:51:06,598 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55075
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fc4e8d611c0, tag: 0x3af1a36cda13a278, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fc4e8d611c0, tag: 0x3af1a36cda13a278, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-04 05:51:06,603 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55075
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f9ba8049200, tag: 0xd6ede635a894d489, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f9ba8049200, tag: 0xd6ede635a894d489, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-04 05:51:06,807 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55075
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f4afc650180, tag: 0xb2f260c7899ea17d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f4afc650180, tag: 0xb2f260c7899ea17d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-04 05:51:07,003 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:07,083 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:07,179 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:07,284 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:08,086 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:08,086 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:08,433 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-84a0276e6a854cf0d6c4324869a61d39', 4)
Function:  <dask.layers.CallableLazyImport object at 0x7f4650
args:      (                 key   payload
0         1218863339  99051695
1         1252208751  78953234
2          652278035  81293845
3         1253618300  74974697
4         1202090160  62919800
...              ...       ...
99999995    50213713  72068972
99999996  1249206659  33160153
99999997  1259655348  40095643
99999998  1252540937  33956372
99999999  1212812172  90324512

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-08-04 05:51:08,441 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-054f65580a5efedc40c26858beb83d02', 1)
Function:  <dask.layers.CallableLazyImport object at 0x7fc04c
args:      (               key   payload
shuffle                     
1           103043  10166526
1           104628   9561949
1            23232  57232459
1           103049  30012994
1           104636  89399706
...            ...       ...
1        799945759  33395218
1        799993529  18675064
1        799994530  93473850
1        799993530  73122158
1        799993532  84760367

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-08-04 05:51:08,776 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:08,776 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:08,836 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:08,837 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:08,914 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:08,914 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:09,047 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:09,047 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:14,836 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-054f65580a5efedc40c26858beb83d02', 6)
Function:  <dask.layers.CallableLazyImport object at 0x7fc04c
args:      (               key   payload
shuffle                     
6            31906  83277924
6            31922   6993419
6            31931  87808633
6            31932  95797726
6            41507  43095847
...            ...       ...
6        799963773  88424880
6        799987207  79738577
6        799987209  13673692
6        799987218  81871428
6        799987230  91406821

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-08-04 05:51:14,860 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-054f65580a5efedc40c26858beb83d02', 5)
Function:  <dask.layers.CallableLazyImport object at 0x7f4650
args:      (               key   payload
shuffle                     
5            31912  72211249
5            31917  31100368
5            31920  72399018
5            31925   9699415
5            41505  28263233
...            ...       ...
5        799987341  15723918
5        799987345   4944612
5        799987346  50634205
5        799987355  37051818
5        799987358  77263567

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

[dgx13:74032:0:74032] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74032) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f9ba82ddf1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f9ba82de114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f9ba82de2da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f9c39af8420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f9ba83575d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f9ba837c859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f9ba829942f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f9ba829c798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f9ba82e6989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f9ba829b62d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f9ba8354c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7f9ba83ff17a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x563542700b08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x5635426f1112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5635426ea27a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5635426fbc05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5635426eb81b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5635426fbef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x563542709a16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x5635428199b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5635426a7817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x5635426f2f83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5635426f0d36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5635426fbef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5635426eb81b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5635426fbef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5635426eb81b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5635426fbef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5635426eb81b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5635426fbef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5635426eb81b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5635426ea27a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5635426fbc05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5635426effa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5635426ea27a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x563542709935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x56354270a104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x5635427d0fc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5635426f42bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5635426ef1bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5635426fbef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x563542709c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5635426ef1bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5635426fbef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5635426eb81b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5635426ea27a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5635426fbc05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5635426eb81b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5635426fbef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5635426eb568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5635426ea27a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5635426fbc05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5635426ec3cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5635426ea27a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5635426e9f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5635426e9eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56354279a8bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x5635427c8adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x5635427c4c24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5635427bc7ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5635427bc6bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x5635427bb8a2]
=================================
[dgx13:74553:0:74553] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74553) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fa64320ef1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7fa64320f114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7fa64320f2da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fa6e28c8420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fa6432885d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fa6432ad859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7fa6431ca42f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7fa6431cd798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fa643217989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fa6431cc62d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fa643285c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7fa64333017a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x558ea3ebab08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x558ea3eab112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558ea3ea427a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558ea3eb5c05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558ea3ea581b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558ea3eb5ef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x558ea3ec3a16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x558ea3fd39b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x558ea3e61817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x558ea3eacf83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x558ea3eaad36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558ea3eb5ef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558ea3ea581b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558ea3eb5ef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558ea3ea581b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558ea3eb5ef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558ea3ea581b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558ea3eb5ef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558ea3ea581b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558ea3ea427a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558ea3eb5c05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x558ea3ea9fa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558ea3ea427a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x558ea3ec3935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x558ea3ec4104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x558ea3f8afc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x558ea3eae2bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x558ea3ea91bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558ea3eb5ef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x558ea3ec3c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x558ea3ea91bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558ea3eb5ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558ea3ea581b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558ea3ea427a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558ea3eb5c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x558ea3ea581b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x558ea3eb5ef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x558ea3ea5568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558ea3ea427a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x558ea3eb5c05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x558ea3ea63cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x558ea3ea427a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x558ea3ea3f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x558ea3ea3eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x558ea3f548bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x558ea3f82adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x558ea3f7ec24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x558ea3f767ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x558ea3f766bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x558ea3f758a2]
=================================
[dgx13:74567:0:74567] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74567) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f3318472f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f3318473114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f33184732da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f33a9caf420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f33184ec5d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f3318511859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f331842e42f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f3318431798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f331847b989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f331843062d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f33184e9c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7f331859417a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x56177683ab08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x56177682b112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56177682427a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x561776835c05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56177682581b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561776835ef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x561776843a16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x5617769539b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5617767e1817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x56177682cf83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x56177682ad36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561776835ef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56177682581b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561776835ef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56177682581b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561776835ef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56177682581b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561776835ef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56177682581b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56177682427a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x561776835c05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x561776829fa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56177682427a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x561776843935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x561776844104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x56177690afc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x56177682e2bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5617768291bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561776835ef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x561776843c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5617768291bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561776835ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56177682581b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56177682427a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x561776835c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56177682581b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x561776835ef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x561776825568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56177682427a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x561776835c05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5617768263cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56177682427a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x561776823f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x561776823eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5617768d48bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x561776902adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x5617768fec24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5617768f67ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5617768f66bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x5617768f58a2]
=================================
Task exception was never retrieved
future: <Task finished name='Task-1371' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
Task exception was never retrieved
future: <Task finished name='Task-1351' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-08-04 05:51:18,822 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54689
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-08-04 05:51:18,822 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54689
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXNotConnected: <stream_recv>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 468, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 316, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
Task exception was never retrieved
future: <Task finished name='Task-1375' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
Task exception was never retrieved
future: <Task finished name='Task-1358' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-08-04 05:51:18,852 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:38665
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 468, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 316, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-08-04 05:51:18,884 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:18,885 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:41441 -> ucx://127.0.0.1:54689
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #010] ep: 0x7f4afc6501c0, tag: 0xdc6c8c14a5e51af0, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-04 05:51:18,886 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54689
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #012] ep: 0x7f4afc650380, tag: 0x17eaffcc80ebbaf, nbytes: 100023112, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #012] ep: 0x7f4afc650380, tag: 0x17eaffcc80ebbaf, nbytes: 100023112, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-08-04 05:51:18,888 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:52571
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f097355c240, tag: 0xb59c8d580d340c1c, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f097355c240, tag: 0xb59c8d580d340c1c, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
[dgx13:74036:0:74036] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74036) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f4afc8c7f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f4afc8c8114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f4afc8c82da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f4b8e0f6420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f4afc9415d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f4afc966859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f4afc88342f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f4afc886798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f4afc8d0989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f4afc88562d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f4afc93ec4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7f4afc9e917a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55fc0f9afb08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55fc0f9a0112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55fc0f99927a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55fc0f9aac05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55fc0f99a81b]
17  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55fc0f9bf70e]
18  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f4b0eca92fe]
19  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55fc0f9a32bc]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55fc0f956817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55fc0f9a1f83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55fc0f99fd36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55fc0f9aaef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55fc0f99a81b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55fc0f9aaef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55fc0f99a81b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55fc0f9aaef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55fc0f99a81b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55fc0f9aaef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55fc0f99a81b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55fc0f99927a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55fc0f9aac05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55fc0f99efa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55fc0f99927a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55fc0f9b8935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55fc0f9b9104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55fc0fa7ffc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55fc0f9a32bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55fc0f99e1bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55fc0f9aaef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55fc0f9b8c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55fc0f99e1bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55fc0f9aaef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55fc0f99a81b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55fc0f99927a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55fc0f9aac05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55fc0f99a81b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55fc0f9aaef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55fc0f99a568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55fc0f99927a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55fc0f9aac05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55fc0f99b3cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55fc0f99927a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55fc0f998f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55fc0f998eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55fc0fa498bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55fc0fa77adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55fc0fa73c24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55fc0fa6b7ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55fc0fa6b6bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x55fc0fa6a8a2]
=================================
Task exception was never retrieved
future: <Task finished name='Task-1376' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
Task exception was never retrieved
future: <Task finished name='Task-1379' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-08-04 05:51:18,894 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54689
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #010] ep: 0x7f866c4881c0, tag: 0xff527809a908ccaa, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #010] ep: 0x7f866c4881c0, tag: 0xff527809a908ccaa, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-08-04 05:51:18,905 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:54689
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #011] ep: 0x7fc4e8d611c0, tag: 0xa6410a8e8624397c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #011] ep: 0x7fc4e8d611c0, tag: 0xa6410a8e8624397c, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-08-04 05:51:18,906 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:38665
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #190] ep: 0x7fc4e8d61140, tag: 0xdfa31adb3c1a44e, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #190] ep: 0x7fc4e8d61140, tag: 0xdfa31adb3c1a44e, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-08-04 05:51:18,906 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:47381 -> ucx://127.0.0.1:52571
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f866c488440, tag: 0xad2a4cf785f601e5, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-04 05:51:18,907 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:52571
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f866c488240, tag: 0xc7f6b1206c7844c1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f866c488240, tag: 0xc7f6b1206c7844c1, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-08-04 05:51:18,916 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:38665
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #012] ep: 0x7f866c488140, tag: 0xa13e217c4d6d9cfa, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #012] ep: 0x7f866c488140, tag: 0xa13e217c4d6d9cfa, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-08-04 05:51:18,992 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:18,995 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:52571
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fb6013a41c0, tag: 0xa1f94729491ddc18, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fb6013a41c0, tag: 0xa1f94729491ddc18, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-04 05:51:19,039 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:19,040 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:52571
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 466, in wait_for
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 330, in connect
    await wait_for(comm.write(local_info), time_left())
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 469, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 289, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 334, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:52571 after 30 s
[dgx13:74563:0:74563] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74563) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f866c73ff1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f866c740114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f866c7402da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f86fde12420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f866c7b95d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f866c7de859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f866c6fb42f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f866c6fe798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f866c748989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f866c6fd62d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f866c7b6c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7f866c86117a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x5641fae8cb08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x5641fae7d112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5641fae7627a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5641fae87c05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5641fae7781b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5641fae87ef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x5641fae95a16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x5641fafa59b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5641fae33817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x5641fae7ef83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5641fae7cd36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5641fae87ef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5641fae7781b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5641fae87ef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5641fae7781b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5641fae87ef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5641fae7781b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5641fae87ef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5641fae7781b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5641fae7627a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5641fae87c05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5641fae7bfa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5641fae7627a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x5641fae95935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5641fae96104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x5641faf5cfc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5641fae802bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5641fae7b1bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5641fae87ef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x5641fae95c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5641fae7b1bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5641fae87ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5641fae7781b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5641fae7627a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5641fae87c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5641fae7781b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5641fae87ef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5641fae77568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5641fae7627a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5641fae87c05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5641fae783cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5641fae7627a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5641fae75f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5641fae75eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5641faf268bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x5641faf54adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x5641faf50c24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5641faf487ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5641faf486bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x5641faf478a2]
=================================
2023-08-04 05:51:19,265 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:19,312 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:52781 -> ucx://127.0.0.1:41441
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fb6013a43c0, tag: 0x63bc05ecace9c90e, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-04 05:51:19,316 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41441
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f097355c2c0, tag: 0xbfdc6c04c3bf7f4f, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f097355c2c0, tag: 0xbfdc6c04c3bf7f4f, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-04 05:51:19,313 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41441
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fb6013a4140, tag: 0xb318162cc4599cc8, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fb6013a4140, tag: 0xb318162cc4599cc8, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-08-04 05:51:19,427 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:39115 -> ucx://127.0.0.1:47381
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f097355c300, tag: 0x7a766438b78e2232, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-04 05:51:19,434 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:47381
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f097355c140, tag: 0xeab091df309829b5, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f097355c140, tag: 0xeab091df309829b5, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-08-04 05:51:19,575 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:20,622 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:20,622 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:20,795 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:20,795 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:20,799 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:20,799 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:21,053 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:21,053 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:21,365 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:21,365 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[1691128285.444913] [dgx13:74859:0]    cuda_copy_md.c:208  UCX  ERROR   cuMemAlloc_v2((CUdeviceptr*)address_p, *length_p)() failed: out of memory
[1691128285.444931] [dgx13:74859:0]         uct_mem.c:155  UCX  ERROR   failed to allocate 536870912 bytes using md cuda_cpy for ucp_rndv_frags: Input/output error
[1691128285.444937] [dgx13:74859:0]           mpool.c:269  UCX  ERROR Failed to allocate memory pool (name=ucp_rndv_frags) chunk: Out of memory
[dgx13:74859:0:74859]        rndv.c:1369 Fatal: failed to allocate fragment memory buffer
==== backtrace (tid:  74859) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fba0db02f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0x51) [0x7fba0db00ad1]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x26c6c) [0x7fba0db00c6c]
 3  /opt/conda/envs/gdf/lib/libucp.so.0(+0x6f48a) [0x7fba0dba548a]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nbx+0xb68) [0x7fba0dbb8738]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nb+0x57) [0x7fba0dbb8917]
 6  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x4facb) [0x7fba0dc48acb]
 7  /opt/conda/envs/gdf/bin/python(+0x149dc7) [0x55722c35adc7]
 8  /opt/conda/envs/gdf/bin/python(PyObject_Call+0x158) [0x55722c3591a8]
 9  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55722c33fd36]
10  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55722c33927a]
11  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55722c34ac05]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55722c33b3cb]
13  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55722c33927a]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55722c34ac05]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55722c33b3cb]
16  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55722c35f70e]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55722c340923]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55722c35f70e]
19  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55722c340923]
20  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55722c35f70e]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55722c340923]
22  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55722c35f70e]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55722c340923]
24  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55722c35f70e]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55722c340923]
26  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55722c35f70e]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55722c340923]
28  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55722c35f70e]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55722c340923]
30  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55722c35f70e]
31  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7fbaa42a32fe]
32  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x8b4e) [0x7fbaa42a3b4e]
33  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55722c3432bc]
34  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55722c2f6817]
35  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55722c341f83]
36  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55722c33fd36]
37  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55722c34aef3]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55722c33a81b]
39  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55722c34aef3]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55722c33a81b]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55722c34aef3]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55722c33a81b]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55722c34aef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55722c33a81b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55722c33927a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55722c34ac05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55722c33efa7]
48  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55722c33927a]
49  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55722c358935]
50  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55722c359104]
51  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55722c41ffc8]
52  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55722c3432bc]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55722c33e1bb]
54  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55722c34aef3]
55  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55722c358c72]
56  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55722c33e1bb]
57  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55722c34aef3]
58  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55722c33a81b]
59  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55722c33927a]
60  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55722c34ac05]
61  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55722c33a81b]
=================================
[1691128285.469615] [dgx13:74866:0]    cuda_copy_md.c:208  UCX  ERROR   cuMemAlloc_v2((CUdeviceptr*)address_p, *length_p)() failed: out of memory
[1691128285.469632] [dgx13:74866:0]         uct_mem.c:155  UCX  ERROR   failed to allocate 536870912 bytes using md cuda_cpy for ucp_rndv_frags: Input/output error
[1691128285.469637] [dgx13:74866:0]           mpool.c:269  UCX  ERROR Failed to allocate memory pool (name=ucp_rndv_frags) chunk: Out of memory
[dgx13:74866:0:74866]        rndv.c:1369 Fatal: failed to allocate fragment memory buffer
==== backtrace (tid:  74866) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd3c1217f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0x51) [0x7fd3c1215ad1]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x26c6c) [0x7fd3c1215c6c]
 3  /opt/conda/envs/gdf/lib/libucp.so.0(+0x6f48a) [0x7fd3c12ba48a]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nbx+0xb68) [0x7fd3c12cd738]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nb+0x57) [0x7fd3c12cd917]
 6  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x4facb) [0x7fd3c135dacb]
 7  /opt/conda/envs/gdf/bin/python(+0x149dc7) [0x55ee7baa1dc7]
 8  /opt/conda/envs/gdf/bin/python(PyObject_Call+0x158) [0x55ee7baa01a8]
 9  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55ee7ba86d36]
10  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55ee7ba8027a]
11  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55ee7ba91c05]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55ee7ba823cb]
13  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55ee7ba8027a]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55ee7ba91c05]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55ee7ba823cb]
16  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55ee7baa670e]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55ee7ba87923]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55ee7baa670e]
19  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55ee7ba87923]
20  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55ee7baa670e]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55ee7ba87923]
22  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55ee7baa670e]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55ee7ba87923]
24  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55ee7baa670e]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55ee7ba87923]
26  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55ee7baa670e]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55ee7ba87923]
28  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55ee7baa670e]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x55ee7ba87923]
30  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x55ee7baa670e]
31  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7fd4580182fe]
32  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x8b4e) [0x7fd458018b4e]
33  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55ee7ba8a2bc]
34  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55ee7ba3d817]
35  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55ee7ba88f83]
36  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55ee7ba86d36]
37  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55ee7ba91ef3]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55ee7ba8181b]
39  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55ee7ba91ef3]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55ee7ba8181b]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55ee7ba91ef3]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55ee7ba8181b]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55ee7ba91ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55ee7ba8181b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55ee7ba8027a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55ee7ba91c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55ee7ba85fa7]
48  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55ee7ba8027a]
49  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55ee7ba9f935]
50  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55ee7baa0104]
51  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55ee7bb66fc8]
52  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55ee7ba8a2bc]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55ee7ba851bb]
54  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55ee7ba91ef3]
55  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55ee7ba9fc72]
56  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55ee7ba851bb]
57  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55ee7ba91ef3]
58  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55ee7ba8181b]
59  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55ee7ba8027a]
60  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55ee7ba91c05]
61  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55ee7ba8181b]
=================================
2023-08-04 05:51:25,725 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:25,774 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:27,342 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:27,342 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:27,357 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:27,357 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:74953:0:74953] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74953) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd9785bcf1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7fd9785bd114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7fd9785bd2da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fda09c93420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fd9786365d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fd97865b859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7fd97857842f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7fd97857b798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd9785c5989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd97857a62d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd978633c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7fd9786de17a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x56448c00db08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x56448bffe112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56448bff727a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56448c008c05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56448bff881b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56448c008ef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x56448c016a16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x56448c1269b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x56448bfb4817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x56448bffff83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x56448bffdd36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56448c008ef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56448bff881b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56448c008ef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56448bff881b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56448c008ef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56448bff881b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56448c008ef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56448bff881b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56448bff727a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56448c008c05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x56448bffcfa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56448bff727a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x56448c016935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x56448c017104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x56448c0ddfc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x56448c0012bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x56448bffc1bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56448c008ef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x56448c016c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x56448bffc1bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56448c008ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56448bff881b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56448bff727a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56448c008c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x56448bff881b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56448c008ef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x56448bff8568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56448bff727a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56448c008c05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x56448bff93cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x56448bff727a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x56448bff6f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56448bff6eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56448c0a78bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x56448c0d5adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x56448c0d1c24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x56448c0c97ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x56448c0c96bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x56448c0c88a2]
=================================
2023-08-04 05:51:28,731 - distributed.core - ERROR - std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 373, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
2023-08-04 05:51:28,732 - distributed.worker - ERROR - std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    frames = [
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 373, in <listcomp>
    device_array(each_size) if is_cuda else host_array(each_size)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 171, in device_array
    return rmm.DeviceBuffer(size=n)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/gdf/include/rmm/mr/device/cuda_memory_resource.hpp
[dgx13:74950:0:74950] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74950) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f4d25d02f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f4d25d03114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f4d25d032da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f4dcb3eb420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f4d25d7c5d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f4d25da1859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f4d25cbe42f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f4d25cc1798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f4d25d0b989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f4d25cc062d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f4d25d79c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7f4d25e2417a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55bb91dbcb08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55bb91dad112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55bb91da627a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55bb91db7c05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55bb91da781b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55bb91db7ef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x55bb91dc5a16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x55bb91ed59b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55bb91d63817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55bb91daef83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55bb91dacd36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55bb91db7ef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55bb91da781b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55bb91db7ef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55bb91da781b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55bb91db7ef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55bb91da781b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55bb91db7ef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55bb91da781b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55bb91da627a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55bb91db7c05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55bb91dabfa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55bb91da627a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55bb91dc5935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55bb91dc6104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55bb91e8cfc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55bb91db02bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55bb91dab1bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55bb91db7ef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55bb91dc5c72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55bb91dab1bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55bb91db7ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55bb91da781b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55bb91da627a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55bb91db7c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55bb91da781b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55bb91db7ef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55bb91da7568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55bb91da627a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55bb91db7c05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55bb91da83cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55bb91da627a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55bb91da5f07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55bb91da5eb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55bb91e568bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55bb91e84adc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55bb91e80c24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55bb91e787ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55bb91e786bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x55bb91e778a2]
=================================
2023-08-04 05:51:28,869 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:52781 -> ucx://127.0.0.1:51499
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fb6013a43c0, tag: 0x5224afa86ff74e93, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-04 05:51:28,919 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:28,968 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:39115 -> ucx://127.0.0.1:53175
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f097355c300, tag: 0x6f43ba7ee3585d23, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-04 05:51:29,008 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:30,482 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:30,482 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:30,592 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:30,592 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[1691128291.551553] [dgx13:74984:0]    cuda_copy_md.c:208  UCX  ERROR   cuMemAlloc_v2((CUdeviceptr*)address_p, *length_p)() failed: out of memory
[1691128291.551575] [dgx13:74984:0]         uct_mem.c:155  UCX  ERROR   failed to allocate 536870912 bytes using md cuda_cpy for ucp_rndv_frags: Input/output error
[1691128291.551581] [dgx13:74984:0]           mpool.c:269  UCX  ERROR Failed to allocate memory pool (name=ucp_rndv_frags) chunk: Out of memory
[dgx13:74984:0:74984]        rndv.c:1369 Fatal: failed to allocate fragment memory buffer
==== backtrace (tid:  74984) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f792da74f1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0x51) [0x7f792da72ad1]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x26c6c) [0x7f792da72c6c]
 3  /opt/conda/envs/gdf/lib/libucp.so.0(+0x6f48a) [0x7f792db1748a]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nbx+0xb68) [0x7f792db2a738]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nb+0x57) [0x7f792db2a917]
 6  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x4facb) [0x7f792dbbaacb]
 7  /opt/conda/envs/gdf/bin/python(+0x149dc7) [0x5566ea449dc7]
 8  /opt/conda/envs/gdf/bin/python(PyObject_Call+0x158) [0x5566ea4481a8]
 9  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5566ea42ed36]
10  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5566ea42827a]
11  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5566ea439c05]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5566ea42a3cb]
13  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5566ea42827a]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5566ea439c05]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5566ea42a3cb]
16  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5566ea44e70e]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5566ea42f923]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5566ea44e70e]
19  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5566ea42f923]
20  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5566ea44e70e]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5566ea42f923]
22  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5566ea44e70e]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5566ea42f923]
24  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5566ea44e70e]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5566ea42f923]
26  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5566ea44e70e]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5566ea42f923]
28  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5566ea44e70e]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x6793) [0x5566ea42f923]
30  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x5566ea44e70e]
31  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7f79c40762fe]
32  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x8b4e) [0x7f79c4076b4e]
33  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5566ea4322bc]
34  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5566ea3e5817]
35  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x5566ea430f83]
36  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x5566ea42ed36]
37  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5566ea439ef3]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5566ea42981b]
39  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5566ea439ef3]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5566ea42981b]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5566ea439ef3]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5566ea42981b]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5566ea439ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5566ea42981b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5566ea42827a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5566ea439c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x5566ea42dfa7]
48  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5566ea42827a]
49  /opt/conda/envs/gdf/bin/python(+0x147935) [0x5566ea447935]
50  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x5566ea448104]
51  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x5566ea50efc8]
52  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5566ea4322bc]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5566ea42d1bb]
54  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5566ea439ef3]
55  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x5566ea447c72]
56  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5566ea42d1bb]
57  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x5566ea439ef3]
58  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5566ea42981b]
59  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5566ea42827a]
60  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x5566ea439c05]
61  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5566ea42981b]
=================================
[dgx13:74987:0:74987] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  74987) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f664486bf1d]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x29114) [0x7f664486c114]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x292da) [0x7f664486c2da]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f66d5f31420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f66448e55d4]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f664490a859]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x2042f) [0x7f664482742f]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23798) [0x7f664482a798]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f6644874989]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f664482962d]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f66448e2c4a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x2b17a) [0x7f664498d17a]
12  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55c512196b08]
13  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55c512187112]
14  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55c51218027a]
15  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55c512191c05]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c51218181b]
17  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55c512191ef3]
18  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x55c51219fa16]
19  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x55c5122af9b1]
20  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55c51213d817]
21  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55c512188f83]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55c512186d36]
23  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55c512191ef3]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c51218181b]
25  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55c512191ef3]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c51218181b]
27  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55c512191ef3]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c51218181b]
29  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55c512191ef3]
30  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c51218181b]
31  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55c51218027a]
32  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55c512191c05]
33  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55c512185fa7]
34  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55c51218027a]
35  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55c51219f935]
36  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55c5121a0104]
37  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55c512266fc8]
38  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55c51218a2bc]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55c5121851bb]
40  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55c512191ef3]
41  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55c51219fc72]
42  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55c5121851bb]
43  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55c512191ef3]
44  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c51218181b]
45  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55c51218027a]
46  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55c512191c05]
47  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55c51218181b]
48  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55c512191ef3]
49  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55c512181568]
50  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55c51218027a]
51  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55c512191c05]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55c5121823cb]
53  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55c51218027a]
54  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55c51217ff07]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55c51217feb9]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55c5122308bb]
57  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55c51225eadc]
58  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55c51225ac24]
59  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55c5122527ed]
60  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55c5122526bd]
61  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x262) [0x55c5122518a2]
=================================
2023-08-04 05:51:31,843 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:31,986 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:52781 -> ucx://127.0.0.1:38979
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fb6013a41c0, tag: 0x9669f2eb4efaeabf, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-04 05:51:32,037 - distributed.nanny - WARNING - Restarting worker
2023-08-04 05:51:33,473 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:33,473 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:33,704 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-08-04 05:51:33,705 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-08-04 05:51:48,505 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:38665
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 490, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 492, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 318, in connect
    raise OSError(
OSError: Timed out trying to connect to ucx://127.0.0.1:38665 after 30 s
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 18 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
