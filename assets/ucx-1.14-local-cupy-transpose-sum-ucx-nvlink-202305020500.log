/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/node.py:182: UserWarning: Port 8787 is already in use.
Perhaps you already have a cluster running?
Hosting the HTTP server on port 36069 instead
  warnings.warn(
2023-05-02 05:55:03,243 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:03,243 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-02 05:55:03,245 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:03,245 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-02 05:55:03,314 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:03,314 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-02 05:55:03,315 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:03,315 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-02 05:55:03,316 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:03,316 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-02 05:55:03,321 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:03,321 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-02 05:55:03,351 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:03,352 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-02 05:55:03,358 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:03,358 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:805  :0:805] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:    805) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7fb4703c3c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7fb4703c3dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7fb4703c4134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fb501692420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7fb47044daa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fb47047eb48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7fb470374427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7fb470374a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7fb470376f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7fb4703ce539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fb470376fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fb47044a28a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7fb4705086e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x563801a25b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x563801a16112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x563801a0f27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x563801a20c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563801a1081b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x563801a3570e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7fb480f2d2fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x563801a192bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5638019cc817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x563801a17f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x563801a15d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x563801a20ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563801a1081b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x563801a20ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563801a1081b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x563801a20ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563801a1081b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x563801a20ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563801a1081b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x563801a0f27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x563801a20c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x563801a14fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x563801a0f27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x563801a2e935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x563801a2f104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x563801af5fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x563801a192bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x563801a141bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x563801a20ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x563801a2ec72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x563801a141bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x563801a20ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563801a1081b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x563801a0f27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x563801a20c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x563801a1081b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x563801a20ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x563801a10568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x563801a0f27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x563801a20c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x563801a113cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x563801a0f27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x563801a0ef07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x563801a0eeb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x563801abf8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x563801aedadc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x563801ae9c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x563801ae17ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x563801ae16bd]
=================================
[dgx13:812  :0:812] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:    812) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f3801b96c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f3801b96dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f3801b97134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f38a7015420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f3801c20aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f3801c51b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f3801b47427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f3801b47a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f3801b49f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f3801ba1539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f3801b49fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f3801c1d28a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f3801cdb6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55de6c87cb08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55de6c86d112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55de6c86627a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55de6c877c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55de6c86781b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55de6c877ef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x55de6c885a16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x55de6c9959b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55de6c823817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55de6c86ef83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55de6c86cd36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55de6c877ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55de6c86781b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55de6c877ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55de6c86781b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55de6c877ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55de6c86781b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55de6c877ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55de6c86781b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55de6c86627a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55de6c877c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55de6c86bfa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55de6c86627a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55de6c885935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55de6c886104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55de6c94cfc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55de6c8702bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55de6c86b1bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55de6c877ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55de6c885c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55de6c86b1bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55de6c877ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55de6c86781b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55de6c86627a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55de6c877c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55de6c86781b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55de6c877ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55de6c867568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55de6c86627a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55de6c877c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55de6c8683cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55de6c86627a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55de6c865f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55de6c865eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55de6c9168bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55de6c944adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55de6c940c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55de6c9387ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55de6c9386bd]
=================================
2023-05-02 05:55:06,526 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59989
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f3c78243140, tag: 0xecf0bf1ad3512641, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f3c78243140, tag: 0xecf0bf1ad3512641, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-02 05:55:06,527 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44411 -> ucx://127.0.0.1:59989
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f8b251fe280, tag: 0xc2f54baf081e6726, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-02 05:55:06,528 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:52667 -> ucx://127.0.0.1:59989
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f3c78243240, tag: 0xf95d7be8ca25eac9, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-02 05:55:06,529 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44411 -> ucx://127.0.0.1:43465
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f8b251fe380, tag: 0xba6fc9c99e2c203f, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-02 05:55:06,529 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43465
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #008] ep: 0x7f3c78243100, tag: 0xad4b4ceb50c3d03e, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #008] ep: 0x7f3c78243100, tag: 0xad4b4ceb50c3d03e, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-02 05:55:06,529 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43465
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f8b251fe1c0, tag: 0x1082017554351acf, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f8b251fe1c0, tag: 0x1082017554351acf, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-02 05:55:06,530 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59989
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f8b251fe140, tag: 0x4a3e60387a39e842, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f8b251fe140, tag: 0x4a3e60387a39e842, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-02 05:55:06,530 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43465
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2907, in get_data_from_worker
    await comm.write("OK")
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 289, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message
Task exception was never retrieved
future: <Task finished name='Task-332' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-05-02 05:55:06,532 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59989
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1022, in send_recv
    await comm.write(msg, serializers=serializers, on_error="raise")
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 289, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message
2023-05-02 05:55:06,550 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59989
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fd9300b6180, tag: 0x725787730f8ce6f5, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fd9300b6180, tag: 0x725787730f8ce6f5, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-02 05:55:06,600 - distributed.nanny - WARNING - Restarting worker
2023-05-02 05:55:06,623 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59989
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7efe4c359180, tag: 0x2b6ea6fd83ca9784, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7efe4c359180, tag: 0x2b6ea6fd83ca9784, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-02 05:55:06,624 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:43465
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7efe4c359100, tag: 0x97c2ae5beacfc825, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7efe4c359100, tag: 0x97c2ae5beacfc825, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-02 05:55:06,636 - distributed.nanny - WARNING - Restarting worker
2023-05-02 05:55:06,699 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:59989
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 330, in connect
    await wait_for(comm.write(local_info), time_left())
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 289, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 334, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:59989 after 30 s
[dgx13:790  :0:790] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:    790) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7fd9303fbc1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7fd9303fbdff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7fd9303fc134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd9cf847420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7fd930485aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7fd9304b6b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7fd9303ac427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7fd9303aca08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7fd9303aef2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7fd930406539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7fd9303aefdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7fd93048228a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7fd9305406e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x564e77967b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x564e77958112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x564e7795127a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x564e77962c05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7795281b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564e77962ef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x564e77970a16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x564e77a809b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x564e7790e817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x564e77959f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x564e77957d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564e77962ef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7795281b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564e77962ef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7795281b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564e77962ef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7795281b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564e77962ef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7795281b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x564e7795127a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x564e77962c05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x564e77956fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x564e7795127a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x564e77970935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x564e77971104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x564e77a37fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x564e7795b2bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x564e779561bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564e77962ef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x564e77970c72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x564e779561bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564e77962ef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7795281b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x564e7795127a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x564e77962c05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x564e7795281b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x564e77962ef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x564e77952568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x564e7795127a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x564e77962c05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x564e779533cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x564e7795127a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x564e77950f07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x564e77950eb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x564e77a018bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x564e77a2fadc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x564e77a2bc24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x564e77a237ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x564e77a236bd]
=================================
2023-05-02 05:55:07,143 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:38055 -> ucx://127.0.0.1:46283
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f2a712c3340, tag: 0xff1a6d5ad049720f, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-02 05:55:07,143 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46283
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f2690e71100, tag: 0x202e1c8ae659d9a3, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f2690e71100, tag: 0x202e1c8ae659d9a3, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-02 05:55:07,144 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46283
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f2a712c3180, tag: 0xd22b93a7f59d0b0f, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f2a712c3180, tag: 0xd22b93a7f59d0b0f, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-02 05:55:07,145 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:50821 -> ucx://127.0.0.1:46283
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7f2690e71240, tag: 0x46500fc99f003e4e, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1793, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7f2690e71240, tag: 0x46500fc99f003e4e, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-02 05:55:07,185 - distributed.nanny - WARNING - Restarting worker
2023-05-02 05:55:08,106 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:08,106 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-02 05:55:08,113 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:08,113 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-02 05:55:08,646 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:08,646 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:943  :0:943] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:    943) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7ff074e72c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7ff074e72dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7ff074e73134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7ff114159420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7ff074efcaa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7ff074f2db48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7ff074e23427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7ff074e23a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7ff074e25f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7ff074e7d539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7ff074e25fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7ff074ef928a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7ff074fb76e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x557caac22b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x557caac13112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x557caac0c27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x557caac1dc05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557caac0d81b]
18  /opt/conda/envs/gdf/bin/python(+0x14e70e) [0x557caac3270e]
19  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x82fe) [0x7ff0939f02fe]
20  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x557caac162bc]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x557caabc9817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x557caac14f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x557caac12d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x557caac1def3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557caac0d81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x557caac1def3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557caac0d81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x557caac1def3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557caac0d81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x557caac1def3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557caac0d81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x557caac0c27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x557caac1dc05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x557caac11fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x557caac0c27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x557caac2b935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x557caac2c104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x557caacf2fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x557caac162bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x557caac111bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x557caac1def3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x557caac2bc72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x557caac111bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x557caac1def3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557caac0d81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x557caac0c27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x557caac1dc05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x557caac0d81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x557caac1def3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x557caac0d568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x557caac0c27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x557caac1dc05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x557caac0e3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x557caac0c27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x557caac0bf07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x557caac0beb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x557caacbc8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x557caaceaadc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x557caace6c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x557caacde7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x557caacde6bd]
=================================
[dgx13:946  :0:946] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:    946) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7ff830cc6c1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7ff830cc6dff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7ff830cc7134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7ff8c1f95420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7ff830d50aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7ff830d81b48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7ff830c77427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7ff830c77a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7ff830c79f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7ff830cd1539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7ff830c79fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7ff830d4d28a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7ff830e0b6e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x560811613b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x560811604112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5608115fd27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56081160ec05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5608115fe81b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56081160eef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x56081161ca16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x56081172c9b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x5608115ba817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x560811605f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x560811603d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56081160eef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5608115fe81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56081160eef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5608115fe81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56081160eef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5608115fe81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56081160eef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5608115fe81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5608115fd27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56081160ec05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x560811602fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5608115fd27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x56081161c935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x56081161d104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x5608116e3fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x5608116072bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5608116021bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56081160eef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x56081161cc72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x5608116021bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56081160eef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5608115fe81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5608115fd27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56081160ec05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x5608115fe81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x56081160eef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x5608115fe568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5608115fd27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x56081160ec05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x5608115ff3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x5608115fd27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x5608115fcf07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5608115fceb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5608116ad8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x5608116dbadc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x5608116d7c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x5608116cf7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x5608116cf6bd]
=================================
2023-05-02 05:55:09,182 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:44411 -> ucx://127.0.0.1:55921
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f8b251fe380, tag: 0x800e067cc1784491, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-02 05:55:09,183 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55921
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f8b251fe200, tag: 0xc3f20cfe00abe44f, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f8b251fe200, tag: 0xc3f20cfe00abe44f, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
Task exception was never retrieved
future: <Task finished name='Task-2576' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Endpoint timeout')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Endpoint timeout
2023-05-02 05:55:09,185 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:55921
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7f3c78243100, tag: 0x6cb4f61ac638d255, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 329, in connect
    handshake = await wait_for(comm.read(), time_left())
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7f3c78243100, tag: 0x6cb4f61ac638d255, nbytes: 16, type: <class 'numpy.ndarray'>>: ")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 334, in connect
    raise OSError(
OSError: Timed out during handshake while connecting to ucx://127.0.0.1:55921 after 30 s
2023-05-02 05:55:09,223 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:54023 -> ucx://127.0.0.1:55321
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7efe4c359100, tag: 0x94ad10e71ffc9b96, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-02 05:55:09,236 - distributed.nanny - WARNING - Restarting worker
2023-05-02 05:55:09,284 - distributed.nanny - WARNING - Restarting worker
2023-05-02 05:55:10,662 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:10,663 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-05-02 05:55:10,668 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:10,669 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
[dgx13:814  :0:814] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:    814) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2dc) [0x7f2a71dffc1c]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x30dff) [0x7f2a71dffdff]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x31134) [0x7f2a71e00134]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f2b19237420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x18) [0x7f2a71e89aa8]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x508) [0x7f2a71ebab48]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23427) [0x7f2a71db0427]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23a08) [0x7f2a71db0a08]
 8  /opt/conda/envs/gdf/lib/libuct.so.0(+0x25f2c) [0x7f2a71db2f2c]
 9  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xf9) [0x7f2a71e0a539]
10  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7b) [0x7f2a71db2fdb]
11  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x6a) [0x7f2a71e8628a]
12  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x286e1) [0x7f2a71f446e1]
13  /opt/conda/envs/gdf/bin/python(+0x13eb08) [0x55b802cb1b08]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5f82) [0x55b802ca2112]
15  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55b802c9b27a]
16  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55b802cacc05]
17  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b802c9c81b]
18  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b802cacef3]
19  /opt/conda/envs/gdf/bin/python(+0x147a16) [0x55b802cbaa16]
20  /opt/conda/envs/gdf/bin/python(+0x2579b1) [0x55b802dca9b1]
21  /opt/conda/envs/gdf/bin/python(+0xe5817) [0x55b802c58817]
22  /opt/conda/envs/gdf/bin/python(+0x130f83) [0x55b802ca3f83]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x5ba6) [0x55b802ca1d36]
24  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b802cacef3]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b802c9c81b]
26  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b802cacef3]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b802c9c81b]
28  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b802cacef3]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b802c9c81b]
30  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b802cacef3]
31  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b802c9c81b]
32  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55b802c9b27a]
33  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55b802cacc05]
34  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x4e17) [0x55b802ca0fa7]
35  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55b802c9b27a]
36  /opt/conda/envs/gdf/bin/python(+0x147935) [0x55b802cba935]
37  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xb4) [0x55b802cbb104]
38  /opt/conda/envs/gdf/bin/python(+0x20efc8) [0x55b802d81fc8]
39  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2fc) [0x55b802ca52bc]
40  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55b802ca01bb]
41  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b802cacef3]
42  /opt/conda/envs/gdf/bin/python(+0x147c72) [0x55b802cbac72]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x402b) [0x55b802ca01bb]
44  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b802cacef3]
45  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b802c9c81b]
46  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55b802c9b27a]
47  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55b802cacc05]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x68b) [0x55b802c9c81b]
49  /opt/conda/envs/gdf/bin/python(+0x139ef3) [0x55b802cacef3]
50  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3d8) [0x55b802c9c568]
51  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55b802c9b27a]
52  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd5) [0x55b802cacc05]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x123b) [0x55b802c9d3cb]
54  /opt/conda/envs/gdf/bin/python(+0x12827a) [0x55b802c9b27a]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x47) [0x55b802c9af07]
56  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55b802c9aeb9]
57  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55b802d4b8bb]
58  /opt/conda/envs/gdf/bin/python(+0x206adc) [0x55b802d79adc]
59  /opt/conda/envs/gdf/bin/python(+0x202c24) [0x55b802d75c24]
60  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9d) [0x55b802d6d7ed]
61  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3d) [0x55b802d6d6bd]
=================================
2023-05-02 05:55:10,886 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:38055
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 391, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7efe4c359140, tag: 0x7184af963dfc22ce, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2892, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1024, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 397, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7efe4c359140, tag: 0x7184af963dfc22ce, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-05-02 05:55:10,887 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:54023 -> ucx://127.0.0.1:38055
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 349, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #006] ep: 0x7efe4c359280, tag: 0xb205f1aa4dfc849c, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1793, in get_data
    response = await comm.read(deserializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 367, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #006] ep: 0x7efe4c359280, tag: 0xb205f1aa4dfc849c, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-05-02 05:55:10,887 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:35425 -> ucx://127.0.0.1:38055
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 333, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #012] ep: 0x7fe980814240, tag: 0x9ec4016157539473, nbytes: 50000000, type: <class 'cupy.ndarray'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1792, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 337, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-05-02 05:55:10,893 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:38055
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 466, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1849, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 468, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1427, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 316, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2066, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2889, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1506, in connect
    return await connect_attempt
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1450, in _connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-05-02 05:55:11,014 - distributed.nanny - WARNING - Restarting worker
2023-05-02 05:55:12,416 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-05-02 05:55:12,416 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
