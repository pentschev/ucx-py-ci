[dgx13:70492:0:70492] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  70492) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f42236b00cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f42236b02c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f42236b048a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f42c7d8a420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f422372f674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f42237587f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f422366a3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f422366d838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f42236b94f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f422366c5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f422372c89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x37aaa) [0x7f42237eaaaa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x559f345b13d6]
13  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x559f345abf94]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559f345bd3f9]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f345ad4c6]
16  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x559f345bd6a2]
17  /opt/conda/envs/gdf/bin/python(+0x14ca43) [0x559f345caa43]
18  /opt/conda/envs/gdf/bin/python(+0x2580fc) [0x559f346d60fc]
19  /opt/conda/envs/gdf/bin/python(+0xf248b) [0x559f3457048b]
20  /opt/conda/envs/gdf/bin/python(+0x1366f3) [0x559f345b46f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x559f345b26e4]
22  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x559f345bd6a2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f345ad4c6]
24  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x559f345bd6a2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f345ad4c6]
26  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x559f345bd6a2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f345ad4c6]
28  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x559f345bd6a2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f345ad4c6]
30  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x559f345abf94]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559f345bd3f9]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x559f345ae022]
33  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x559f345abf94]
34  /opt/conda/envs/gdf/bin/python(+0x14c88b) [0x559f345ca88b]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x559f345cb00c]
36  /opt/conda/envs/gdf/bin/python(+0x21073e) [0x559f3468e73e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x559f345b567c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x559f345b13d6]
39  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x559f345bd6a2]
40  /opt/conda/envs/gdf/bin/python(+0x14c96c) [0x559f345ca96c]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x559f345b13d6]
42  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x559f345bd6a2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f345ad4c6]
44  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x559f345abf94]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559f345bd3f9]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x559f345ad4c6]
47  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x559f345bd6a2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x559f345ad212]
49  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x559f345abf94]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x559f345bd3f9]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x559f345ae022]
52  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x559f345abf94]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x559f345abc68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x559f345abc19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x559f3465920b]
56  /opt/conda/envs/gdf/bin/python(+0x2085fa) [0x559f346865fa]
57  /opt/conda/envs/gdf/bin/python(+0x204983) [0x559f34682983]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x559f3467a79a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x559f3467a68c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x559f346798c7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x559f3464d047]
=================================
2023-08-24 06:23:07,310 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34075 -> ucx://127.0.0.1:45721
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fdd757db100, tag: 0x66ddb22286fa2ac, nbytes: 800000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1799, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-24 06:23:07,378 - distributed.nanny - WARNING - Restarting worker
[dgx13:70486:0:70486] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  70486) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f60b8a880cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f60b8a882c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f60b8a8848a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f614b159420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f60b8b07674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f60b8b307f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f60b8a423df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f60b8a45838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f60b8a914f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f60b8a445dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f60b8b0489a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x37aaa) [0x7f60b8bc2aaa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55a87f72c3d6]
13  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55a87f726f94]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a87f7383f9]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87f7284c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x55a87f7db612]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f60cbc921e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55a87f73067c]
19  /opt/conda/envs/gdf/bin/python(+0xf248b) [0x55a87f6eb48b]
20  /opt/conda/envs/gdf/bin/python(+0x1366f3) [0x55a87f72f6f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x55a87f72d6e4]
22  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55a87f7386a2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87f7284c6]
24  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55a87f7386a2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87f7284c6]
26  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55a87f7386a2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87f7284c6]
28  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55a87f7386a2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87f7284c6]
30  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55a87f726f94]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a87f7383f9]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55a87f729022]
33  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55a87f726f94]
34  /opt/conda/envs/gdf/bin/python(+0x14c88b) [0x55a87f74588b]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55a87f74600c]
36  /opt/conda/envs/gdf/bin/python(+0x21073e) [0x55a87f80973e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55a87f73067c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55a87f72c3d6]
39  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55a87f7386a2]
40  /opt/conda/envs/gdf/bin/python(+0x14c96c) [0x55a87f74596c]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55a87f72c3d6]
42  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55a87f7386a2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87f7284c6]
44  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55a87f726f94]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a87f7383f9]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55a87f7284c6]
47  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55a87f7386a2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55a87f728212]
49  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55a87f726f94]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55a87f7383f9]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55a87f729022]
52  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55a87f726f94]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55a87f726c68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55a87f726c19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55a87f7d420b]
56  /opt/conda/envs/gdf/bin/python(+0x2085fa) [0x55a87f8015fa]
57  /opt/conda/envs/gdf/bin/python(+0x204983) [0x55a87f7fd983]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55a87f7f579a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55a87f7f568c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55a87f7f48c7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55a87f7c8047]
=================================
[dgx13:70483:0:70483] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  70483) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f8b84c260cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f8b84c262c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f8b84c2648a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f8c172e8420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f8b84ca5674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f8b84cce7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f8b84be03df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f8b84be3838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f8b84c2f4f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f8b84be25dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f8b84ca289a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x37aaa) [0x7f8b84d60aaa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5583b693a3d6]
13  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5583b6934f94]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5583b69463f9]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5583b69364c6]
16  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5583b69466a2]
17  /opt/conda/envs/gdf/bin/python(+0x14ca43) [0x5583b6953a43]
18  /opt/conda/envs/gdf/bin/python(+0x2580fc) [0x5583b6a5f0fc]
19  /opt/conda/envs/gdf/bin/python(+0xf248b) [0x5583b68f948b]
20  /opt/conda/envs/gdf/bin/python(+0x1366f3) [0x5583b693d6f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x5583b693b6e4]
22  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5583b69466a2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5583b69364c6]
24  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5583b69466a2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5583b69364c6]
26  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5583b69466a2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5583b69364c6]
28  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5583b69466a2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5583b69364c6]
30  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5583b6934f94]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5583b69463f9]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5583b6937022]
33  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5583b6934f94]
34  /opt/conda/envs/gdf/bin/python(+0x14c88b) [0x5583b695388b]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5583b695400c]
36  /opt/conda/envs/gdf/bin/python(+0x21073e) [0x5583b6a1773e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5583b693e67c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5583b693a3d6]
39  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5583b69466a2]
40  /opt/conda/envs/gdf/bin/python(+0x14c96c) [0x5583b695396c]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5583b693a3d6]
42  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5583b69466a2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5583b69364c6]
44  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5583b6934f94]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5583b69463f9]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5583b69364c6]
47  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5583b69466a2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5583b6936212]
49  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5583b6934f94]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5583b69463f9]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5583b6937022]
52  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5583b6934f94]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5583b6934c68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5583b6934c19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5583b69e220b]
56  /opt/conda/envs/gdf/bin/python(+0x2085fa) [0x5583b6a0f5fa]
57  /opt/conda/envs/gdf/bin/python(+0x204983) [0x5583b6a0b983]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5583b6a0379a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5583b6a0368c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5583b6a028c7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5583b69d6047]
=================================
2023-08-24 06:23:07,897 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53857
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #000] ep: 0x7fdd757db180, tag: 0x6a64c56ca6df13b8, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1600, in connect
    return connect_attempt.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1526, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 377, in connect
    handshake = await comm.read()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #000] ep: 0x7fdd757db180, tag: 0x6a64c56ca6df13b8, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
Task exception was never retrieved
future: <Task finished name='Task-878' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-08-24 06:23:07,898 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34659 -> ucx://127.0.0.1:53857
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0bf46c7280, tag: 0x8291a75b6f1872ca, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1799, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
[1692858187.901101] [dgx13:70489:0]            sock.c:323  UCX  ERROR   connect(fd=140, dest_addr=10.33.225.183:45887) failed: Connection refused
2023-08-24 06:23:07,902 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f0bf46c7180, tag: 0xa732fb66295c6d2e, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f0bf46c7180, tag: 0xa732fb66295c6d2e, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-24 06:23:07,903 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53857
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f0bf46c7200, tag: 0x976a068e26f66621, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f0bf46c7200, tag: 0x976a068e26f66621, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-24 06:23:07,903 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7fdd757db240, tag: 0x6fce8b919800e07d, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7fdd757db240, tag: 0x6fce8b919800e07d, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-24 06:23:07,905 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:41849 -> ucx://127.0.0.1:53923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f7168221300, tag: 0xdccfebad9bd7d024, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1799, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-24 06:23:07,903 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53857
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1927, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1526, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1600, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1603, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-08-24 06:23:07,906 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f7168221180, tag: 0xd810da8ad194f1e, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f7168221180, tag: 0xd810da8ad194f1e, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-08-24 06:23:07,909 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:53923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 471, in connect
    ep = await ucp.create_endpoint(ip, port)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 1004, in create_endpoint
    return await _get_ctx().create_endpoint(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 316, in create_endpoint
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 54, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 342, in connect
    comm = await wait_for(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 1927, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 479, in wait_for
    return fut.result()
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 473, in connect
    raise CommClosedError("Connection closed before handshake completed")
distributed.comm.core.CommClosedError: Connection closed before handshake completed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1526, in _connect
    comm = await connect(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/core.py", line 366, in connect
    await asyncio.sleep(backoff)
  File "/opt/conda/envs/gdf/lib/python3.9/asyncio/tasks.py", line 652, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1600, in connect
    return connect_attempt.result()
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2863, in get_data_from_worker
    comm = await rpc.connect(worker)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1603, in connect
    raise CommClosedError(reason)
distributed.comm.core.CommClosedError: Address removed.
2023-08-24 06:23:07,909 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:46117 -> ucx://127.0.0.1:53923
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1799, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 294, in write
    raise CommClosedError("Endpoint is closed -- unable to send message")
distributed.comm.core.CommClosedError: Endpoint is closed -- unable to send message
[dgx13:70480:0:70480] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  70480) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f71684a80cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f71684a82c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f71684a848a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f71fab78420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f7168527674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f71685507f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f71684623df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f7168465838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f71684b14f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f71684645dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f716852489a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x37aaa) [0x7f71685e2aaa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x56064c8f53d6]
13  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x56064c8eff94]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56064c9013f9]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56064c8f14c6]
16  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x56064c9016a2]
17  /opt/conda/envs/gdf/bin/python(+0x14ca43) [0x56064c90ea43]
18  /opt/conda/envs/gdf/bin/python(+0x2580fc) [0x56064ca1a0fc]
19  /opt/conda/envs/gdf/bin/python(+0xf248b) [0x56064c8b448b]
20  /opt/conda/envs/gdf/bin/python(+0x1366f3) [0x56064c8f86f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x56064c8f66e4]
22  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x56064c9016a2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56064c8f14c6]
24  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x56064c9016a2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56064c8f14c6]
26  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x56064c9016a2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56064c8f14c6]
28  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x56064c9016a2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56064c8f14c6]
30  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x56064c8eff94]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56064c9013f9]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x56064c8f2022]
33  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x56064c8eff94]
34  /opt/conda/envs/gdf/bin/python(+0x14c88b) [0x56064c90e88b]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x56064c90f00c]
36  /opt/conda/envs/gdf/bin/python(+0x21073e) [0x56064c9d273e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x56064c8f967c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x56064c8f53d6]
39  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x56064c9016a2]
40  /opt/conda/envs/gdf/bin/python(+0x14c96c) [0x56064c90e96c]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x56064c8f53d6]
42  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x56064c9016a2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56064c8f14c6]
44  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x56064c8eff94]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56064c9013f9]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x56064c8f14c6]
47  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x56064c9016a2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x56064c8f1212]
49  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x56064c8eff94]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x56064c9013f9]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x56064c8f2022]
52  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x56064c8eff94]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x56064c8efc68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x56064c8efc19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x56064c99d20b]
56  /opt/conda/envs/gdf/bin/python(+0x2085fa) [0x56064c9ca5fa]
57  /opt/conda/envs/gdf/bin/python(+0x204983) [0x56064c9c6983]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x56064c9be79a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x56064c9be68c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x56064c9bd8c7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x56064c991047]
=================================
2023-08-24 06:23:07,994 - distributed.nanny - WARNING - Restarting worker
2023-08-24 06:23:08,070 - distributed.nanny - WARNING - Restarting worker
2023-08-24 06:23:08,276 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41849
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #019] ep: 0x7fdd757db100, tag: 0x18362a99376c0409, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #019] ep: 0x7fdd757db100, tag: 0x18362a99376c0409, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-24 06:23:08,276 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41849
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #019] ep: 0x7f0bf46c7140, tag: 0xc999c950a7953f20, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #019] ep: 0x7f0bf46c7140, tag: 0xc999c950a7953f20, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-24 06:23:08,293 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:46117 -> ucx://127.0.0.1:41849
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f85153071c0, tag: 0xf159d6b7cc7e4f9c, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1799, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-24 06:23:08,294 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:41849
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f8515307240, tag: 0xaba29d64bb2b4a91, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f8515307240, tag: 0xaba29d64bb2b4a91, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
[dgx13:70489:0:70489] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  70489) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f851557d0cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f851557d2c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f851557d48a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f85b9c57420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f85155fc674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f85156257f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f85155373df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f851553a838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f85155864f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f85155395dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f85155f989a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x37aaa) [0x7f85156b7aaa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c1a98363d6]
13  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55c1a9830f94]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c1a98423f9]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c1a98324c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x55c1a98e5612]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f853a7961e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55c1a983a67c]
19  /opt/conda/envs/gdf/bin/python(+0xf248b) [0x55c1a97f548b]
20  /opt/conda/envs/gdf/bin/python(+0x1366f3) [0x55c1a98396f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x55c1a98376e4]
22  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55c1a98426a2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c1a98324c6]
24  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55c1a98426a2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c1a98324c6]
26  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55c1a98426a2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c1a98324c6]
28  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55c1a98426a2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c1a98324c6]
30  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55c1a9830f94]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c1a98423f9]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55c1a9833022]
33  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55c1a9830f94]
34  /opt/conda/envs/gdf/bin/python(+0x14c88b) [0x55c1a984f88b]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55c1a985000c]
36  /opt/conda/envs/gdf/bin/python(+0x21073e) [0x55c1a991373e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55c1a983a67c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c1a98363d6]
39  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55c1a98426a2]
40  /opt/conda/envs/gdf/bin/python(+0x14c96c) [0x55c1a984f96c]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55c1a98363d6]
42  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55c1a98426a2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c1a98324c6]
44  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55c1a9830f94]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c1a98423f9]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55c1a98324c6]
47  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55c1a98426a2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55c1a9832212]
49  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55c1a9830f94]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55c1a98423f9]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55c1a9833022]
52  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55c1a9830f94]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55c1a9830c68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55c1a9830c19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55c1a98de20b]
56  /opt/conda/envs/gdf/bin/python(+0x2085fa) [0x55c1a990b5fa]
57  /opt/conda/envs/gdf/bin/python(+0x204983) [0x55c1a9907983]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55c1a98ff79a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55c1a98ff68c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55c1a98fe8c7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55c1a98d2047]
=================================
2023-08-24 06:23:08,337 - distributed.nanny - WARNING - Restarting worker
2023-08-24 06:23:08,560 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46117
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f0a33436200, tag: 0xa669ed40672ac145, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f0a33436200, tag: 0xa669ed40672ac145, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-08-24 06:23:08,560 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46117
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #010] ep: 0x7f0bf46c71c0, tag: 0x1b144a83fd9dd747, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #010] ep: 0x7f0bf46c71c0, tag: 0x1b144a83fd9dd747, nbytes: 50000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-08-24 06:23:08,561 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34075 -> ucx://127.0.0.1:46117
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fdd757db380, tag: 0x8cc3459b44d30a16, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1799, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-24 06:23:08,561 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:46117
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fdd757db1c0, tag: 0xa2a2e92fedbf3291, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fdd757db1c0, tag: 0xa2a2e92fedbf3291, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-08-24 06:23:08,615 - distributed.nanny - WARNING - Restarting worker
2023-08-24 06:23:10,344 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-054f65580a5efedc40c26858beb83d02', 0)
Function:  shuffle_group
args:      (               key   payload
shuffle                     
0              595  25968053
0              597  72622027
0              607  12667082
0            21185  17089140
0            21192  34613125
...            ...       ...
0        799995969  61903163
0        799995975  92084212
0        799995981  17487385
0        799995996   5134215
0        799995998  61775385

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

2023-08-24 06:23:10,593 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-054f65580a5efedc40c26858beb83d02', 7)
Function:  shuffle_group
args:      (               key   payload
shuffle                     
7              592  64008795
7              599  31176652
7              604  90224378
7              605  10642642
7            21193  66588552
...            ...       ...
7        799996027  41385000
7        799996031  57716436
7        799995976  23361327
7        799995977  48575490
7        799995983  52510254

[100000000 rows x 2 columns], ['key'], 0, 8, 8, False, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

[dgx13:70652:0:70652] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  70652) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f28e10e60cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f28e10e62c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f28e10e648a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f297363c420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f28e1165674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f28e118e7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f28e10a03df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f28e10a3838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f28e10ef4f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f28e10a25dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f28e116289a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x37aaa) [0x7f28e1220aaa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5576b239b3d6]
13  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5576b2395f94]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5576b23a73f9]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576b23974c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x5576b244a612]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f28f41771e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5576b239f67c]
19  /opt/conda/envs/gdf/bin/python(+0xf248b) [0x5576b235a48b]
20  /opt/conda/envs/gdf/bin/python(+0x1366f3) [0x5576b239e6f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x5576b239c6e4]
22  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5576b23a76a2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576b23974c6]
24  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5576b23a76a2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576b23974c6]
26  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5576b23a76a2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576b23974c6]
28  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5576b23a76a2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576b23974c6]
30  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5576b2395f94]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5576b23a73f9]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5576b2398022]
33  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5576b2395f94]
34  /opt/conda/envs/gdf/bin/python(+0x14c88b) [0x5576b23b488b]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5576b23b500c]
36  /opt/conda/envs/gdf/bin/python(+0x21073e) [0x5576b247873e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5576b239f67c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5576b239b3d6]
39  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5576b23a76a2]
40  /opt/conda/envs/gdf/bin/python(+0x14c96c) [0x5576b23b496c]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5576b239b3d6]
42  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5576b23a76a2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576b23974c6]
44  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5576b2395f94]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5576b23a73f9]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5576b23974c6]
47  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5576b23a76a2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x5576b2397212]
49  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5576b2395f94]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5576b23a73f9]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5576b2398022]
52  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5576b2395f94]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x5576b2395c68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x5576b2395c19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x5576b244320b]
56  /opt/conda/envs/gdf/bin/python(+0x2085fa) [0x5576b24705fa]
57  /opt/conda/envs/gdf/bin/python(+0x204983) [0x5576b246c983]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x5576b246479a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x5576b246468c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x5576b24638c7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x5576b2437047]
=================================
[dgx13:70645:0:70645] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  70645) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f42ac20f0cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f42ac20f2c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f42ac20f48a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f434c772420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f42ac28e674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f42ac2b77f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f42ac1c93df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f42ac1cc838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f42ac2184f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f42ac1cb5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f42ac28b89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x37aaa) [0x7f42ac349aaa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55dd658f23d6]
13  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55dd658ecf94]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55dd658fe3f9]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dd658ee4c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x55dd659a1612]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f42cd2af1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55dd658f667c]
19  /opt/conda/envs/gdf/bin/python(+0xf248b) [0x55dd658b148b]
20  /opt/conda/envs/gdf/bin/python(+0x1366f3) [0x55dd658f56f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x55dd658f36e4]
22  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55dd658fe6a2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dd658ee4c6]
24  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55dd658fe6a2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dd658ee4c6]
26  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55dd658fe6a2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dd658ee4c6]
28  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55dd658fe6a2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dd658ee4c6]
30  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55dd658ecf94]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55dd658fe3f9]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55dd658ef022]
33  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55dd658ecf94]
34  /opt/conda/envs/gdf/bin/python(+0x14c88b) [0x55dd6590b88b]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x55dd6590c00c]
36  /opt/conda/envs/gdf/bin/python(+0x21073e) [0x55dd659cf73e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x55dd658f667c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55dd658f23d6]
39  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55dd658fe6a2]
40  /opt/conda/envs/gdf/bin/python(+0x14c96c) [0x55dd6590b96c]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x55dd658f23d6]
42  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55dd658fe6a2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dd658ee4c6]
44  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55dd658ecf94]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55dd658fe3f9]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x55dd658ee4c6]
47  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x55dd658fe6a2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x55dd658ee212]
49  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55dd658ecf94]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x55dd658fe3f9]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x55dd658ef022]
52  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x55dd658ecf94]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x55dd658ecc68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x55dd658ecc19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x55dd6599a20b]
56  /opt/conda/envs/gdf/bin/python(+0x2085fa) [0x55dd659c75fa]
57  /opt/conda/envs/gdf/bin/python(+0x204983) [0x55dd659c3983]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x55dd659bb79a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x55dd659bb68c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x55dd659ba8c7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x55dd6598e047]
=================================
2023-08-24 06:23:14,358 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34659 -> ucx://127.0.0.1:33007
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0bf46c7280, tag: 0x32a7fe90db41d5c7, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1799, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
Task exception was never retrieved
future: <Task finished name='Task-5607' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Endpoint timeout')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Endpoint timeout
Task exception was never retrieved
future: <Task finished name='Task-544' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py:128> exception=UCXError('<stream_send>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 51, in exchange_peer_info
    await comm.stream_send(endpoint, my_info_arr, my_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_send>: Connection reset by remote peer
2023-08-24 06:23:14,428 - distributed.nanny - WARNING - Restarting worker
2023-08-24 06:23:14,634 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58769
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fdd757db1c0, tag: 0x7e14e9f95fc3f29f, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fdd757db1c0, tag: 0x7e14e9f95fc3f29f, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-08-24 06:23:14,634 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58769
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f0bf46c7300, tag: 0x4893ddeb8d39c2f8, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f0bf46c7300, tag: 0x4893ddeb8d39c2f8, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-24 06:23:14,634 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:57933 -> ucx://127.0.0.1:58769
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7f0a33436300, tag: 0xb994245b8178943c, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1799, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-24 06:23:14,634 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34075 -> ucx://127.0.0.1:58769
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fdd757db100, tag: 0x1d9021081a0adab8, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1799, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-24 06:23:14,635 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58769
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f0a33436180, tag: 0x4b93bc2d8267e08b, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f0a33436180, tag: 0x4b93bc2d8267e08b, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-24 06:23:14,634 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:58769
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 354, in read
    await self.ep.recv(msg)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #003] ep: 0x7f49647c21c0, tag: 0x2bc29a701467bc68, nbytes: 16, type: <class 'numpy.ndarray'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 372, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #003] ep: 0x7f49647c21c0, tag: 0x2bc29a701467bc68, nbytes: 16, type: <class 'numpy.ndarray'>>: ")
2023-08-24 06:23:14,715 - distributed.nanny - WARNING - Restarting worker
[dgx13:70664:0:70664] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  70664) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7fd6300580cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7fd6300582c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7fd63005848a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7fd6d0429420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7fd603ed1674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7fd603efa7f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7fd603e6b3df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7fd603e6e838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7fd6300614f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7fd603e6d5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7fd603ece89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x37aaa) [0x7fd603f8caaa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x562463c313d6]
13  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x562463c2bf94]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x562463c3d3f9]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562463c2d4c6]
16  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x562463ce0612]
17  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7fd650f5e1e9]
18  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x562463c3567c]
19  /opt/conda/envs/gdf/bin/python(+0xf248b) [0x562463bf048b]
20  /opt/conda/envs/gdf/bin/python(+0x1366f3) [0x562463c346f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x562463c326e4]
22  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x562463c3d6a2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562463c2d4c6]
24  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x562463c3d6a2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562463c2d4c6]
26  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x562463c3d6a2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562463c2d4c6]
28  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x562463c3d6a2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562463c2d4c6]
30  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x562463c2bf94]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x562463c3d3f9]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x562463c2e022]
33  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x562463c2bf94]
34  /opt/conda/envs/gdf/bin/python(+0x14c88b) [0x562463c4a88b]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x562463c4b00c]
36  /opt/conda/envs/gdf/bin/python(+0x21073e) [0x562463d0e73e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x562463c3567c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x562463c313d6]
39  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x562463c3d6a2]
40  /opt/conda/envs/gdf/bin/python(+0x14c96c) [0x562463c4a96c]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x562463c313d6]
42  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x562463c3d6a2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562463c2d4c6]
44  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x562463c2bf94]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x562463c3d3f9]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x562463c2d4c6]
47  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x562463c3d6a2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x562463c2d212]
49  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x562463c2bf94]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x562463c3d3f9]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x562463c2e022]
52  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x562463c2bf94]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x562463c2bc68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x562463c2bc19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x562463cd920b]
56  /opt/conda/envs/gdf/bin/python(+0x2085fa) [0x562463d065fa]
57  /opt/conda/envs/gdf/bin/python(+0x204983) [0x562463d02983]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x562463cfa79a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x562463cfa68c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x562463cf98c7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x562463ccd047]
=================================
2023-08-24 06:23:16,118 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:60721
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f49647c21c0, tag: 0x3d56d3226cabd5dd, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f49647c21c0, tag: 0x3d56d3226cabd5dd, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-08-24 06:23:16,118 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:34075 -> ucx://127.0.0.1:60721
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fdd757db1c0, tag: 0xb3899644b1c3f82, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1799, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
2023-08-24 06:23:16,118 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:60721
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXCanceled: <[Recv #009] ep: 0x7f0bf46c7300, tag: 0x35677a35eceb205b, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXCanceled("<[Recv #009] ep: 0x7f0bf46c7300, tag: 0x35677a35eceb205b, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: ")
2023-08-24 06:23:16,119 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:60721
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7f0a33436180, tag: 0xbdd6385a34bf6eff, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7f0a33436180, tag: 0xbdd6385a34bf6eff, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-08-24 06:23:16,119 - distributed.worker - ERROR - Worker stream died during communication: ucx://127.0.0.1:60721
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 396, in read
    await self.ep.recv(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 725, in recv
    ret = await comm.tag_recv(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Recv #007] ep: 0x7fdd757db100, tag: 0x14b29ea51308c4d5, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2073, in gather_dep
    response = await get_data_from_worker(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 2866, in get_data_from_worker
    response = await send_recv(
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/core.py", line 1115, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 402, in read
    raise CommClosedError(
distributed.comm.core.CommClosedError: Connection closed by writer.
Inner exception: UCXError("<[Recv #007] ep: 0x7fdd757db100, tag: 0x14b29ea51308c4d5, nbytes: 100000000, type: <class 'rmm._lib.device_buffer.DeviceBuffer'>>: Connection reset by remote peer")
2023-08-24 06:23:16,190 - distributed.nanny - WARNING - Restarting worker
[1692858196.808313] [dgx13:70477:0]    cuda_copy_md.c:210  UCX  ERROR   cuMemAlloc_v2((CUdeviceptr*)address_p, *length_p)() failed: out of memory
[1692858196.808333] [dgx13:70477:0]         uct_mem.c:155  UCX  ERROR   failed to allocate 536870912 bytes using md cuda_cpy for ucp_rndv_frags: Input/output error
[1692858196.808338] [dgx13:70477:0]           mpool.c:269  UCX  ERROR Failed to allocate memory pool (name=ucp_rndv_frags) chunk: Out of memory
[dgx13:70477:0:70477]        rndv.c:1374 Fatal: failed to allocate fragment memory buffer
==== backtrace (tid:  70477) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f0bf498e0cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_fatal_error_message+0x51) [0x7f0bf498bc71]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x27e0c) [0x7f0bf498be0c]
 3  /opt/conda/envs/gdf/lib/libucp.so.0(+0x771bf) [0x7f0bf4a3a1bf]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nbx+0xaeb) [0x7f0bf4a4d21b]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_tag_recv_nb+0x57) [0x7f0bf4a4d3f7]
 6  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x639d9) [0x7f0bf4af49d9]
 7  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5628139f600c]
 8  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5628139dc3d6]
 9  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5628139d6f94]
10  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5628139e83f9]
11  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5628139d9022]
12  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5628139d6f94]
13  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5628139e83f9]
14  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5628139d9022]
15  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x562813a8b612]
16  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x641d) [0x5628139de24d]
17  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x562813a8b612]
18  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x641d) [0x5628139de24d]
19  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x562813a8b612]
20  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x641d) [0x5628139de24d]
21  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x562813a8b612]
22  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x641d) [0x5628139de24d]
23  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x562813a8b612]
24  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x641d) [0x5628139de24d]
25  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x562813a8b612]
26  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x641d) [0x5628139de24d]
27  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x562813a8b612]
28  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x641d) [0x5628139de24d]
29  /opt/conda/envs/gdf/bin/python(+0x1e2612) [0x562813a8b612]
30  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x81e9) [0x7f0c15a101e9]
31  /opt/conda/envs/gdf/lib/python3.9/lib-dynload/_asyncio.cpython-39-x86_64-linux-gnu.so(+0x8aa6) [0x7f0c15a10aa6]
32  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5628139e067c]
33  /opt/conda/envs/gdf/bin/python(+0xf248b) [0x56281399b48b]
34  /opt/conda/envs/gdf/bin/python(+0x1366f3) [0x5628139df6f3]
35  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x5628139dd6e4]
36  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5628139e86a2]
37  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5628139d84c6]
38  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5628139e86a2]
39  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5628139d84c6]
40  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5628139e86a2]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5628139d84c6]
42  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5628139e86a2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5628139d84c6]
44  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5628139d6f94]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5628139e83f9]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x5628139d9022]
47  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5628139d6f94]
48  /opt/conda/envs/gdf/bin/python(+0x14c88b) [0x5628139f588b]
49  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x5628139f600c]
50  /opt/conda/envs/gdf/bin/python(+0x21073e) [0x562813ab973e]
51  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x5628139e067c]
52  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5628139dc3d6]
53  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5628139e86a2]
54  /opt/conda/envs/gdf/bin/python(+0x14c96c) [0x5628139f596c]
55  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x5628139dc3d6]
56  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5628139e86a2]
57  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5628139d84c6]
58  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x5628139d6f94]
59  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x5628139e83f9]
60  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x5628139d84c6]
61  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x5628139e86a2]
=================================
[dgx13:70660:0:70660] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x448)
==== backtrace (tid:  70660) ====
 0  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_handle_error+0x2fd) [0x7f4964a6f0cd]
 1  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a2c4) [0x7f4964a6f2c4]
 2  /opt/conda/envs/gdf/lib/libucs.so.0(+0x2a48a) [0x7f4964a6f48a]
 3  /usr/lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f4a04fd3420]
 4  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_mem_type_unpack+0x14) [0x7f4964aee674]
 5  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_rndv_data_handler+0x4e9) [0x7f4964b177f9]
 6  /opt/conda/envs/gdf/lib/libuct.so.0(+0x203df) [0x7f4964a293df]
 7  /opt/conda/envs/gdf/lib/libuct.so.0(+0x23838) [0x7f4964a2c838]
 8  /opt/conda/envs/gdf/lib/libucs.so.0(ucs_event_set_wait+0xb9) [0x7f4964a784f9]
 9  /opt/conda/envs/gdf/lib/libuct.so.0(uct_tcp_iface_progress+0x7d) [0x7f4964a2b5dd]
10  /opt/conda/envs/gdf/lib/libucp.so.0(ucp_worker_progress+0x5a) [0x7f4964aeb89a]
11  /opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/_libs/ucx_api.cpython-39-x86_64-linux-gnu.so(+0x37aaa) [0x7f4964ba9aaa]
12  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x558b7212e3d6]
13  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x558b72128f94]
14  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558b7213a3f9]
15  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558b7212a4c6]
16  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x558b7213a6a2]
17  /opt/conda/envs/gdf/bin/python(+0x14ca43) [0x558b72147a43]
18  /opt/conda/envs/gdf/bin/python(+0x2580fc) [0x558b722530fc]
19  /opt/conda/envs/gdf/bin/python(+0xf248b) [0x558b720ed48b]
20  /opt/conda/envs/gdf/bin/python(+0x1366f3) [0x558b721316f3]
21  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x58b4) [0x558b7212f6e4]
22  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x558b7213a6a2]
23  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558b7212a4c6]
24  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x558b7213a6a2]
25  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558b7212a4c6]
26  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x558b7213a6a2]
27  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558b7212a4c6]
28  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x558b7213a6a2]
29  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558b7212a4c6]
30  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x558b72128f94]
31  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558b7213a3f9]
32  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x558b7212b022]
33  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x558b72128f94]
34  /opt/conda/envs/gdf/bin/python(+0x14c88b) [0x558b7214788b]
35  /opt/conda/envs/gdf/bin/python(PyObject_Call+0xbc) [0x558b7214800c]
36  /opt/conda/envs/gdf/bin/python(+0x21073e) [0x558b7220b73e]
37  /opt/conda/envs/gdf/bin/python(_PyObject_MakeTpCall+0x2ec) [0x558b7213267c]
38  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x558b7212e3d6]
39  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x558b7213a6a2]
40  /opt/conda/envs/gdf/bin/python(+0x14c96c) [0x558b7214796c]
41  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x45a6) [0x558b7212e3d6]
42  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x558b7213a6a2]
43  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558b7212a4c6]
44  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x558b72128f94]
45  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558b7213a3f9]
46  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x696) [0x558b7212a4c6]
47  /opt/conda/envs/gdf/bin/python(+0x13f6a2) [0x558b7213a6a2]
48  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x3e2) [0x558b7212a212]
49  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x558b72128f94]
50  /opt/conda/envs/gdf/bin/python(_PyFunction_Vectorcall+0xd9) [0x558b7213a3f9]
51  /opt/conda/envs/gdf/bin/python(_PyEval_EvalFrameDefault+0x11f2) [0x558b7212b022]
52  /opt/conda/envs/gdf/bin/python(+0x12df94) [0x558b72128f94]
53  /opt/conda/envs/gdf/bin/python(_PyEval_EvalCodeWithName+0x48) [0x558b72128c68]
54  /opt/conda/envs/gdf/bin/python(PyEval_EvalCodeEx+0x39) [0x558b72128c19]
55  /opt/conda/envs/gdf/bin/python(PyEval_EvalCode+0x1b) [0x558b721d620b]
56  /opt/conda/envs/gdf/bin/python(+0x2085fa) [0x558b722035fa]
57  /opt/conda/envs/gdf/bin/python(+0x204983) [0x558b721ff983]
58  /opt/conda/envs/gdf/bin/python(PyRun_StringFlags+0x9a) [0x558b721f779a]
59  /opt/conda/envs/gdf/bin/python(PyRun_SimpleStringFlags+0x3c) [0x558b721f768c]
60  /opt/conda/envs/gdf/bin/python(Py_RunMain+0x267) [0x558b721f68c7]
61  /opt/conda/envs/gdf/bin/python(Py_BytesMain+0x37) [0x558b721ca047]
=================================
2023-08-24 06:23:17,225 - distributed.nanny - WARNING - Restarting worker
2023-08-24 06:23:17,347 - distributed.worker - WARNING - Compute Failed
Key:       ('group-simple-shuffle-2f7c39ce5e6399e29bac23110d347e6e', 5)
Function:  shuffle_group
args:      (                key  shuffle   payload  _partitions
0         500000000        1  48863339            1
1         500000001        6  82208751            6
2         500000002        5  23172095            5
3         500000003        3  83618300            3
4         500000004        7  32090160            7
...             ...      ...       ...          ...
99999995  599999995        4   2417575            4
99999996  599999996        3  79206659            3
99999997  599999997        4  89655348            4
99999998  599999998        0  82540937            0
99999999  599999999        1  42812172            1

[100000000 rows x 4 columns], '_partitions', 0, 8, 8, True, 8)
kwargs:    {}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded')"

Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 740, in cupy.cuda.memory.alloc
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/rmm/allocators/cupy.py", line 37, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
Exception ignored in: 'cupy.cuda.thrust.cupy_malloc'
Traceback (most recent call last):
  File "cupy/cuda/memory.pyx", line 740, in cupy.cuda.memory.alloc
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/rmm/allocators/cupy.py", line 37, in rmm_cupy_allocator
    buf = librmm.device_buffer.DeviceBuffer(size=nbytes, stream=stream)
  File "device_buffer.pyx", line 85, in rmm._lib.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/gdf/include/rmm/mr/device/pool_memory_resource.hpp:196: Maximum pool size exceeded
2023-08-24 06:23:17,489 - distributed.worker - WARNING - Compute Failed
Key:       ('generate-data-5366301a596b755bb8c33997d3ce7726', 7)
Function:  generate_chunk
args:      (7, 100000000, 8, 'build', 0.3, True)
kwargs:    {}
Exception: "RuntimeError('transform: failed to synchronize: cudaErrorIllegalAddress: an illegal memory access was encountered')"

2023-08-24 06:23:17,493 - distributed.worker - WARNING - Compute Failed
Key:       ('generate-data-5366301a596b755bb8c33997d3ce7726', 0)
Function:  generate_chunk
args:      (0, 100000000, 8, 'build', 0.3, True)
kwargs:    {}
Exception: "CUDADriverError('CUDA_ERROR_ILLEGAL_ADDRESS: an illegal memory access was encountered')"

2023-08-24 06:23:17,547 - distributed.nanny - WARNING - Restarting worker
2023-08-24 06:23:17,547 - distributed.worker - ERROR - failed during get data with ucx://127.0.0.1:43913 -> ucx://127.0.0.1:46339
Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 338, in write
    await self.ep.send(each_frame)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/ucp/core.py", line 650, in send
    return await comm.tag_send(self._ep, buffer, nbytes, tag, name=log)
ucp._libs.exceptions.UCXError: <[Send #007] ep: 0x7fc87c4e91c0, tag: 0x2bca17ad2eabf51e, nbytes: 100000000, type: <class 'cudf.core.buffer.buffer.Buffer'>>: Connection reset by remote peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/worker.py", line 1799, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/utils.py", line 803, in wrapper
    return await func(*args, **kwargs)
  File "/opt/conda/envs/gdf/lib/python3.9/site-packages/distributed/comm/ucx.py", line 342, in write
    raise CommClosedError("While writing, the connection was closed")
distributed.comm.core.CommClosedError: While writing, the connection was closed
/opt/conda/envs/gdf/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 48 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
